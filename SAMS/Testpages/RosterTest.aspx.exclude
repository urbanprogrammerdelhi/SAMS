<%@ Page Language="C#" AutoEventWireup="true" CodeFile="RosterTest.aspx.cs" Inherits="Testpages_RosterTest"
    AsyncTimeout="0" %>

<%@ Register Assembly="Telerik.Web.UI" Namespace="Telerik.Web.UI" TagPrefix="telerik" %>
<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="AjaxToolKit" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head id="Head1" runat="server">
    <title></title>
    <script language="javascript" src="../javaScript/validation.js" type="text/javascript"></script>
    <script language="javascript" type="text/javascript" src="../javaScript/jquery-1.7.1.js"></script>
    <style type="text/css">
        td.freezepane
        {
            text-align: left;
            border-width: 0;
            background-color: White;
            position: relative;
            cursor: default;
            left: inherit;
        }
        .popup
        {
            border: solid 1px #333;
            font-family: Tahoma;
            font-size: 12px;
            display: none;
            position: absolute;
            width: 350px;
            z-index: 60;
        }
        .popuptitle
        {
            background: #6EB6D5;
            color: white;
            font-weight: bold;
            height: 15px;
            padding: 5px;
        }
        .popupbody
        {
            background: #FCFDFD;
            padding: 5px;
            text-align: center;
        }
        #DivJobBreakUp
        {
            top: 100px;
            left: 50px;
        }
        #DivEmployeeAdditionalHrs
        {
            top: 100px;
            left: 50px;
        }
        #popup2
        {
            top: 100px;
            left: 400px;
        }
        .TableColor
        {
            background-color: #EFF7FF;
            border: 1px solid #96C2F1;
        }
        .resizeDiv
        {
            width: 700px;
            height: 200px;
            background-color: #EFF7FF;
            border: 1px solid #B7CEEC;
            position: absolute;
            left: 100px;
            top: 100px;
        }
        .resizeDiv h5
        {
            background-color: #B2D3F5;
            padding: 5px;
            margin: 1px;
        }
    </style>
    <link rel="Stylesheet" type="text/css" href="../css/StyleSheet.css" />
    <link rel="stylesheet" type="text/css" href="../css/WRStyleSheet.css" />
    <link rel="stylesheet" type="text/css" href="../css/WRGridView.css" />
</head>
<body onload="OnLoad();" onclick="HideDivs(); onUnload();">
    <form id="form1" runat="server">
    <input type="hidden" id="gridelement" runat="server" />
    <asp:ScriptManager ID="script" runat="server">
        <Services>
            <asp:ServiceReference Path="../WebServices/WebMethods.asmx" />
        </Services>
    </asp:ScriptManager>
    <%--<telerik:RadScriptManager ID="script" runat="server">
    <Services>
       <Ajax:ServiceReference Path="../WebServices/WebMethods.asmx" />
    
    </Services>
</telerik:RadScriptManager>--%>
    <%--<div>--%>
    <Ajax:UpdatePanel ID="UPDropDown" runat="server" UpdateMode="Conditional">
        <ContentTemplate>
            <table style="width: 1000px; border-collapse: collapse; border-spacing: 0;">
                <tr valign="bottom">
                    <td align="right" style="width: 110px;">
                        <asp:Label CssClass="cssLable" ID="Label15" runat="server" Text="<%$Resources:Resource,AttendanceType %>"></asp:Label>
                    </td>
                    <td align="left" style="width: 110px;">
                        <asp:DropDownList ID="ddlAttendanceType" onchange="javascript:AssignPostIDValue();javascript:EnableProceed();DatesGet('Week');"
                            Width="100px" runat="server" CssClass="cssDropDownSmall">
                            <asp:ListItem Text="<%$ Resources:Resource, Schedule %>" Value="Sch"></asp:ListItem>
                            <asp:ListItem Text="<%$ Resources:Resource, Actual %>" Value="Act"></asp:ListItem>
                        </asp:DropDownList>
                    </td>
                    <td align="right" style="width: 180px;">
                        <asp:Label CssClass="cssLable" ID="Label14" runat="server" Text="<%$Resources:Resource,ScheduleType %>"></asp:Label>
                    </td>
                    <td align="left" style="width: 100px;">
                        <asp:DropDownList ID="ddlScheduleType" AutoPostBack="true" onchange="javascript:AssignPostIDValue();javascript:EnableProceed();javascript:DatesGet('Year');"
                            OnSelectedIndexChanged="ddlScheduleType_SelectedIndexChanged" Width="100px" runat="server"
                            CssClass="cssDropDownSmall">
                            <asp:ListItem Text="<%$ Resources:Resource, Weekly %>" Value="Weekly"></asp:ListItem>
                            <%-- <asp:ListItem Text="<%$ Resources:Resource, Monthly %>" Value="Monthly"></asp:ListItem>--%>
                            <asp:ListItem Text="<%$ Resources:Resource, Date %>" Value="Daily"></asp:ListItem>
                        </asp:DropDownList>
                    </td>
                    <td align="left" valign="baseline" style="font-size: small; font-family: Verdana;
                        width: 480px" rowspan="8">
                        <Ajax:UpdatePanel ID="UpdatePanel2" runat="server" UpdateMode="Conditional">
                            <ContentTemplate>
                                <asp:Panel ID="P4" BorderWidth="0px" runat="server" Height="55px" Width="460px" ScrollBars="Auto"
                                    CssClass="ScrollBar">
                                    <div id="divManPowerReq" style="border: 0px;">
                                    </div>
                                </asp:Panel>
                            </ContentTemplate>
                        </Ajax:UpdatePanel>
                    </td>
                </tr>
                <tr>
                    <td align="right" style="width: 110px">
                        <asp:Label CssClass="cssLable" ID="lblMonth" runat="server" Text="<%$ Resources:Resource, Month %>"></asp:Label>
                        <asp:Label CssClass="cssLable" ID="lblFromDate" runat="server" Text="<%$ Resources:Resource, FromDate %>"></asp:Label>
                    </td>
                    <td align="left" style="text-align: left" colspan="4">
                        <table border="0" cellpadding="0" cellspacing="1">
                            <tr>
                                <td>
                                    <asp:TextBox ID="txtFromDate" runat="server" Width="65px" AutoPostBack="false" onchange="javascript:DatesGet('Date');"
                                        CssClass="csstxtboxRequired"></asp:TextBox>
                                    <AjaxToolKit:CalendarExtender ID="CalendarExtender1" Format="dd-MMM-yyyy" runat="server"
                                        TargetControlID="txtFromDate" Enabled="True">
                                    </AjaxToolKit:CalendarExtender>
                                </td>
                                <td>
                                    <asp:DropDownList ID="ddlMonth" Width="70px" runat="server" CssClass="cssDropDownSmall"
                                        AutoPostBack="false" onchange="javascript:DatesGet('Month');">
                                        <asp:ListItem Text="<%$ Resources:Resource, January%>" Value="1"></asp:ListItem>
                                        <asp:ListItem Text="<%$ Resources:Resource,February%>" Value="2"></asp:ListItem>
                                        <asp:ListItem Text="<%$ Resources:Resource,March%>" Value="3"></asp:ListItem>
                                        <asp:ListItem Text="<%$ Resources:Resource,April%>" Value="4"></asp:ListItem>
                                        <asp:ListItem Text="<%$ Resources:Resource,May%>" Value="5"></asp:ListItem>
                                        <asp:ListItem Text="<%$ Resources:Resource,June%>" Value="6"></asp:ListItem>
                                        <asp:ListItem Text="<%$ Resources:Resource,July%>" Value="7"></asp:ListItem>
                                        <asp:ListItem Text="<%$ Resources:Resource,August%>" Value="8"></asp:ListItem>
                                        <asp:ListItem Text="<%$ Resources:Resource,September%>" Value="9"></asp:ListItem>
                                        <asp:ListItem Text="<%$ Resources:Resource,October%>" Value="10"></asp:ListItem>
                                        <asp:ListItem Text="<%$ Resources:Resource,November%>" Value="11"></asp:ListItem>
                                        <asp:ListItem Text="<%$ Resources:Resource,December%>" Value="12"></asp:ListItem>
                                    </asp:DropDownList>
                                </td>
                                <td align="left">
                                    <asp:TextBox MaxLength="4" Width="25px" CssClass="csstxtboxSmall" ID="txtYear" runat="server"
                                        AutoPostBack="false" OnKeyUp="javascript:validateNumeric(this);" onchange="javascript:DatesGet('Year');">
                                    </asp:TextBox>
                                </td>
                                <td align="right">
                                    <%-- <asp:HiddenField ID="HFFromDate" runat="server" />
                                    <asp:HiddenField ID="HFToDate" runat="server" />--%>
                                    &nbsp;<asp:Label ID="lblWeekNo" runat="server" Text="<%$ Resources:Resource,Week%>"></asp:Label>
                                    <asp:Label CssClass="cssLable" ID="lblToDate" runat="server" Text="<%$ Resources:Resource, ToDate %>"></asp:Label>
                                    <asp:Label CssClass="cssLable" ID="lblBiMonthly" runat="server" Text="<%$ Resources:Resource, Month %>"></asp:Label>
                                </td>
                                <td align="left">
                                    <asp:DropDownList ID="ddlWeek" Width="130px" onchange="javascript:AssignPostIDValue();DatesGet('Week');"
                                        AutoPostBack="false" CssClass="cssDropDownSmall" runat="server">
                                    </asp:DropDownList>
                                    <asp:TextBox ID="txtToDate" Enabled="false" Width="65px" runat="server" AutoPostBack="false"
                                        onchange="javascript:DatesGet('Date');" CssClass="csstxtboxRequired"></asp:TextBox>
                                    <AjaxToolKit:CalendarExtender ID="CalendarExtender3" runat="server" Enabled="True"
                                        Format="dd-MMM-yyyy" TargetControlID="txtToDate">
                                    </AjaxToolKit:CalendarExtender>
                                    <asp:DropDownList ID="ddlBiMonthly" Width="100px" runat="server" CssClass="cssDropDownSmall"
                                        AutoPostBack="true" OnSelectedIndexChanged="ddlBiMonthly_SelectedIndexChanged">
                                        <asp:ListItem Text="First FortNight" Value="FirstFortNight"></asp:ListItem>
                                        <asp:ListItem Text="Second FortNight" Value="SecondFortNight"></asp:ListItem>
                                    </asp:DropDownList>
                                </td>
                                <td>
                                    &nbsp;<asp:Label ID="lblArea" runat="server" CssClass="cssLabel" Text="<%$Resources:Resource,Area %>"></asp:Label>
                                </td>
                                <td>
                                    &nbsp;<asp:DropDownList ID="ddlArea" Width="100px" AutoPostBack="false" onchange="javascript:FillClient();"
                                        runat="server" CssClass="cssDropDownSmall">
                                    </asp:DropDownList>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </ContentTemplate>
    </Ajax:UpdatePanel>
    <%--</div>--%>
    <table border="0" cellpadding="0" cellspacing="0" style="width: 1000px;">
        <tr valign="top">
            <td align="right" style="width: 110px;">
                <asp:Label CssClass="cssLable" ID="lblClientCode" runat="server" Text="<%$ Resources:Resource, Client %>"></asp:Label>
            </td>
            <td align="left" style="width: 100px;">
                <asp:TextBox CssClass="csstxtboxSmall" Width="150px" ID="txtClientCode" runat="server"
                    onchange="javascript:GetClient('TextBox');" AccessKey="c"> </asp:TextBox>
            </td>
            <td align="left" style="width: 260px;">
                <asp:DropDownList ID="ddClient" Width="260px" CssClass="cssDropDownSmall" runat="server"
                    onchange="javascript:GetClient('DropDown');">
                </asp:DropDownList>
            </td>
            <td style="width: 250px">
                <%-- <Ajax:UpdatePanel ID="UPPostID" runat="server" UpdateMode="Conditional">
                            <ContentTemplate>--%>
                <asp:TextBox CssClass="csstxtboxSearch" Width="100px" ID="txtPostID" onkeyup="javascript:SearchPostID(this);"
                    runat="server"> </asp:TextBox>
                <%--  </ContentTemplate>
                        </Ajax:UpdatePanel>--%>
            </td>
        </tr>
        <tr valign="top">
            <td align="right">
                <asp:Label CssClass="cssLable" ID="Label1" runat="server" Text="<%$ Resources:Resource, Assignment %>"></asp:Label>
            </td>
            <td align="left">
                <asp:TextBox CssClass="csstxtboxSmall" ID="txtAsmtCode" Width="150px" runat="server"
                    onchange="javascript:GetAssignment('TextBox');" AccessKey="x" AutoPostBack="false"> </asp:TextBox>
                <asp:HiddenField ID="AsmtId" runat="server" Value="0" />
            </td>
            <td align="left">
                <asp:DropDownList ID="ddAssignment" Width="260px" CssClass="cssDropDownSmall" runat="server"
                    onchange="javascript:GetAssignment('DropDown');" AutoPostBack="false">
                </asp:DropDownList>
            </td>
            <td align="left">
                <asp:DropDownList ID="ddlPost" Width="230px" CssClass="cssDropDownSmall" onchange="javascript:ChangePostCode()"
                    runat="server">
                </asp:DropDownList>
                <asp:TextBox ID="txtAsmtStartDate" Width="60px" Style="display: none;" BackColor="LightGray"
                    runat="server" CssClass="csstxtbox" Enabled="false" Text=""></asp:TextBox>
                <asp:TextBox ID="txtAsmtEndDate" Style="display: none;" Width="60px" BackColor="LightGray"
                    runat="server" CssClass="csstxtbox" Enabled="false" Text=""></asp:TextBox>
                <asp:Label ID="lblOldAsmtCode" EnableViewState="true" runat="server" Style="display: none"></asp:Label>
            </td>
            <td>
                <Ajax:UpdatePanel ID="UPHeader" runat="server" UpdateMode="Conditional">
                    <ContentTemplate>
                        <table style="width: 100%">
                            <tr>
                                <td>
                                    <asp:Button ID="btnProceed" runat="server" CssClass="cssProceedScheduleButton" Text="<%$ Resources:Resource, Proceed %>"
                                        OnClick="btnProceed_Click" />
                                    <Ajax:UpdateProgress ID="UpdateProgress1" runat="server">
                                        <ProgressTemplate>
                                            <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; text-align: center;"
                                                class="modalBackground">
                                                <img id="imgspin" runat="server" style="position: absolute; top: 50%; left: 50%"
                                                    alt="" src="../Images/spinner.gif" />
                                            </div>
                                        </ProgressTemplate>
                                    </Ajax:UpdateProgress>
                                </td>
                                <td>
                                    <asp:Label ID="btnBack" Width="52px" Height="18px" Style="text-align: center; cursor: pointer"
                                        runat="server" CssClass="cssButton" Text="<%$ Resources:Resource, Back %>"></asp:Label>
                                </td>
                            </tr>
                        </table>
                    </ContentTemplate>
                </Ajax:UpdatePanel>
            </td>
        </tr>
    </table>
    <Ajax:UpdatePanel ID="UPScheduleDetail" runat="server" UpdateMode="Conditional">
        <ContentTemplate>
            <table width="110%">
                <tr>
                    <td align="center">
                        <a href="javascript:SearchEmploueeSchedule()">
                            <asp:Literal ID="Literal1" runat="server" Text="<%$ Resources:Resource, SearchEmployeeschedule %>"></asp:Literal></a>
                    </td>
                    <td align="center">
                        <a href="javascript:SaleOrderDeployment()">
                            <asp:Literal ID="Literal2" runat="server" Text="<%$ Resources:Resource, SaleOrderDeployment %>"></asp:Literal></a>
                    </td>
                    <td align="center">
                        <a href="javascript:SaleOrderConstraint()">
                            <asp:Literal ID="Literal4" runat="server" Text="<%$ Resources:Resource, Constraint %>"></asp:Literal></a>
                    </td>
                    <td align="center">
                        <a href="javascript:ClientAndAsmtWiseTotalHours()">
                            <asp:Literal ID="Literal3" runat="server" Text="<%$ Resources:Resource, AssignmentWiseTotalHours %>"></asp:Literal></a>
                    </td>
                    <td align="center">
                        <asp:LinkButton ID="LiteralAdditionalHrs" OnClick="LiteralAdditionalHrs_Click" runat="server"
                            Text="Total Additional Hours"></asp:LinkButton>
                    </td>
                    <td>
                        <img alt="" style="width: 10px; height: 10px; background-color: Orange" src='../Images/spacer.gif'></img>
                        <asp:Literal ID="ltrScheduled" runat="server" Text="<%$ Resources:Resource, Scheduled %>"></asp:Literal>
                    </td>
                    <td>
                        <img alt="" style="width: 10px; height: 10px; background-color: Gold" src='../Images/spacer.gif'></img>
                        <asp:Literal ID="ltrWeeklyOff" runat="server" Text="<%$ Resources:Resource, WeeklyOff %>"></asp:Literal>
                    </td>
                    <td>
                        <img alt="" style="width: 10px; height: 10px; background-color: LawnGreen" src='../Images/spacer.gif'></img>
                        <asp:Literal ID="ltrCanceledLeave" runat="server" Text="<%$ Resources:Resource, CanceledLeave %>"></asp:Literal>
                    </td>
                    <td>
                        <img alt="" style="width: 10px; height: 10px; background-color: DeepSkyBlue" src='../Images/spacer.gif'></img>
                        <asp:Literal ID="ltrLeave" runat="server" Text="<%$ Resources:Resource, Leave %>"></asp:Literal>
                    </td>
                    <td>
                        <img style="width: 10px; height: 10px; background-color: BurlyWood" src='../Images/spacer.gif'></img>
                        <asp:Literal ID="ltrOJTPayable" runat="server" Text="<%$ Resources:Resource, OJTPayable %>"></asp:Literal>
                    </td>
                    <td>
                        <img alt="" style="width: 10px; height: 10px; background-color: Gainsboro" src='../Images/spacer.gif'></img>
                        <asp:Literal ID="ltrOJTNonPayable" runat="server" Text="<%$ Resources:Resource, OJTNonPayable %>"></asp:Literal>
                    </td>
                    <td>
                        <img alt="" style="width: 10px; height: 10px; background-color: LightPink" src='../Images/spacer.gif'></img>
                        <asp:Literal ID="ltrOT" runat="server" Text="<%$ Resources:Resource, OT %>"></asp:Literal>
                    </td>
                    <td>
                        <img alt="" style="width: 10px; height: 10px; background-color: Aqua" src='../Images/spacer.gif'></img>
                        <asp:Literal ID="LBTso" runat="server" Text="<%$ Resources:Resource, TSOAdditional %>"></asp:Literal>
                    </td>
                </tr>
            </table>
            <table>
                <tr>
                    <td>
                        <asp:HiddenField ID="HFEmployeeSearch" runat="server" />
                        <asp:Label ID="lblErrorMsg" EnableViewState="false" runat="server" CssClass="csslblErrMsg"></asp:Label>
                        <asp:GridView ID="gvScheduleRoster" runat="server" CssClass="GridViewStyle" ShowFooter="true"
                            ClientIDMode="AutoID" AllowPaging="true" PageSize="20" CellPadding="1" AutoGenerateColumns="false"
                            GridLines="Both" AllowSorting="false" OnRowCreated="gvScheduleRoster_RowCreated"
                            OnRowDataBound="gvScheduleRoster_RowDataBound" OnDataBound="gvScheduleRoster_DataBound"
                            OnRowCommand="gvScheduleRoster_RowCommand" OnPageIndexChanging="gvScheduleRoster_PageIndexChanging"
                            OnRowUpdating="gvScheduleRoster_OnRowUpdating">
                            <Columns>
                                <asp:ButtonField CommandName="ColumnClick" Visible="false" />
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" FooterStyle-CssClass="GridViewFooterStyle"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <table width="360px" border="0">
                                            <tr>
                                                <td align="left" style="width: 15px;">
                                                    <asp:Label ID="Label13" runat="server" Text="<%$Resources:Resource,Sno %>"></asp:Label>
                                                </td>
                                                <td align="left" style="width: 70px;">
                                                    <asp:Label ID="lblHeaderSoRank" runat="server" Text="<%$ Resources:Resource, EmpNo %>"></asp:Label>
                                                    <asp:TextBox ID="txtEmployeeSearch" Font-Bold="true" onchange="javascript:AssignPostIDValue();"
                                                        OnTextChanged="txtEmployeeSearch_TextChanged" AutoPostBack="true" MaxLength="16"
                                                        runat="server" Width="55px" CssClass="csstxtboxSmall"></asp:TextBox>
                                                </td>
                                                <td align="center" style="width: 80px;">
                                                    <asp:Label ID="Label6" runat="server" Text="<%$ Resources:Resource, Name %>"></asp:Label>
                                                </td>
                                                <td align="center" style="width: 130px;">
                                                    <asp:Label ID="Label8" runat="server" Text="<%$ Resources:Resource, Designation %>"></asp:Label>
                                                </td>
                                                <td align="right" style="width: 15px;">
                                                    <asp:Label ID="Label10" runat="server" Text="<%$ Resources:Resource, Position %>"></asp:Label>
                                                </td>
                                                <td align="right" style="width: 30px;">
                                                    <asp:Label ID="Label11" runat="server" Text="<%$ Resources:Resource, Code %>"></asp:Label>
                                                </td>
                                                <td align="center">
                                                    <asp:Label ID="Label12" runat="server" Text=""></asp:Label>
                                                </td>
                                            </tr>
                                        </table>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblRowID" Style="display: none;" Width="15px" runat="server" CssClass="cssLabel"
                                            Text='<%# Eval("RowNumber") %>'></asp:Label>
                                        <table cellpadding="0" cellspacing="0" border="0" width="360px">
                                            <tr>
                                                <td style="width: 15px;">
                                                    <asp:Label ID="lblSerialNumber" Width="15px" runat="server" CssClass="cssLabel"></asp:Label>
                                                    <asp:HiddenField ID="HGPayrateStatus" runat="server" Value='<%# Eval("WageRateStatus") %>' />
                                                </td>
                                                <td style="width: 100px;">
                                                    <asp:TextBox ID="txtEmpNumberDutyDate" Font-Bold="true" Text='<%# Eval("EmployeeNumber") %>'
                                                        MaxLength="16" Width="55px" CssClass="csstxtboxSmall" runat="server" onkeydown="javascript:FunctionCallOnKeyDown('EmployeeNumber',this)"></asp:TextBox>
                                                    <asp:LinkButton ID="IBSearchEmployee" Text="?" Font-Bold="true" Font-Size="Small"
                                                        runat="server" CssClass="cssImgButton"></asp:LinkButton>
                                                    <asp:HiddenField ID="HFOrgEmployeeNumber" runat="server" Value='<%# Eval("EmployeeNumber") %>' />
                                                </td>
                                                <td style="width: 90px">
                                                    <asp:TextBox ID="txtEmpNameDutyDate" Font-Bold="true" onkeyup="javascript:SearchEmployee(this);"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('EmployeeName',this)" Text='<%# Eval("EmployeeName") %>'
                                                        CssClass="csstxtboxSmall" runat="server" Width="90px"></asp:TextBox>
                                                </td>
                                                <td style="width: 100px">
                                                    <asp:TextBox ID="txtEmpDesignationDesc" Font-Bold="true" Text='<%# Eval("DesignationDesc") %>'
                                                        CssClass="csstxtboxSmall" runat="server" Width="100px"></asp:TextBox>
                                                </td>
                                                <td style="width: 30px">
                                                    <asp:TextBox ID="txtPatternPosition" Font-Bold="true" Text='<%# Eval("PatternPosition") %>'
                                                        CssClass="csstxtboxSmall" runat="server" onkeydown="javascript:FunctionCallOnKeyDown('PatternPosition',this)"
                                                        Width="30px"></asp:TextBox>
                                                </td>
                                                <td style="width: 30px">
                                                    <asp:TextBox ID="txtShiftPatternCode" Font-Bold="true" Text='<%# Eval("ShiftPatternCode") %>'
                                                        onkeyup="javascript:SearchShiftPattern(this)" onkeydown="javascript:FunctionCallOnKeyDown('ShiftPatternCode',this)"
                                                        CssClass="csstxtboxSmall" runat="server" Width="30px"></asp:TextBox>
                                                    <asp:HiddenField ID="hfBorrowedEmployeeStatus" Value='<%# Eval("BorrowedEmployeeStatus") %>'
                                                        runat="server" />
                                                </td>
                                                <td style="width: 15px; display: none;">
                                                    <asp:CheckBox ID="CBIsDefaultSite" Enabled="false" CssClass="cssCheckBox" runat="server">
                                                    </asp:CheckBox>
                                                    <asp:HiddenField ID="HFDesignationCode" Value='<%# Eval("DesignationCode") %>' runat="server" />
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="350px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate1" Visible="true" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate1" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect1" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate1" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("1") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId1" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId1" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted1" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode1" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode1" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo1" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID1" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'1');" onmouseover="JobBreakDownActive(this.id)"
                                            runat="server" id="IMGJobBreakDownSummary1" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate1" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom1" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo1" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate2" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate2" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect2" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate2" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("2") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId2" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId2" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted2" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode2" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode2" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo2" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID2" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'2');" onmouseover="JobBreakDownActive(this.id)"
                                            runat="server" id="IMGJobBreakDownSummary2" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate2" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom2" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo2" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate3" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate3" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect3" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate3" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("3") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId3" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId3" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted3" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode3" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode3" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo3" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID3" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'3');" onmouseover="JobBreakDownActive(this.id)"
                                            runat="server" id="IMGJobBreakDownSummary3" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate3" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom3" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo3" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate4" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate4" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect4" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate4" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("4") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId4" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId4" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted4" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode4" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode4" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo4" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID4" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'4');" onmouseover="JobBreakDownActive(this.id)"
                                            runat="server" id="IMGJobBreakDownSummary4" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate4" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom4" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo4" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate5" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate5" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect5" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate5" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("5") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId5" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId5" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted5" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode5" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode5" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo5" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID5" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'5');" onmouseover="JobBreakDownActive(this.id)"
                                            runat="server" id="IMGJobBreakDownSummary5" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate5" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom5" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo5" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate6" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate6" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect6" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate6" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("6") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId6" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId6" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted6" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode6" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode6" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo6" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID6" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'6');" onmouseover="JobBreakDownActive(this.id)"
                                            runat="server" id="IMGJobBreakDownSummary6" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate6" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom6" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo6" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate7" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate7" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect7" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate7" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("7") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId7" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId7" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted7" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode7" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode7" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo7" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID7" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'7');" id="IMGJobBreakDownSummary7"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate7" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom7" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo7" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <%-------------------------------8-14(begin)---------------------------------------------------%>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate8" Visible="true" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate8" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect8" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate8" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("8") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId8" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId8" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted8" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode8" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode8" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo8" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID8" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'8');" id="IMGJobBreakDownSummary8"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate8" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom8" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo8" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate9" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate9" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect9" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate9" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("9") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId9" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId9" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted9" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode9" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode9" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo9" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID9" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'9');" id="IMGJobBreakDownSummary9"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate9" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom9" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo9" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate10" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate10" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect10" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate10" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("10") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId10" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId10" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted10" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode10" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode10" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo10" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID10" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'10');" id="IMGJobBreakDownSummary10"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate10" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom10" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo10" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate11" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate11" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect11" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate11" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("11") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId11" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId11" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted11" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode11" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode11" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo11" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID11" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'11');" id="IMGJobBreakDownSummary11"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate11" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom11" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo11" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate12" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate12" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect12" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate12" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("12") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId12" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId12" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted12" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode12" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode12" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo12" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID12" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'12');" id="IMGJobBreakDownSummary12"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate12" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom12" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo12" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate13" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate13" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect13" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate13" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("13") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId13" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId13" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted13" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode13" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode13" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo13" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID13" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'13');" id="IMGJobBreakDownSummary13"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate13" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom13" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo13" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate14" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate14" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect14" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate14" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("14") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId14" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId14" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted14" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode14" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode14" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo14" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID14" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'14');" id="IMGJobBreakDownSummary14"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate14" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom14" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo14" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <%-------------------------------8-14(End)---------------------------------------------------%>
                                <%-------------------------------15-21(Begin)---------------------------------------------------%>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate15" Visible="true" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate15" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect15" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate15" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("15") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId15" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId15" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted15" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode15" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode15" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo15" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID15" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'15');" id="IMGJobBreakDownSummary15"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate15" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom15" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo15" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate16" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate16" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect16" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate16" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("16") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId16" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId16" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted16" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode16" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode16" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo16" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID16" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'16');" id="IMGJobBreakDownSummary16"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate16" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom16" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo16" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate17" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate17" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect17" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate17" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("17") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId17" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId17" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted17" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode17" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode17" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo17" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID17" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'17');" id="IMGJobBreakDownSummary17"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate17" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom17" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo17" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate18" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate18" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect18" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate18" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("18") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId18" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId18" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted18" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode18" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode18" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo18" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID18" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'18');" id="IMGJobBreakDownSummary18"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate18" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom18" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo18" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate19" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate19" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect19" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate19" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("19") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId19" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId19" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted19" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode19" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode19" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo19" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID19" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'19');" id="IMGJobBreakDownSummary19"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate19" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom19" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo19" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate20" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate20" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect20" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate20" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("20") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId20" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId20" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted20" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode20" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode20" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo20" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID20" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'20');" id="IMGJobBreakDownSummary20"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate20" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom20" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo20" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate21" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate21" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect21" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate21" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("21") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId21" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId21" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted21" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode21" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode21" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo21" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID21" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'21');" id="IMGJobBreakDownSummary21"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate21" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom21" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo21" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <%-------------------------------15-21(End)---------------------------------------------------%>
                                <%-------------------------------22-28(begin)---------------------------------------------------%>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate22" Visible="true" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate22" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect22" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate22" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("22") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId22" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId22" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted22" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode22" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode22" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo22" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID22" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'22');" id="IMGJobBreakDownSummary22"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate22" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom22" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo22" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate23" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate23" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect23" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate23" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("23") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId23" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId23" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted23" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode23" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode23" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo23" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID23" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'23');" id="IMGJobBreakDownSummary23"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate23" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom23" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo23" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate24" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate24" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect24" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate24" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("24") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId24" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId24" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted24" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode24" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode24" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo24" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID24" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'24');" id="IMGJobBreakDownSummary24"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate24" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom24" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo24" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate25" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate25" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect25" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate25" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("25") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId25" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId25" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted25" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode25" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode25" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo25" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID25" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'25');" id="IMGJobBreakDownSummary25"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate25" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom25" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo25" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate26" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate26" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect26" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate26" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("26") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId26" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId26" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted26" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode26" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode26" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo26" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID26" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'26');" id="IMGJobBreakDownSummary26"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate26" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom26" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo26" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate27" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate27" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect27" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate27" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("27") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId27" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId27" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted27" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode27" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode27" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo27" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID27" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'27');" id="IMGJobBreakDownSummary27"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate27" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom27" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo27" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate28" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate28" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect28" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate28" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("28") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId28" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId28" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted28" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode28" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode28" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo28" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID28" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'28');" id="IMGJobBreakDownSummary28"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate28" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom28" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo28" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <%-------------------------------22-28(End)---------------------------------------------------%>
                                <%-------------------------------29-31(Begin)---------------------------------------------------%>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate29" Visible="true" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate29" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect29" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate29" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("29") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId29" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId29" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted29" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode29" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode29" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo29" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID29" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'29');" id="IMGJobBreakDownSummary29"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate29" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom29" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo29" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate30" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate30" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect30" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate30" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("30") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId30" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId30" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted30" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode30" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode30" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo30" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID30" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'30');" id="IMGJobBreakDownSummary30"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate30" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom30" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo30" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-Width="120px"
                                    ItemStyle-CssClass="GridViewRowStyle">
                                    <HeaderTemplate>
                                        <asp:Label ID="lblHeaderDutyDate31" runat="server"></asp:Label>
                                        <br>
                                        <asp:Label ID="lblTempHeaderDutyDate31" runat="server"></asp:Label>
                                    </HeaderTemplate>
                                    <ItemTemplate>
                                        <asp:Label ID="lblSelect31" runat="server" Text="&nbsp;"></asp:Label>
                                        <asp:Label ID="lblDutyDate31" Style="border: 1px; font-size: smaller" runat="server"
                                            Text='<%# Eval("31") %>' OnClick="javascript:LoadScheduleDetailsOnClientClick(this.id)"></asp:Label>
                                        <asp:Label ID="lblSchAutoId31" runat="server" Text='0' Style="display: none"></asp:Label>
                                        <asp:Label ID="lblOtherAssignmentAutoId31" runat="server" Style="display: none"></asp:Label>
                                        <asp:HiddenField ID="HFIsConverted31" runat="server" />
                                        <asp:HiddenField ID="HFRoleCode31" runat="server" />
                                        <asp:HiddenField ID="HFDutyTypeCode31" runat="server" />
                                        <asp:HiddenField ID="HFPDLineNo31" runat="server" />
                                        <asp:HiddenField ID="HFSchRosterAutoID31" runat="server" />
                                        <img src="../Images/info.gif" onclick="fade('DivJobBreakUp',true,this,'31');" id="IMGJobBreakDownSummary31"
                                            onmouseover="JobBreakDownActive(this.id)" runat="server" onmouseout="JobBreakDownInActive(this.id)"
                                            height="10" width="10" name="advan" border="0" alt="<%$Resources:Resource,ClicktoViewJobBreakDownSummary %>" />
                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="border: 0px;">
                                                    <asp:TextBox ID="txtEmpShiftDutyDate31" Style="text-align: center;" CssClass="csstxtboxSmall"
                                                        onkeyup="javascript:SearchShift(this);" onkeydown="javascript:FunctionCallOnKeyDown('ShiftCode',this)"
                                                        runat="server" Width="12px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeFrom31" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeFrom',this)" runat="server"
                                                        Width="30px" Visible="false"></asp:TextBox>
                                                    <asp:TextBox ID="txtTimeTo31" CssClass="csstxtboxSmall" Style="text-align: center;"
                                                        onkeydown="javascript:FunctionCallOnKeyDown('TimeTo',this)" runat="server" Width="30px"
                                                        Visible="false"></asp:TextBox>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <ItemStyle Width="100px" />
                                    <FooterStyle Width="100px" />
                                </asp:TemplateField>
                                <%-------------------------------29-31(End)---------------------------------------------------%>
                                <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" ItemStyle-CssClass="GridViewRowStyle"
                                    HeaderText="Total Duty Hrs">
                                    <ItemTemplate>
                                        <asp:Label ID="lblDutyMin" runat="server" CssClass="csslblErrMsg" Text='<%# Eval("DutyMin") %>'></asp:Label>
                                        <asp:ImageButton ID="ImgbtnUpdateTran" Visible="false" ToolTip="<%$Resources:Resource,Reset %>"
                                            ImageUrl="~/Images/Reset.gif" OnClientClick="javascript:AssignPostIDValue();"
                                            CssClass="csslnkButton" runat="server" CommandName="Update" ValidationGroup="Edit" />
                                    </ItemTemplate>
                                    <ItemStyle Width="60px" />
                                    <FooterStyle Width="60px" />
                                </asp:TemplateField>
                            </Columns>
                            <PagerTemplate>
                                <table>
                                    <tr>
                                        <td>
                                            <%-- <asp:ImageButton ID="ImageButton1" runat="server" ImageUrl="~/Images/firstpage.gif"
                                                CommandArgument="First" CommandName="Page" />--%>
                                            <asp:ImageButton ID="ImageButton1" runat="server" OnClientClick="if(event.keyCode==0){return false;}"
                                                ImageUrl="~/Images/spacer.gif" />
                                            <asp:ImageButton ID="ImageButton2" runat="server" ImageUrl="~/Images/prevpage.gif"
                                                CommandArgument="Prev" CommandName="Page" />
                                            <asp:Label ID="lblpage" ForeColor="Black" runat="server" Text="<%$Resources:Resource,Page %>"></asp:Label>
                                            <asp:DropDownList ID="ddlPages" CssClass="cssDropDown" runat="server" AutoPostBack="True"
                                                OnSelectedIndexChanged="ddlPages_SelectedIndexChanged">
                                            </asp:DropDownList>
                                            <asp:Label ID="lblOf" ForeColor="Black" runat="server" Text="<%$Resources:Resource,Of %>"></asp:Label>
                                            <asp:Label ID="lblPageCount" ForeColor="Black" runat="server"></asp:Label>
                                            <asp:ImageButton ID="ImageButton3" onkeydown="if(event.keyCode==13){return false;}"
                                                runat="server" ImageUrl="~/Images/nextpage.gif" CommandArgument="Next" CommandName="Page" />
                                            <%--  <asp:ImageButton ID="ImageButton4" runat="server" ImageUrl="~/Images/lastpage.gif"
                                                CommandArgument="Last" CommandName="Page" />--%>
                                        </td>
                                    </tr>
                                </table>
                            </PagerTemplate>
                        </asp:GridView>
                    </td>
                </tr>
            </table>
            <div style="width: 100px;">
                <asp:HiddenField ID="HFDutyMinCheck" runat="server" />
                <asp:HiddenField ID="HFOTReason" runat="server" />
                <asp:HiddenField ID="HFMaxDutyMinInMonth" runat="server" />
                <asp:HiddenField ID="HFColumnIndex" runat="server" />
                <asp:HiddenField ID="HFRowIndex" runat="server" />
                <asp:HiddenField ID="HFNewEmployeeNumber" runat="server" />
                <asp:HiddenField ID="HFNewEmployeeName" runat="server" />
                <asp:HiddenField ID="HFNewEmployeeShiftCode" runat="server" />
                <asp:HiddenField ID="HFNewEmployeeTimeFrom" runat="server" />
                <asp:HiddenField ID="HFNewEmployeeTimeTo" runat="server" />
                <asp:HiddenField ID="HFNewDesignationDesc" runat="server" />
                <asp:HiddenField ID="HFNewTimeFrom" runat="server" />
                <asp:HiddenField ID="HFNewTimeTo" runat="server" />
                <asp:HiddenField ID="HFPost" runat="server" />
                <asp:HiddenField ID="HFPostPaging" runat="server" />
                <asp:HiddenField ID="hfSelectedGridPageCountFinal" runat="server" />
                <asp:HiddenField ID="HFPagingIndex" runat="server" />
                <asp:HiddenField ID="HFPostText" runat="server" />
                <asp:HiddenField ID="HFNewPDLineNo" runat="server" />
                <asp:HiddenField ID="HFScheduleRosterAutoID" runat="server" />
                <asp:HiddenField ID="HFSelectedDutyDate" runat="server" />
                <asp:HiddenField runat="server" ID="HFRowID" />
                <asp:HiddenField runat="server" ID="HFMaxDate" />
                <asp:HiddenField ID="MouseClickColumnID" runat="server" />
                <asp:HiddenField ID="MouseClickRowID" runat="server" />
                <asp:HiddenField ID="hfAssignmentCode" runat="server" />
                <asp:HiddenField ID="HFEditColumnIndex" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail1" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail2" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail3" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail4" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail5" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail6" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail7" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail8" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail9" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail10" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail11" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail12" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail13" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail14" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail15" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail16" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail17" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail18" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail19" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail20" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail21" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail22" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail23" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail24" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail25" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail26" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail27" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail28" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail29" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail30" runat="server" />
                <asp:HiddenField ID="HFChangedEmpDetail31" runat="server" />
                <asp:HiddenField ID="HFCurrentSessionID" runat="server" />
                <asp:HiddenField ID="HFTotalCount" runat="server" />
                <asp:Label ID="lblMsgIDException" runat="server" Text="" Style="display: none;"></asp:Label>
                <asp:Label ID="lblMsgExceptionEmployeeNumber" runat="server" Text="" Style="display: none;"></asp:Label>
                <asp:Label ID="lblMsgExceptionMaxToDate" runat="server" Text="" Style="display: none;"></asp:Label>
                <asp:Label ID="lblMsgException" runat="server" Text="" Style="display: none;"></asp:Label>
                <asp:Button ID="btnUnScheduledEmp" runat="server" OnClick="btnUnScheduledEmp_OnClick"
                    Style="display: none" />
                <asp:Button ID="btnBorrowedEmp" runat="server" OnClick="btnBorrowedEmp_OnClick" Style="display: none" />
                <asp:Button ID="btnEditMode" runat="server" OnClick="btnEditMode_OnClick" Style="display: none" />
            </div>
        </ContentTemplate>
        <Triggers>
            <Ajax:AsyncPostBackTrigger ControlID="btnProceed" EventName="Click" />
            <Ajax:AsyncPostBackTrigger ControlID="ddlScheduleType" EventName="SelectedIndexChanged" />
        </Triggers>
    </Ajax:UpdatePanel>
    <table border="0">
        <tr>
            <td rowspan="20">
                <span id="span3" class="cssLable"></span>
            </td>
            <td style="vertical-align: top">
                <span id="spanShowEmployeeCountClientAndPostWise" class="cssLable"></span>
            </td>
        </tr>
    </table>
    <span id="span_showAllAsmtShift" class="cssLable"></span>
    <asp:HiddenField ID="HFNewDesignationCode" runat="server" />
    <asp:HiddenField ID="HFEnterKeyClickStatus" runat="server" />
    <Ajax:UpdatePanel ID="UPShift" runat="server" UpdateMode="Conditional">
        <ContentTemplate>
            <div id="divShift" style="width: 180px; height: 60px; border: 0px; display: none;
                position: absolute">
                <asp:ListBox ID="LBShift" runat="server" CssClass="cssDropDown" Style="width: 180px;
                    height: 60px" onclick="javascript:SelectShift(this);" onkeydown="javascript:if(event.keyCode == 13 ) {return false;} else if(event.keyCode == 9) SelectShift(this);"
                    onkeyup="javascript:if(event.keyCode == 13) SelectShift(this);"></asp:ListBox>
            </div>
        </ContentTemplate>
    </Ajax:UpdatePanel>
    <Ajax:UpdatePanel ID="UPShiftPattern" runat="server" UpdateMode="Conditional">
        <ContentTemplate>
            <div id="DivShiftPatterns" style="width: 180px; height: 120px; border: 0px; display: none;
                position: absolute">
                <asp:ListBox ID="LBShiftPatterns" runat="server" CssClass="cssDropDown" Style="width: 180px;
                    height: 120px" onclick="javascript:SelectShiftPattern(this);" onkeydown="javascript:if(event.keyCode == 13 ) {return false;} else if(event.keyCode == 9) SelectShiftPattern(this);"
                    onkeyup="javascript:if(event.keyCode == 13) SelectShiftPattern(this);"></asp:ListBox>
            </div>
        </ContentTemplate>
    </Ajax:UpdatePanel>
    <Ajax:UpdatePanel ID="UPDivs" runat="server" UpdateMode="Conditional">
        <ContentTemplate>
            <div id="DivJobBreakUp" class="popup">
                <div class="popuptitle">
                    <asp:Label ID="lblJobBreakDownSummary" runat="server" Text="<%$ Resources:Resource,JobbreakDownSummary %>"></asp:Label>
                </div>
                <div class="popupbody" style="width: 300px;">
                    <p align="left">
                        <span id="SpanjobBreakDownSummary" style="width: 230px;" class="cssLable"></span>
                    </p>
                    <input type="hidden" id="HFJobBreakDownSchRosterAutoID" />
                    <input type="button" id="btnJobBreakClose" value="Close" onclick="fade('DivJobBreakUp',false,'A',0);" />
                    <input type="button" id="btnJobBreakDown" value="JobbreakDownSummary" onclick="javascript:JobBreakDownSummaryDetail();" />
                </div>
            </div>
            <div id="divEmployeeContainer" style="width: 180px; height: 60px; border: 0px; display: none;
                position: absolute">
                <asp:ListBox ID="LBEmployeeList" runat="server" CssClass="cssDropDown" Style="width: 180px;
                    height: 60px" onclick="javascript:SelectEmployee(this);" onkeydown="javascript:if(event.keyCode == 13 ) {return false;} else if(event.keyCode == 9) SelectEmployee(this);"
                    onkeyup="javascript:if(event.keyCode == 13 ) SelectEmployee(this);"></asp:ListBox>
            </div>
            <asp:DropDownList ID="ddlEmployees" runat="server" Style="display: none">
            </asp:DropDownList>
            <div id="DIVMultipleOverwrite" ondblclick="javascript:MoveDuplicateMsgDiv('DIVMultipleOverwrite', event);"
                onmousemove="javascript:checkLoadedObjects(event);" onclick="javascript:dropLoadedObject(event);"
                style="display: none; position: absolute; top: 10%; bottom: 50%;">
                <table cellpadding="4" width="600" cellspacing="0" border="0" style="background-color: #efefef;
                    border: 1px solid #c0c0c0;">
                    <tr style="background-color: #6EB6D5;" valign="top">
                        <td style="width: 91%" colspan="3">
                            <asp:Label ID="Label19" runat="server" Text='<%$ Resources:Resource,OverWriteShift %>'></asp:Label>
                        </td>
                        <td align="right" style="width: 9%; padding-right: 10px;">
                            <img src="../Images/delete.png" onclick="javascript:CloseMsgBoxShift();" id="btnCloseOverwrite"
                                name="close" border="0" alt="Close" style="cursor: hand" />
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div style="overflow-x: hidden; background-color: #FCFDFD; height: 250px; overflow-y: auto;">
                                <span id='span2' style="height: 250px"></span>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td align="center">
                            <table>
                                <tr>
                                    <td>
                                        <input type="button" accesskey="n" id="btnOverWrite" style="vertical-align: baseline;
                                            cursor: hand;" class="cssButton" value="OverWrite" onclick="javascript:OverWriteMultiRecord()" />
                                    </td>
                                    <td>
                                        <input type="button" accesskey="n" id="btnCheckAll" style="vertical-align: baseline;
                                            cursor: hand;" class="cssButton" value="CheckAll" onclick="javascript:CheckAllMultiRecord()" />
                                    </td>
                                    <td>
                                        <input type="button" accesskey="n" id="btnUnCheckAll" style="vertical-align: baseline;
                                            display: none; cursor: hand;" class="cssButton" value="UnCheckAll" onclick="javascript:UnCheckAllMultiRecord()" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </div>
        </ContentTemplate>
    </Ajax:UpdatePanel>
    <asp:HiddenField ID="HidCon" runat="server" />
    <div id="DIVPostSearch" style="width: 205px; height: 60px; border: 0px; display: none;
        position: absolute">
        <asp:ListBox ID="LBPost" runat="server" CssClass="cssDropDown" Style="width: 205px;
            height: 60px" onclick="javascript:SelectPost(this);" onkeydown="javascript:if(event.keyCode == 13 ) {return false;} else if(event.keyCode == 9) SelectPost(this);"
            onkeyup="javascript:if(event.keyCode == 13) SelectPost(this);"></asp:ListBox>
    </div>
    <Ajax:UpdatePanel ID="UPUnScheduledEmp" runat="server" UpdateMode="Conditional">
        <ContentTemplate>
            <div id="DIVUnScheduledEmployees" runat="server" visible="false" style="position: absolute;
                width: 700px; height: 350px; top: 10%; bottom: 50%;">
                <table cellpadding="4" width="100%" cellspacing="0" border="0" style="background-color: #efefef;
                    border: 1px solid #c0c0c0;">
                    <tr style="background-color: #6EB6D5;" valign="top">
                        <td style="width: 91%" colspan="3">
                            <%--<asp:Label ID="Label2" runat="server" Text='<%$ Resources:Resource,OverWriteShift %>'></asp:Label>--%>
                            <a href="javascript:BorrowUnSchEmpDiv('DIVUnScheduledEmployees');" onclick="changeText(this,'List of Employees');"
                                id="text1link">Borrowed Employee</a>
                            <asp:Button ID="btnExportToExcel" Width="150px" Text="Export To Excel" OnClick="btnExportToExcel_Click"
                                runat="server" />
                        </td>
                        <td align="right" style="width: 9%; padding-right: 10px;">
                            <img src="../Images/delete.png" onclick="javascript:CloseUnSchEmpDiv('DIVUnScheduledEmployees');"
                                id="Img2" name="close" border="0" alt="Close" style="cursor: hand" />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="5">
                            <telerik:RadGrid ID="gvUnScheduledEmployees" runat="server" Width="100%" AllowFilteringByColumn="true"
                                OnNeedDataSource="gvUnScheduledEmployees_NeedDataSource" AllowSorting="True"
                                AutoGenerateColumns="false" AllowMultiRowSelection="True" AllowPaging="true"
                                PageSize="10" ExportSettings-IgnorePaging="true" ShowGroupPanel="True" GridLines="None"
                                Skin="Office2007" ExportSettings-ExportOnlyData="true">
                                <PagerStyle Mode="NextPrevAndNumeric"></PagerStyle>
                                <MasterTableView AllowMultiColumnSorting="True" CommandItemDisplay="TopAndBottom">
                                    <CommandItemSettings ShowExportToExcelButton="false" ShowAddNewRecordButton="false"
                                        ShowRefreshButton="false"></CommandItemSettings>
                                    <Columns>
                                        <telerik:GridTemplateColumn UniqueName="EmployeeNumber" GroupByExpression="EmpNo"
                                            DataField="EmpNo" SortExpression="EmpNo" HeaderText="Employee No.">
                                            <ItemTemplate>
                                                <asp:Label ID="lnkEmpNo" onclick="javascript:AssignToSelectedTextBox(this);" Style="cursor: hand"
                                                    runat="server" CommandName="Empclick" Text='<%# Bind("EmpNo")%>'></asp:Label>
                                            </ItemTemplate>
                                        </telerik:GridTemplateColumn>
                                        <telerik:GridBoundColumn SortExpression="EmpName" HeaderText="<%$ Resources:Resource, EmployeeName %>"
                                            HeaderButtonType="TextButton" DataField="EmpName">
                                        </telerik:GridBoundColumn>
                                        <telerik:GridBoundColumn SortExpression="DesigNationDesc" HeaderText="<%$ Resources:Resource, Designation %>"
                                            HeaderButtonType="TextButton" DataField="DesigNationDesc">
                                        </telerik:GridBoundColumn>
                                        <telerik:GridBoundColumn SortExpression="WeeklyDutyMin" HeaderText="Week(Hrs Worked)"
                                            HeaderButtonType="TextButton" DataField="WeeklyDutyMin">
                                        </telerik:GridBoundColumn>
                                        <telerik:GridBoundColumn SortExpression="MonthDutyMin" HeaderText="Month(Hrs Worked)"
                                            HeaderButtonType="TextButton" DataField="MonthDutyMin">
                                        </telerik:GridBoundColumn>
                                    </Columns>
                                </MasterTableView>
                                <ExportSettings>
                                    <Excel Format="ExcelML"></Excel>
                                </ExportSettings>
                                <ClientSettings AllowDragToGroup="True">
                                    <Selecting AllowRowSelect="True"></Selecting>
                                    <Scrolling AllowScroll="True" UseStaticHeaders="True"></Scrolling>
                                    <ClientMessages DragToGroupOrReorder="Drag to group" />
                                    <Resizing AllowRowResize="True" AllowColumnResize="True" EnableRealTimeResize="True"
                                        ResizeGridOnColumnResize="False"></Resizing>
                                </ClientSettings>
                                <GroupingSettings ShowUnGroupButton="true" />
                            </telerik:RadGrid>
                        </td>
                    </tr>
                </table>
            </div>
        </ContentTemplate>
        <Triggers>
            <Ajax:PostBackTrigger ControlID="btnExportToExcel" />
        </Triggers>
    </Ajax:UpdatePanel>
    <Ajax:UpdatePanel ID="UPAdditionalHrs" runat="server" UpdateMode="Conditional">
        <ContentTemplate>
            <div id="DivAdditionalHrs" runat="server" ondblclick="javascript:MoveDuplicateMsgDiv('DivAdditionalHrs', event);"
                onmousemove="javascript:checkLoadedObjects(event);" onclick="javascript:dropLoadedObject(event);"
                style="display: none; position: absolute; top: 10%; bottom: 50%;">
                <table cellpadding="4" width="700px" cellspacing="0" border="0" style="background-color: #efefef;
                    border: 1px solid #c0c0c0;">
                    <tr style="background-color: #6EB6D5;" valign="top">
                        <td style="width: 100%" colspan="3">
                            <asp:Label ID="Label23" runat="server" Text='Additional Hours Detail'></asp:Label>
                        </td>
                        <td align="right" style="width: 9%; padding-right: 10px;">
                            <img src="../Images/delete.png" onclick="javascript:CloseDivAdditionalHrs('DivAdditionalHrs')"
                                id="Img1" name="close" border="0" alt="Close" style="cursor: hand" />
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div style="overflow-x: hidden; background-color: #FCFDFD; height: 380px; overflow-y: auto;">
                                <table>
                                    <tr>
                                        <td align="right">
                                            <asp:Label ID="Label3" CssClass="cssLabel" runat="server" Text="<%$Resources:Resource,ClientCode %>"></asp:Label>
                                        </td>
                                        <td align="left">
                                            <asp:DropDownList ID="ddlAdditionalClientCode" Width="250px" OnSelectedIndexChanged="ddlAdditionalClientCode_SelectedIndexChanged"
                                                CssClass="cssDropDown" AutoPostBack="true" runat="server">
                                            </asp:DropDownList>
                                        </td>
                                        <td align="right">
                                            <asp:Label ID="Label4" CssClass="cssLabel" runat="server" Text="<%$Resources:Resource,FromDate %>"></asp:Label>
                                        </td>
                                        <td align="left">
                                            <asp:TextBox ID="txtAdditionalFromDate" Width="80px" runat="server" CssClass="csstxtbox"></asp:TextBox>
                                            <asp:HyperLink ID="ImgFromDate" runat="server" ImageUrl="~/Images/pdate.gif"></asp:HyperLink>
                                            <AjaxToolKit:CalendarExtender ID="CalendarExtender4" Format="dd-MMM-yyyy" runat="server"
                                                TargetControlID="txtAdditionalFromDate" PopupButtonID="ImgFromDate">
                                            </AjaxToolKit:CalendarExtender>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="right">
                                            <asp:Label ID="Label20" CssClass="cssLabel" runat="server" Text="<%$Resources:Resource,AsmtCode %>"></asp:Label>
                                        </td>
                                        <td align="left">
                                            <asp:DropDownList ID="ddlAdditionalAsmtCode" Width="250px" OnSelectedIndexChanged="ddlAdditionalAsmtCode_SelectedIndexChanged"
                                                CssClass="cssDropDown" AutoPostBack="true" runat="server">
                                            </asp:DropDownList>
                                        </td>
                                        <td align="right">
                                            <asp:Label ID="Label21" CssClass="cssLabel" runat="server" Text="<%$Resources:Resource,ToDate %>"></asp:Label>
                                        </td>
                                        <td align="left">
                                            <asp:TextBox ID="txtAdditionalToDate" Width="80px" runat="server" CssClass="csstxtbox"></asp:TextBox>
                                            <asp:HyperLink ID="HLToDate" runat="server" ImageUrl="~/Images/pdate.gif"></asp:HyperLink>
                                            <AjaxToolKit:CalendarExtender ID="CalendarExtender5" Format="dd-MMM-yyyy" runat="server"
                                                TargetControlID="txtAdditionalToDate" PopupButtonID="HLToDate">
                                            </AjaxToolKit:CalendarExtender>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="right">
                                            <asp:Label ID="Label22" CssClass="cssLabel" runat="server" Text="<%$Resources:Resource,Post %>"></asp:Label>
                                        </td>
                                        <td align="left">
                                            <asp:DropDownList ID="ddlAdditionalPostCode" AutoPostBack="true" OnSelectedIndexChanged="ddlAdditionalPostCode_SelectedIndexChanged"
                                                Width="250px" CssClass="cssDropDown" runat="server">
                                            </asp:DropDownList>
                                        </td>
                                        <td align="left">
                                            <asp:Button ID="btnAdditionalHrs" runat="server" CssClass="cssButton" Text="<%$Resources:Resource,ViewDetails %>"
                                                OnClick="btnAdditionalHrs_Click" />
                                        </td>
                                        <td align="left">
                                            <asp:Button ID="btnExport" Style="display: none" runat="server" CssClass="cssButton"
                                                Text="Export" OnClick="btnExport_Click" />
                                        </td>
                                    </tr>
                                </table>
                                <table>
                                    <tr>
                                        <td>
                                            <asp:GridView ID="gvAdditionalHrs" runat="server" CssClass="GridViewStyle" AllowPaging="true"
                                                PageSize="10" ShowHeader="true" AutoGenerateColumns="false" OnPageIndexChanging="gvAdditionalHrs_PageIndexChanging">
                                                <Columns>
                                                    <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" FooterStyle-CssClass="GridViewFooterStyle"
                                                        ItemStyle-CssClass="GridViewRowStyle" HeaderStyle-HorizontalAlign="Left" ItemStyle-Width="120px">
                                                        <HeaderTemplate>
                                                            <asp:Label ID="lblEmployeeNo" CssClass="cssLabel" runat="server" Text="<%$Resources:Resource,EmployeeNumber %>"></asp:Label>
                                                        </HeaderTemplate>
                                                        <ItemTemplate>
                                                            <asp:Label ID="LBEmployeeNumber" Style="cursor: hand" runat="server" CommandName="Empclick"
                                                                Text='<%# Eval("SchEmployeeNumber")%>'></asp:Label>
                                                        </ItemTemplate>
                                                    </asp:TemplateField>
                                                    <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" FooterStyle-CssClass="GridViewFooterStyle"
                                                        ItemStyle-CssClass="GridViewRowStyle" HeaderStyle-HorizontalAlign="Left" ItemStyle-Width="250px">
                                                        <HeaderTemplate>
                                                            <asp:Label ID="lblEmployeeName" CssClass="cssLabel" runat="server" Text="<%$Resources:Resource,EmployeeName %>"></asp:Label>
                                                        </HeaderTemplate>
                                                        <ItemTemplate>
                                                            <asp:Label ID="lblEmpName" Style="width: 250px" runat="server" CssClass="cssLable"
                                                                Text='<%#Bind("EmployeeName") %>' ToolTip="<%$ Resources:Resource, EmployeeName %>"></asp:Label>
                                                        </ItemTemplate>
                                                    </asp:TemplateField>
                                                    <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" FooterStyle-CssClass="GridViewFooterStyle"
                                                        ItemStyle-CssClass="GridViewRowStyle" HeaderStyle-HorizontalAlign="Left" ItemStyle-Width="120px">
                                                        <HeaderTemplate>
                                                            <asp:Label ID="lblActHrs" CssClass="cssLabel" runat="server" Text="Actual Hours"></asp:Label>
                                                        </HeaderTemplate>
                                                        <ItemTemplate>
                                                            <asp:Label ID="lblActDutyHrs" Style="width: 120px" runat="server" CssClass="cssLable"
                                                                Text='<%#Bind("ActDutyHrs") %>'></asp:Label>
                                                        </ItemTemplate>
                                                    </asp:TemplateField>
                                                    <asp:TemplateField HeaderStyle-CssClass="GridViewHeaderStyle" FooterStyle-CssClass="GridViewFooterStyle"
                                                        ItemStyle-CssClass="GridViewRowStyle" HeaderStyle-HorizontalAlign="Left" ItemStyle-Width="120px">
                                                        <HeaderTemplate>
                                                            <asp:Label ID="lblAddHrs" CssClass="cssLabel" runat="server" Text="Additional Hours"></asp:Label>
                                                        </HeaderTemplate>
                                                        <ItemTemplate>
                                                            <asp:Label ID="lblAdditionalHrs" Style="width: 120px" runat="server" CssClass="cssLable"
                                                                Text='<%#Bind("AdditionalHrs") %>'></asp:Label>
                                                        </ItemTemplate>
                                                    </asp:TemplateField>
                                                </Columns>
                                            </asp:GridView>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
        </ContentTemplate>
    </Ajax:UpdatePanel>
    <div id="divSearchEmployeeSchedule" style="width: 650px; height: 280px; display: none;
        overflow: scroll; border: 1px; border-top: 1px; border-style: solid; border-color: Red;
        position: absolute; background: white; left: 180px; top: 150px;">
        <asp:Label ID="Label17" runat="server" Text='<%$ Resources:Resource,EmployeeNumber %>'></asp:Label>
        <input type="text" id="search_txtEmployeeNumber" class="csstxtboxSmall" maxlength="10" />
        <asp:Label ID="Label18" runat="server" Text='<%$ Resources:Resource,EmployeeName %>'></asp:Label>
        <input type="text" id="search_txtEmployeeName" class="csstxtboxSmall" maxlength="10"
            onkeyup="javascript:func_EmpNameSearch(this);" />
        <input type="button" id="btnEmployeeSearch" class="cssButton" value="Go" onclick="javascript:Search_GetEmployeeSchedule()" />
        <a href="javascript:closeEmployeeSearch('divSearchEmployeeSchedule')">Close</a>
        <asp:DropDownList ID="ddlEmployeesForSearch" runat="server" Style="display: none">
        </asp:DropDownList>
        <span id="span_EmployeeSchedule" class="cssLable"></span>
    </div>
    <div id="divEmployeeList" style="width: 205px; height: 60px; border: 0px; display: none;
        position: absolute">
        <asp:ListBox ID="lstBox_Employees" runat="server" CssClass="cssDropDown" Style="width: 205px;
            height: 60px" onclick="javascript:func_SelectEmployee(this);" onkeydown="javascript:if(event.keyCode == 13 ) {return false;} else if(event.keyCode == 9) func_SelectEmployee(this);"
            onkeyup="javascript:if(event.keyCode == 13) func_SelectEmployee(this);"></asp:ListBox>
    </div>
    <div id="divAdjustment" style="width: 200px; height: 80px; display: none; border: 1px;
        border-top: 1px; border-style: solid; border-color: Gray; position: absolute;
        background: white; left: 180px; top: 150px;">
        <table cellpadding="1" cellspacing="0" style="font-size: xx-small">
            <tr>
                <td>
                    <asp:Label ID="lblAdjustmentHrs" runat="server" Text="<%$ Resources:Resource,Hours%>"></asp:Label>
                </td>
                <td>
                    <asp:TextBox ID="txtAdjustmentHrs" runat="server" CssClass=" csstxtboxSmall" MaxLength="5"
                        Text="00.00" Width="30px"></asp:TextBox>
                    <AjaxToolKit:MaskedEditExtender ID="MaskedEditExtenderHoursPerUnit" AutoComplete="true"
                        AutoCompleteValue="0" AcceptNegative="None" runat="server" TargetControlID="txtAdjustmentHrs"
                        Mask="99.99" MessageValidatorTip="true" MaskType="Number" AcceptAMPM="false"
                        ClearTextOnInvalid="true" ErrorTooltipEnabled="True">
                    </AjaxToolKit:MaskedEditExtender>
                </td>
            </tr>
            <tr>
                <td>
                    <asp:Label ID="lblAdjustmentType" runat="server" Text="<%$ Resources:Resource,Type%>"></asp:Label>
                </td>
                <td colspan="2">
                    <asp:DropDownList ID="AdjType" CssClass="cssDropDown" runat="server" Width="140">
                    </asp:DropDownList>
                </td>
            </tr>
            <tr>
                <td>
                    <asp:Label ID="lblAdjustmentRemark" runat="server" Text="<%$ Resources:Resource,Remark%>"></asp:Label>
                </td>
                <td colspan="2">
                    <asp:TextBox ID="txtAdjustmentRemark" runat="server" CssClass=" csstxtboxSmall" MaxLength="100"
                        Width="140px"></asp:TextBox>
                </td>
            </tr>
            <tr>
                <td>
                    <a id="SaveAdjustment" href="javascript:funcHoursAdjustment('I');" style="cursor: pointer">
                        Save</a>
                </td>
                <td>
                    <a id="DeleteAdjustment" href="javascript:funcHoursAdjustment('D');" style="cursor: pointer">
                        Delete</a>
                </td>
                <td>
                    <a href="javascript:CloseAdjustment();" style="cursor: pointer">Close</a>
                </td>
            </tr>
        </table>
    </div>
    <Ajax:UpdatePanel ID="UPDates" runat="server" UpdateMode="Conditional">
        <ContentTemplate>
            <div style="width: 100px; height: 10px">
                <asp:Button ID="btnDatesGet" runat="server" Style="display: none;" OnClick="btnDatesGet_Click" />
                <asp:HiddenField ID="HFFromDate" runat="server" />
                <asp:HiddenField ID="HFToDate" runat="server" />
                <asp:HiddenField ID="HFMonthChangeStatus" runat="server" />
                <asp:HiddenField ID="hfParentAsmtCode" runat="server" Value="" />
                <asp:HiddenField ID="hfParentClientCode" runat="server" Value="" />
                <asp:HiddenField ID="hfParentDate" runat="server" Value="" />
            </div>
        </ContentTemplate>
    </Ajax:UpdatePanel>
    <Ajax:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Conditional">
        <ContentTemplate>
            <div id="contextMenu1">
                <telerik:RadContextMenu EnableAutoScroll="true" ID="RadContextMenu" Skin="Office2007"
                    runat="server">
                    <Targets>
                        <telerik:ContextMenuElementTarget ElementID="gvScheduleRoster" />
                    </Targets>
                </telerik:RadContextMenu>
            </div>
        </ContentTemplate>
    </Ajax:UpdatePanel>
    <asp:HiddenField ID="hfGridPageCount" runat="server" />
    <asp:HiddenField ID="hfSelectedGridPageCount" runat="server" />
    </form>
    <script language="javascript" type="text/javascript">
        String.prototype.trim = function () {
            return this.replace(/^\s*/, "").replace(/\s*$/, "");
        }
        document.onkeyup = ShortCutKeys;

        $('.cssProceedScheduleButton').live('click', function (e) {
            if (document.getElementById('<%=ddlPost.ClientID %>').selectedIndex != -1) {
                // if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Sch') {

                GetReqSch();
                //}
            }
        });


        var SessionCulture = '<% = Session["MyCulture"] %>';
        var SessionUserId = '<% = Session["UserID"] %>';
        var SessionLocationAutoId = '<% = Session["LocationAutoID"] %>';
        var SessionCompanyCode = '<% = Session["CompanyCode"] %>';
        var SessionHrLocationCode = '<% = Session["HrLocationCode"] %>';
        var SessionLocationCode = '<% = Session["LocationCode"] %>';
        var SessionLoginType = '<% = Session["UserIDType"] %>';
        var GlobEmployeeNumber;
        var globBorrowedEmployeeStatus;
        var GlobEmployeeName;
        var GlobEmployeeDesgDesc;
        var GlobEmployeeDesgCode;
        var GlobEmployeeDutyDate;
        var GlobEmployeeTimeFrom;
        var GlobEmployeeTimeTo;
        var GlobEmployeeSchRosterAutoID;
        var GlobEmployeeShiftCode;
        var GlobEmployeeDetails;
        var GlobPDLineNo;
        var GlobColumnType;
        var GlobDefaultSite;
        var GlobPatternPosition;
        var GlobShiftPatternCode;
        var GlobPDLineWiseShiftPatternCode;
        var GlobOverwriteStatus;
        var GlobStrCopyRange;
        var GlobRowNumber;
        var GlobObject;
        var globCopyStatus; // If Insert Key is pressed this will have "1" as its value otherwise "0" as its value
        /*   This Section get the values from resource file   */
        var SessionAreaInchargeNumber = '<% = Session["EmployeeNumber"] %>';
        var IsAreaIncharge = '<% = Session["IsAreaIncharge"] %>';
        var RefresherTrainingPending = '<%= Resources.Resource.RefresherTrainingPending %>';
        var January = '<%= Resources.Resource.January %>';
        var February = '<%= Resources.Resource.February %>';
        var March = '<%= Resources.Resource.March %>';
        var April = '<%= Resources.Resource.April %>';
        var May = '<%= Resources.Resource.May %>';
        var June = '<%= Resources.Resource.June %>';
        var July = '<%= Resources.Resource.July %>';
        var August = '<%= Resources.Resource.August %>';
        var September = '<%= Resources.Resource.September %>';
        var October = '<%= Resources.Resource.October %>';
        var November = '<%= Resources.Resource.November %>';
        var December = '<%= Resources.Resource.December %>';
        var DateRange = '<%= Resources.Resource.Date %>';
        var Total = '<%= Resources.Resource.Total %>';
        var MsgSuccessfullyLocked = '<%= Resources.Resource.MsgSuccessfullyLocked %>';
        var JobbreakDownSummary = '<%= Resources.Resource.JobbreakDownSummary %>';
        var InvalidEmpCode = '<%= Resources.Resource.InvalidEmpCode %>';
        var InvalidShiftPatternPosition = '<%= Resources.Resource.InvalidShiftPatternPosition %>';
        var EmployeecannotbeleftBlank = '<%= Resources.Resource.EmployeecannotbeleftBlank %>';
        var InvalidAssignment = '<%= Resources.Resource.InvalidAssignment %>';
        var Dataisnotcopiedproperly = '<%= Resources.Resource.Dataisnotcopiedproperly %>';
        var FollowingRecordscannotbecopied = '<%= Resources.Resource.FollowingRecordscannotbecopied %>';
        var SuccessfullyCopied = '<%= Resources.Resource.MsgSuccessfullyCopied %>';
        var TimeisNotInValidFormat = '<%= Resources.Resource.TimeisNotInValidFormat %>';
        var HourMustBeBetween0And23 = '<%= Resources.Resource.HourMustBeBetween0And23 %>';
        var MinuteMustBeBetween0And59 = '<%= Resources.Resource.MinuteMustBeBetween0And59 %>';
        var NoDatatoCopy = '<%= Resources.Resource.NoDatatoCopy %>';
        var ShiftCodeCannotbeleftBlank = '<%= Resources.Resource.ShiftCanNotBeLeftBlank %>';
        var RoleCannotbeleftBlank = '<%= Resources.Resource.RoleCannotbeleftBlank %>';
        var TimeFromCannotbeleftBlank = '<%= Resources.Resource.TimeFromCannotbeleftBlank %>';
        var Minimumprofitabilitynotmet = '<%= Resources.Resource.Minimumprofitabilitynotmet %>';
        var OptimumProfitabilityMismatch = '<%= Resources.Resource.OptimumProfitabilityMismatch %>';
        var InvalidShiftPattern = '<%= Resources.Resource.InvalidShiftPattern %>';

        var DutyTypeCannotbeleftBlank = '<%= Resources.Resource.DutyTypeCannotbeleftBlank %>';
        var Duplicate = '<%= Resources.Resource.Duplicate %>';
        var AreyousureyouwanttoLocktheSchedule = '<%= Resources.Resource.AreyousureyouwanttoLocktheSchedule %>';

        var OverWrite = '<%= Resources.Resource.OverWrite %>';
        var pageTitle = '<%= Resources.Resource.ScheduleRosterEmpWise %>'//Resources.Resource.ScheduleRosterEmpWise
        var Insert = '<%= Resources.Resource.Insert %>';
        var Alert = '<%= Resources.Resource.Alert %>';

        var ErrorMessage = '<%= Resources.Resource.ErrorMessage %>';
        var EmployeeNumberCannotbeleftBlank = '<%= Resources.Resource.EmployeeNumberCannotbeleftBlank %>';
        var InvalidShift = '<%= Resources.Resource.InvalidShift %>';
        var Converted = '<%= Resources.Resource.Converted %>';
        var Leave = '<%= Resources.Resource.Leave %>';
        var Times = '<%= Resources.Resource.Time %>';
        var Shift = '<%= Resources.Resource.Shift %>';
        var Close = '<%= Resources.Resource.Close %>';
        var Copy = '<%= Resources.Resource.Copy %>';
        var OverWriteShift = '<%= Resources.Resource.OverWriteShift %>';
        var CheckAll = '<%= Resources.Resource.CheckAll %>';
        var UnCheckALL = '<%= Resources.Resource.UnCheckALL %>';
        var EmployeeSkillsDoesNotMatchWithRequiredSkillsDoYouWantToContinue = '<%= Resources.Resource.EmployeeSkillsDoesNotMatchWithRequiredSkillsDoYouWantToContinue %>';
        var EmployeePayRateIsGreaterThanSaleOrderPayRateDoYouWantToContinue = '<%= Resources.Resource.EmployeePayRateIsGreaterThanSaleOrderPayRateDoYouWantToContinue %>';
        var TimeToCannotbeleftBlank = '<%= Resources.Resource.TimeToCannotbeleftBlank %>';
        var Employeeisbarredfromthisassignment = '<%= Resources.Resource.Employeeisbarredfromthisassignment %>';
        var EmployeeDoesnotbelongstothisArea = '<%= Resources.Resource.EmployeeDoesnotbelongstothisArea %>';
        var Employeedutydatecannotbegreaterthandateofresignation = '<%= Resources.Resource.Employeedutydatecannotbegreaterthandateofresignation %>';
        var EmpJoiningDatecannotbegreaterthanDutydate = '<%= Resources.Resource.EmployeeJoiningDatecannotbegreaterthanDutydate %>';
        var FollowingMandatoryskillsdoesnotmatch = '<%= Resources.Resource.FollowingMandatoryskillsdoesnotmatch %>';

        var AuthorizedRotaCannotbeDeleted = '<%= Resources.Resource.AuthorizedRotaCannotbeDeleted %>';
        var MsgConfirmDelete = '<%= Resources.Resource.MsgConfirmDelete %>';

        /*   END OF Section get the values from resource file   */


        // This function Initialize button text from resource file 
        function initializeVariables() {
            document.getElementById('btnJobBreakClose').value = Close;
            document.getElementById('btnCheckAll').value = CheckAll;
            document.getElementById('btnUnCheckAll').value = UnCheckALL;
            document.getElementById('btnCloseOverwrite').alt = Close;
            document.getElementById('btnOverWrite').value = OverWrite;
        }

        // This function is used to close additional hours div
        function CloseDivAdditionalHrs() {
            document.getElementById('DivAdditionalHrs').style.display = 'none';
        }

        // This function is used to check all CHECK BOX when duplicate recors Div appears
        function CheckAllMultiRecord() {
            var totalCount = document.getElementById('totalDuplicatedCount0').value;
            for (var i = 0; i < totalCount; i++) {
                if (document.getElementById('chk' + i) == "[object]") {
                    if (document.getElementById('chk' + i).checked == false) {
                        document.getElementById('chk' + i).checked = true;
                    }
                }
            }
            document.getElementById('btnUnCheckAll').style.display = 'block';
            document.getElementById('btnCheckAll').style.display = 'none';
        }
        // This function is used to uncheck all CHECK BOX when duplicate recors Div appears
        function UnCheckAllMultiRecord() {
            var totalCount = document.getElementById('totalDuplicatedCount0').value;
            for (var i = 0; i < totalCount; i++) {
                if (document.getElementById('chk' + i) == "[object]") {
                    if (document.getElementById('chk' + i).disabled == false) {
                        if (document.getElementById('chk' + i).checked == true) {
                            document.getElementById('chk' + i).checked = false;
                        }
                    }
                }
            }
            document.getElementById('btnUnCheckAll').style.display = 'none';
            document.getElementById('btnCheckAll').style.display = 'block';
        }

        //        
        var fadeOpacity = new Array();
        var fadeTimer = new Array();
        var fadeInterval = 10;  // milliseconds
        var GlobObjTofade;
        var GlobObjfadeDisplay;
        var GlobObjfadeImageObject;
        var GlobObjfadeColumnIndex;
        // This function is used to show animation in message box when any job break down is entered for an employee
        function fade(o, d, imageObject, columnIndex) {

            // o - Object to fade in or out.
            // d - Display, true =  fade in, false = fade out
            if (document.getElementById(o) == '[object]') {
                GlobObjTofade = o;
                GlobObjfadeDisplay = d;
                GlobObjfadeImageObject = imageObject;
                GlobObjfadeColumnIndex = columnIndex;
            }
            else {
                var obj = document.getElementById(GlobObjTofade);
                if (obj.style.display == 'block') {
                    obj.style.display = 'none';
                    document.getElementById('HFJobBreakDownSchRosterAutoID').value = '';
                    LoadingComplete();
                    return;
                }
            }

            var obj = document.getElementById(o);
            if (obj.style.display == 'block') {
                obj.style.display = 'none';
            }

            columnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var schRosterAutoId = "HFSchRosterAutoID" + columnIndex;
            var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
            var rowClientId = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var cellScheduleRosterAutoId = document.getElementById(getClientId(rowClientId, schRosterAutoId)).value;
            document.getElementById('HFJobBreakDownSchRosterAutoID').value = '';
            document.getElementById('HFJobBreakDownSchRosterAutoID').value = cellScheduleRosterAutoId;
            // Passed area Id to job Break Bown Summary page
            WebMethods.GetJobBreakDownSummary(document.getElementById('<%= HidCon.ClientID %>').value, SessionCompanyCode, SessionHrLocationCode, SessionLocationCode, cellScheduleRosterAutoId, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), OnGetJobBreakDownComplete, OnWSRequestFailed);
            try {
                if ((fadeTimer[o]) || (d && obj.style.display != 'block') || (!d && obj.style.display == 'block')) {

                    if (fadeTimer[o])
                        clearInterval(fadeTimer[o]);
                    else
                        if (d) fadeOpacity[o] = 0;
                        else fadeOpacity[o] = 9;

                    obj.style.opacity = "." + fadeOpacity[o].toString();
                    obj.style.filter = "alpha(opacity=" + fadeOpacity[o].toString() + "0)";

                    if (d) {
                        obj.style.display = 'block';
                        var coors = findPos(imageObject);
                        obj.style.top = coors[1] + 20 + 'px';
                        obj.style.left = coors[0] + 'px';
                        fadeTimer[o] = setInterval('fadeAnimation("' + o + '",1);', fadeInterval);
                    }
                    else
                        fadeTimer[o] = setInterval('fadeAnimation("' + o + '",-1);', fadeInterval);
                }
            }
            catch (Error) { return; }
        }

        // This function is used to show animation in message box when any job break down is entered for an employee
        function fadeAnimation(o, i) {

            // o - o - Object to fade in or out.
            // i - increment, 1 = Fade In

            var obj = document.getElementById(o);
            fadeOpacity[o] += i;
            obj.style.opacity = "." + fadeOpacity[o].toString();
            obj.style.filter = "alpha(opacity=" + fadeOpacity[o].toString() + "0)";

            if ((fadeOpacity[o] == '9') | (fadeOpacity[o] == '0')) {
                if (fadeOpacity[o] == '0')
                    obj.style.display = 'none';
                else {
                    obj.style.opacity = "1";
                    obj.style.filter = "alpha(opacity=100)";
                }

                clearInterval(fadeTimer[o]);
                delete (fadeTimer[o]);
                delete (fadeTimer[o]);
                delete (fadeOpacity[o]);

            }
        }
        // This function is used to get job Break down details of the employee when user clicks the IMAGE shown in each cell of the gridview if any break down is entered
        function OnGetJobBreakDownComplete(result) {
            document.getElementById('SpanjobBreakDownSummary').innerHTML = '';
            var res1 = result;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");
            var l = 0;
            var strTable;
            strTable = "<table border='0' cellpadding=0 cellspacing=1 style='font-size:11px' > ";
            strTable = strTable + "<tr style='background-color:#B7CEEC' >";
            strTable = strTable + "<td width=150px>Job Desc</td>";
            strTable = strTable + "<td width=80px>Time From</td>";
            strTable = strTable + "<td width=80px>Time To</td>";
            strTable = strTable + "</tr>";

            for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {
                strTable = strTable + "<tr><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("JobDesc")[l].firstChild.nodeValue + "</td><td>";
                if (xmlDoc1.getElementsByTagName("TimeFrom")[l].firstChild.nodeValue == "BLANK") {
                    strTable = strTable + "" + "</td><td>";
                    strTable = strTable + "" + "</td></tr>";
                } else {
                    strTable = strTable + xmlDoc1.getElementsByTagName("TimeFrom")[l].firstChild.nodeValue + "</td><td>";
                    strTable = strTable + xmlDoc1.getElementsByTagName("TimeTo")[l].firstChild.nodeValue + "</td></tr>";
                }
                l++;
            }

            strTable = strTable + "</table>";
            document.getElementById('SpanjobBreakDownSummary').innerHTML = strTable;
        }
        // This function is used to change the color of the image when mouse is moved on the IMAGE shown in each cell of the gridview if any break down is entered
        function JobBreakDownActive(id) {

            if (document.images)
                document.getElementById(id).src = "../Images/infored.gif";
        }
        // This function is used to change the color of the image when mouse is moved on the IMAGE shown in each cell of the gridview if any break down is entered
        function JobBreakDownInActive(id) {
            if (document.images)

                document.getElementById(id).src = "../Images/info.gif";
        }
        // This function is called on the Load event of the page and it is used to initialize all variables and PAGE NAME on top of the PAGE
        function OnLoad() {
            if (SessionLoginType != 'C') {

                // initContextMenus();
                initializeVariables();
            }
            FillClient();
            PageTitle(pageTitle);
            if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Sch') {
                document.getElementById('<%=ddlScheduleType.ClientID %>').value = "Weekly"
                document.getElementById('<%=ddlScheduleType.ClientID %>').disabled = true;
            }
            else {
                document.getElementById('<%=ddlScheduleType.ClientID %>').disabled = false;
            }
        }

        function onUnload() {

        }


        function FillClient() {

            document.getElementById('<%=HFEmployeeSearch.ClientID %>').value = "";
            var ddlClient = document.getElementById('<%= ddClient.ClientID %>');
            ddlClient.length = 0;
            GlobAsmtCode = '';
            document.getElementById('<% =ddlPost.ClientID %>').options.length = 0;
            if (document.getElementById('<%=gvScheduleRoster.ClientID %>') == '[object]') {

                document.getElementById('<%=gvScheduleRoster.ClientID %>').style.display = 'none';
            }
            document.getElementById('<% =ddAssignment.ClientID %>').options.length = 0;
            document.getElementById('<% =txtAsmtCode.ClientID %>').value = "";
            if (document.getElementById('<%=ddlPost.ClientID %>').selectedIndex != -1) {
                document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            }
            else {
                document.getElementById('<%=btnProceed.ClientID %>').disabled = true;
            }
            LoadingStart();
            ResetPaging();
            WebMethods.GetAllClients(document.getElementById('<%= HidCon.ClientID %>').value, SessionLocationAutoId, document.getElementById('<%= ddlArea.ClientID %>').value, "", SessionAreaInchargeNumber, IsAreaIncharge, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), OnGetAllClients, OnWSRequestFailed, ddlClient);
        }
        function OnGetAllClients(result, ddlClient) {
            var l = 0;
            var res1 = result;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");
            for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {

                ddlClient.options[l] = new Option(xmlDoc1.getElementsByTagName("ClientName")[l].firstChild.nodeValue, xmlDoc1.getElementsByTagName("ClientCode")[l].firstChild.nodeValue);
                if (l == 0) {
                    document.getElementById('<%= txtClientCode.ClientID %>').value = xmlDoc1.getElementsByTagName("ClientCode")[l].firstChild.nodeValue;
                }
                l = l + 1;

            }
            if (ddlClient.length != 0) {
                var ddAssignment = document.getElementById('<%= ddAssignment.ClientID %>');
                //// this code work when page opened through query strings values
                if (document.getElementById('<%= hfParentClientCode.ClientID %>').value != "") {
                    document.getElementById('<%= txtClientCode.ClientID %>').value = document.getElementById('<%= hfParentClientCode.ClientID %>').value;
                    GetClient('TextBox');
                    document.getElementById('<%= hfParentDate.ClientID %>').value = "";
                }
                LoadingComplete();
                LoadingStart();
                WebMethods.GetAllAssignments(document.getElementById('<%= HidCon.ClientID %>').value, SessionLocationAutoId, document.getElementById('<%= ddClient.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), SessionAreaInchargeNumber, IsAreaIncharge, document.getElementById('<%= ddlArea.ClientID %>').value, OnGetAllAssignments, OnWSRequestFailed, ddAssignment);
            }
            else {
                LoadingComplete();
            }


        }
        function OnGetAllAssignments(result, ddAssignment) {
            ResetPaging();
            var l = 0;
            var res1 = result;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");
            ddAssignment.length = 0;

            document.getElementById('<% =ddlPost.ClientID %>').options.length = 0;

            if (document.getElementById('<%=gvScheduleRoster.ClientID %>') == '[object]') {

                document.getElementById('<%=gvScheduleRoster.ClientID %>').style.display = 'none';
                document.getElementById('<%=HFRowIndex.ClientID %>').value = "";
                document.getElementById('<%=HFColumnIndex.ClientID %>').value = "";
            }
            document.getElementById('<% =txtAsmtCode.ClientID %>').value = "";
            document.getElementById('<%=btnProceed.ClientID %>').disabled = false;

            for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {

                ddAssignment.options[l] = new Option(xmlDoc1.getElementsByTagName("AsmtDetail")[l].firstChild.nodeValue, xmlDoc1.getElementsByTagName("AsmtCode")[l].firstChild.nodeValue);
                if (l == 0) {
                    document.getElementById('<%= txtAsmtCode.ClientID %>').value = xmlDoc1.getElementsByTagName("AsmtCode")[l].firstChild.nodeValue;
                }
                l = l + 1;
            }

            if (ddAssignment.length == 0) {

                document.getElementById('<%= txtAsmtCode.ClientID %>').value = "";
            }
            else {

                //// this code work when page opened through query strings values
                if (document.getElementById('<%= hfParentAsmtCode.ClientID %>').value != "") {
                    document.getElementById('<%= txtAsmtCode.ClientID %>').value = document.getElementById('<%= hfParentAsmtCode.ClientID %>').value;
                    ddAssignment.value = document.getElementById('<%= hfParentAsmtCode.ClientID %>').value;
                    GlobAsmtCode = document.getElementById('<%= txtAsmtCode.ClientID %>').value;
                    globClientCode = document.getElementById('<%= hfParentClientCode.ClientID %>').value;
                    globPostDesc = document.getElementById('<%= HFPost.ClientID %>').value;
                    document.getElementById('<%= hfParentAsmtCode.ClientID %>').value = "";
                    DatesGet('Week');

                    GetAssignment('TextBox');
                    LoadingComplete();
                    return false;

                }


                if (GlobAsmtCode == "") {
                    GlobAsmtCode = '';
                    globClientCode = ''
                    globPostDesc = '';
                    GetPost(document.getElementById('<%= txtAsmtCode.ClientID %>').value);
                    LoadingComplete();
                    return;
                }
            }
            if (GlobAsmtCode != '') {
                document.getElementById('<%= txtAsmtCode.ClientID %>').value = GlobAsmtCode;
                GetAssignment('TextBox');
                LoadingComplete();
                return false;
            }
            LoadingComplete();

        }
        function GetClient(requestType) {
            document.getElementById('<%=HFEmployeeSearch.ClientID %>').value = "";
            if (requestType == "TextBox") {
                document.getElementById('<%= ddClient.ClientID %>').value = document.getElementById('<%= txtClientCode.ClientID %>').value;
                if (document.getElementById('<%= ddClient.ClientID %>').value == "") {
                    document.getElementById('<%=btnProceed.ClientID %>').disabled = true;
                    document.getElementById('<%= ddAssignment.ClientID %>').length = 0;
                    document.getElementById('<%= ddlPost.ClientID %>').length = 0;
                    document.getElementById('<%= txtAsmtCode.ClientID %>').value = '';
                    if (document.getElementById('<%=gvScheduleRoster.ClientID %>') == '[object]') {
                        document.getElementById('<%=gvScheduleRoster.ClientID %>').style.display = 'none';
                    }
                    LoadingComplete();
                    return;
                }
                else {
                    document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
                    if (document.getElementById('<%=gvScheduleRoster.ClientID %>') == '[object]') {
                        document.getElementById('<%=gvScheduleRoster.ClientID %>').style.display = 'block';
                    }
                }
            }
            else {
                document.getElementById('<%= txtClientCode.ClientID %>').value = document.getElementById('<%= ddClient.ClientID %>').value;
            }

            if (document.getElementById('<%= ddClient.ClientID %>').length != 0) {
                var ddAssignment = document.getElementById('<%= ddAssignment.ClientID %>');

                LoadingStart();
                WebMethods.GetAllAssignments(document.getElementById('<%= HidCon.ClientID %>').value, SessionLocationAutoId, document.getElementById('<%= ddClient.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), SessionAreaInchargeNumber, IsAreaIncharge, document.getElementById('<%= ddlArea.ClientID %>').value, OnGetAllAssignments, OnWSRequestFailed, ddAssignment);
            }

        }
        function GetAssignment(requestType) {

            LoadingStart();
            document.getElementById('<%=HFEmployeeSearch.ClientID %>').value = "";
            if (requestType == "TextBox") {
                document.getElementById('<%= ddAssignment.ClientID %>').value = document.getElementById('<%= txtAsmtCode.ClientID %>').value;
                GlobAsmtCode = "";
                if (document.getElementById('<%= ddAssignment.ClientID %>').value == "") {
                    document.getElementById('<%=btnProceed.ClientID %>').disabled = true;
                    if (document.getElementById('<%=gvScheduleRoster.ClientID %>') == '[object]') {
                        document.getElementById('<%=gvScheduleRoster.ClientID %>').style.display = 'none';
                    }
                    LoadingComplete();
                    return;
                }
                else {
                    document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
                    if (document.getElementById('<%=gvScheduleRoster.ClientID %>') == '[object]') {
                        document.getElementById('<%=gvScheduleRoster.ClientID %>').style.display = 'block';
                    }
                }
            }
            else {
                document.getElementById('<%= txtAsmtCode.ClientID %>').value = document.getElementById('<%= ddAssignment.ClientID %>').value;
            }

            if (document.getElementById('gvScheduleRoster') == '[object]') {
                document.getElementById('gvScheduleRoster').style.display = 'none';
                document.getElementById('<%=HFRowIndex.ClientID %>').value = "";
                document.getElementById('<%=HFColumnIndex.ClientID %>').value = "";
            }
            document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            if (document.getElementById('<%=txtAsmtCode.ClientID %>').value == '') {
                document.getElementById('<%=btnProceed.ClientID %>').disabled = true;
                LoadingComplete();
                return false;
            }
            else {
                document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            }

            GetPost(document.getElementById('<%= txtAsmtCode.ClientID %>').value);
            LoadingComplete();

        }

        var dateChangeClientCode = "";
        var dateChangeAsmtCode = "";
        var dateChangePostCode = "";

        function DatesGet(controlType) {

            LoadingStart();
            dateChangeStatus = "1";
            dateChangeClientCode = document.getElementById('<%=ddClient.ClientID %>').value;
            dateChangeAsmtCode = document.getElementById('<%=ddAssignment.ClientID %>').value;
            dateChangePostCode = document.getElementById('<%=ddlPost.ClientID %>').value;


            document.getElementById('<%=HFEmployeeSearch.ClientID %>').value = "";
            if (controlType == "Week" || controlType == "Date") {
                document.getElementById('<%=HFMonthChangeStatus.ClientID %>').value = "1";
            }
            else {
                document.getElementById('<%=HFMonthChangeStatus.ClientID %>').value = "0";
            }
            document.getElementById('<%=btnDatesGet.ClientID %>').click();
            if (document.getElementById('<%=ddlPost.ClientID %>').selectedIndex != -1) {
                document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            }
            else {
                document.getElementById('<%=btnProceed.ClientID %>').disabled = true;
            }

            if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Sch') {
                document.getElementById('<%=ddlScheduleType.ClientID %>').value = "Weekly"
                document.getElementById('<%=ddlScheduleType.ClientID %>').disabled = true;
            }
            else {
                document.getElementById('<%=ddlScheduleType.ClientID %>').disabled = false;
            }

            var oldvalue = document.getElementById('<%=HFFromDate.ClientID %>').value;
            if (!fdatechange(oldvalue)) {
                setTimeout(function () {

                    fdatechange(oldvalue)
                }, 1000);
            }
            document.getElementById('<%=HFPost.ClientID %>').value = dateChangePostCode;
            LoadingComplete();


        }

        function ResetPaging() {
            document.getElementById('<%=hfSelectedGridPageCount.ClientID %>').value = "1";
            document.getElementById('<%=hfSelectedGridPageCountFinal.ClientID %>').value = "1";
        }

        var dateChangeStatus = "";
        function fdatechange(oldvalue) {
            if (oldvalue == document.getElementById('<%=HFFromDate.ClientID %>').value)

                return false;
            else {

                FillClient();
                LoadingComplete();
                //GetAssignment('TextBox');
                return true;
            }
        }

        // This Function is used to enable proceed Button
        function EnableProceed() {
            if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Sch') {
                document.getElementById('<%=ddlScheduleType.ClientID %>').value = "Weekly"
                document.getElementById('<%=ddlScheduleType.ClientID %>').disabled = true;
            }
            else {
                document.getElementById('<%=ddlScheduleType.ClientID %>').disabled = false;
            }


            if (document.getElementById('<%=ddlPost.ClientID %>').selectedIndex != -1) {
                if (document.getElementById('gvScheduleRoster') == '[object]') {
                    document.getElementById('gvScheduleRoster').style.display = 'none';
                }
                document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            }
            else {
                document.getElementById('<%=btnProceed.ClientID %>').disabled = true;

            }
        }
        //***************************************************************************
        // This function is used to show all Shifts of the assignment at the boyyon left corner of the screen
        function ShowAllAsmtShifts() {
            WebMethods.AllShiftsOfAsmt(document.getElementById('<%= HidCon.ClientID %>').value, SessionLocationAutoId, document.getElementById('<%= txtAsmtCode.ClientID %>').value, document.getElementById('<%=ddlWeek.ClientID %>').value, document.getElementById('<% =ddlPost.ClientID %>').value, OnAsmtShiftWSRequestComplete, OnWSRequestFailed);
        }
        // This function is used to show all Shifts of the assignment at the boyyon left corner of the screen
        function OnAsmtShiftWSRequestComplete(result) {
            var res1 = result;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");

            var l = 0;
            var strTable;
            strTable = "<table width='200px' border='0' cellpadding=0 cellspacing=1 style='font-size:11px' > ";
            strTable = strTable + "<tr style='background-color:#B7CEEC' >";
            strTable = strTable + "<td width=50px>" + Shift + "</td>";
            strTable = strTable + "<td width=100px>" + Times + "</td>";
            strTable = strTable + "</tr><tr>";

            for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {
                strTable = strTable + "<tr><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("Shift")[l].firstChild.nodeValue + "</td><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("ShiftTimes")[l].firstChild.nodeValue + "</td><td>";
                l++;
            }
            strTable = strTable + "</table>";
            document.getElementById('span_showAllAsmtShift').innerHTML = strTable;
            ////            GetEmployeeCountClientWiseAndpostWise();
        }
        // This fuction is calls various function When any function key is pressed from scheduling screen
        function ShortCutKeys() {
            var keyId = (window.event) ? event.keyCode : e.keyCode;

            var key;
            var isCtrl;
            if (window.event) {
                key = window.event.keyCode;     //IE
                if (window.event.ctrlKey)
                    isCtrl = true;
                else
                    isCtrl = false;
            }
            else {
                key = e.which;     //firefox
                if (e.ctrlKey)
                    isCtrl = true;
                else
                    isCtrl = false;
            }
            if (isCtrl) {
                if (keyId == 77) {
                    ParentWindowFunction1();
                }
            }
            if (keyId == 45) //INSERT KEY PRESSD
            {

            }
            else if (keyId == 113)// F2 Pressed  Help Window
            {
                OpenHelpWindow();
                // AllSkillMatchMismatch();
            }
            //            else if (keyId == 120)// F9 Pressed  Help Window
            //            {
            //                
            //            }
            else if (keyId == 119)// F8 Pressed  For New Pattern
            {
                if (document.getElementById('<%=txtAsmtCode.ClientID %>') == '[object]') {
                    if (document.getElementById('<%=LBShiftPatterns.ClientID %>').title.toLowerCase() == "ShiftPatternCodeSequence".toLowerCase()) {
                        CreatePatternSeq(document.getElementById('<%=txtAsmtCode.ClientID %>').value);
                    }
                    else {
                        CreatePattern(document.getElementById('<%=txtAsmtCode.ClientID %>').value);
                    }
                }
            }
            else if (keyId == 118)// F7 Pressed Lock Functionality
            {
                if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == "Act") {
                    WebMethods.ConfirmAttendance(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById('<% =txtClientCode.ClientID %>').value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, document.getElementById('<%=ddlPost.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), SessionLocationAutoId, SessionUserId, OnConfirmAttendanceComplete, OnWSRequestFailed);
                }
                else {
                    WebMethods.GetAllLockUnLockStatus(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, SessionLocationAutoId, DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<%=HFToDate.ClientID %>').value), OnGetLockUnLockStatus, OnGetAllPostWSRequestFailed);
                }
            }
            else if (keyId == 121) // F10 Key Pressed
            {
                AllSkillMatchMismatch();
            }
            else if (keyId == 27) // ESC Key Pressed
            {
                //            if(document.getElementById(GlobShiftPatternCode)='[object]') {
                //            GlobShiftPatternCode='';
                //            }
                HideDivs();
            }

        }

        function OnConfirmAttendanceComplete(result) {
            ParentWindowFunction1();
        }

        // This function is called when Lock functionality has finished executing
        function OnGetLockUnLockStatus(result) {


            LoadingStart();
            var res1 = result;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var l = 0;
            if (xmlDoc1.getElementsByTagName("Status")[l].firstChild.nodeValue == '1') {
                if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Sch') {
                    var returnValue = confirm('Are you sure you want to Lock the Schedule');
                    if (returnValue) { LockScheduleEmpWise(); }
                    else {
                        LoadingComplete();
                    }
                }
            }
        }

        // This function is used to show all employee and all the skills defined in sale order which are matching and which are not matching
        function AllSkillMatchMismatch() {
            var postCode = document.getElementById('<%=ddlPost.ClientID %>').value; //document.getElementById('hidPdLineNo' + i).value;

            var pageName = "../Transactions/SkillMatchMismatch.aspx?AsmtCode=" + document.getElementById('<% =txtAsmtCode.ClientID %>').value + "&PostCode=" + postCode + "&FromDate=" + DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value) + "&ToDate=" + DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value) + "&AreaID=" + document.getElementById('<%=ddlArea.ClientID %>').value;
            var winW = 1600;
            var winH = 600;
            var winX = (screen.availWidth - winW) / 2;
            var winY = (screen.availHeight - winH) / 2;
            var features = 'left=' + winX + ',top=' + winY + ',height=' + winH + ',' + 'width=' + winW + ',status=yes,' + 'toolbar=no,menubar=no,location=no';
            window.open(pageName, 'Search', features);
        }
        // This function opens    CreateShiftPattern Screen
        function OpenShiftOfAssignment() {
            var pageName = "../Transactions/CreateShiftPattern.aspx?AsmtCode=" + document.getElementById('<%=txtAsmtCode.ClientID %>').value + "&Status=" + "ShiftDetails";
            var winW = 950;
            var winH = 500;
            var winX = (screen.availWidth - winW) / 2;
            var winY = (screen.availHeight - winH) / 2;
            var features = 'left=' + winX + ',top=' + winY + ',height=' + winH + ',' + 'width=' + winW + ',status=yes,' + 'toolbar=no,menubar=no,location=no';
            window.open(pageName, 'Search', features);
        }
        // This function opens    Help Window  Screen
        function OpenHelpWindow() {
            var pageName = "../Transactions/SchEmpWiseHelp.aspx";
            var winW = 500;
            var winH = 500;
            var winX = (screen.availWidth - winW) / 2;
            var winY = (screen.availHeight - winH) / 2;
            var features = 'left=' + winX + ',top=' + winY + ',height=' + winH + ',' + 'width=' + winW + ',status=yes,' + 'toolbar=no,menubar=no,location=no';
            window.open(pageName, 'Search', features);
        }

        var GlobAsmtCode = "";
        function LoadScheduleDetailsOnClientClick(strObject) {
            try {
                // 
                if (strObject != 'Back') {
                    if (document.getElementById(strObject).innerText.indexOf(':') > 0 || document.getElementById(strObject).innerText == "" || document.getElementById(strObject).innerText.toLowerCase().trim() == "WO".toLowerCase().trim() || document.getElementById(strObject).innerText.toLowerCase().trim() == "AL".toLowerCase().trim() || document.getElementById(strObject).innerText.toLowerCase().trim() == "CL".toLowerCase().trim() || document.getElementById(strObject).innerText.toLowerCase().trim() == "EL".toLowerCase().trim() || document.getElementById(strObject).innerText.toLowerCase().trim() == "FL".toLowerCase().trim() || document.getElementById(strObject).innerText.toLowerCase().trim() == "MAL".toLowerCase().trim() || document.getElementById(strObject).innerText.toLowerCase().trim() == "PA".toLowerCase().trim() || document.getElementById(strObject).innerText.toLowerCase().trim() == "PL".toLowerCase().trim() || document.getElementById(strObject).innerText.toLowerCase().trim() == "SL".toLowerCase().trim() || document.getElementById(strObject).innerText.toLowerCase().trim() == "UL".toLowerCase().trim()) {
                        LoadingComplete();
                        return false;
                    }
                }
                if (strObject == 'Back') {
                    cellOtherAssignmentAutoId = document.getElementById('<%=lblOldAsmtCode.ClientID %>').innerText;
                }
                else {
                    var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
                    var rowClientId = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
                    var columnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
                    var OtherAssignmentAutoId = "lblOtherAssignmentAutoId" + columnIndex;
                    var cellOtherAssignmentAutoId = document.getElementById(getClientId(rowClientId, OtherAssignmentAutoId)).innerText;

                    document.getElementById('<%=lblOldAsmtCode.ClientID %>').innerText = cellOtherAssignmentAutoId;
                }

                var arr = new Array;
                arr = cellOtherAssignmentAutoId.split(",");
                if (arr[1] == "0") {
                    LoadingComplete();
                    return false;
                }
                if (cellOtherAssignmentAutoId != "") {
                    WebMethods.GetAssignmentClientAndPostBasedOnAsmtAutoId(document.getElementById('<%= HidCon.ClientID %>').value, cellOtherAssignmentAutoId, document.getElementById('<%= txtAsmtCode.ClientID %>').value, document.getElementById('<%= ddlPost.ClientID %>').value, OnGetAssignmentClientAndPostBasedOnAsmtAutoIdComplete, OnWSRequestFailed);
                }
            }
            catch (Error) { return; }

        }

        var globClientCode;
        var globPostDesc = "";

        function OnGetAssignmentClientAndPostBasedOnAsmtAutoIdComplete(result) {

            var res = result;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");
            GlobAsmtCode = xmlDoc1.getElementsByTagName("AsmtCode")[0].firstChild.nodeValue;
            globClientCode = xmlDoc1.getElementsByTagName("ClientCode")[0].firstChild.nodeValue;
            globPostDesc = xmlDoc1.getElementsByTagName("PDLineNo")[0].firstChild.nodeValue;
            document.getElementById('<%=txtClientCode.ClientID %>').value = globClientCode;
            document.getElementById('<%=ddClient.ClientID %>').value = globClientCode;
            document.getElementById('<%=txtAsmtCode.ClientID %>').value = GlobAsmtCode;
            document.getElementById('<%=lblOldAsmtCode.ClientID %>').innerText = xmlDoc1.getElementsByTagName("CurrentAssignmentMasterAutoID")[0].firstChild.nodeValue;
            GetClient("TextBox");


        }
        // This function is called when user right click and cclick on various duty type 
        function ChangeDutyType(strDutyType) {

            /// ********* Copy selected text to clipbord **********
            CopiedTxt = document.selection.createRange();
            CopiedTxt.execCommand("Copy");
            var strSchIds = window.clipboardData.getData('Text');

            var strEmployee = "txtEmpNumberDutyDate";
            var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
            var rowClientId = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var cellEmployeeNumber = document.getElementById(getClientId(rowClientId, strEmployee)).value;
            var strAutoIds = "";
            var columnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var schRosterAutoId = "HFSchRosterAutoID" + columnIndex;
            var cellScheduleRosterAutoId = document.getElementById(getClientId(rowClientId, schRosterAutoId)).value;
            strAutoIds = strAutoIds + "," + cellScheduleRosterAutoId;

            if (cellEmployeeNumber == "")
            { alert(InvalidEmpCode); return; }

            if (document.getElementById('HFOTReason').value == '1' && strDutyType == "DT0009") {
                // Added By   on 07-Nov-2012
                OTReason(strDutyType);
            }
            else {
                WebMethods.ChangeDutyType(document.getElementById('<%= HidCon.ClientID %>').value, strAutoIds, strDutyType, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, SessionUserId, OnDutyTypeChanged, OnWSRequestFailed);
            }

        }
        // this function is caaled if      ChangeDutyType function has been exceuted succesfully
        function OnDutyTypeChanged() {
            ParentWindowFunction1();
        }
        // This function is used to mark Week OFF when used right click on grid view and click Mark Week Off Option
        function MarkWeekOff() {
            var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
            var rowClientId = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var strRowNumber = "lblRowID";
            var strEmployee = "txtEmpNumberDutyDate";
            var strShiftPatternCode = "txtShiftPatternCode";
            var strPatternPosition = "txtPatternPosition";
            var cellShiftPatternCode = document.getElementById(getClientId(rowClientId, strShiftPatternCode)).value;
            var cellPatternPosition = document.getElementById(getClientId(rowClientId, strPatternPosition)).value;
            var cellEmployeeNumber = document.getElementById(getClientId(rowClientId, strEmployee)).value;
            var cellRowNumber = document.getElementById(getClientId(rowClientId, strRowNumber)).innerText;
            var cellDefaultSite;
            var columnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var strDutyDate = "lblHeaderDutyDate" + columnIndex;
            var dutyDate = 'gvScheduleRoster_ctl01_' + strDutyDate;
            document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;

            var strScheduleRosterAutoID = "HFSchRosterAutoID" + columnIndex;
            GlobEmployeeSchRosterAutoID = getClientId(rowClientId, strScheduleRosterAutoID);
            var cellRosterAutoID = document.getElementById(GlobEmployeeSchRosterAutoID).value;
            var cellDesignationCode = document.getElementById(getClientId(rowClientId, "HFDesignationCode")).value;
            if (cellRosterAutoID == "") {
                cellRosterAutoID = "0";
            }
            var strSoRank = 'A-Site1-SGS';
            var varDutyDate = document.getElementById(dutyDate).innerText;
            if (cellShiftPatternCode == "")
            { cellDefaultSite = "0"; }
            else
            { cellDefaultSite = "1"; }

            if (cellEmployeeNumber == "")
            { alert(InvalidEmpCode); return; }
            var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
            //            WebMethods.ApplyWeekOff(document.getElementById('<%= HidCon.ClientID %>').value, SessionLocationAutoId, cellEmployeeNumber, DateInFormat(varDutyDate), "1",
            //            SessionUserId, document.getElementById('<%= txtAsmtCode.ClientID %>').value, cellShiftPatternCode, cellPatternPosition, cellDefaultSite, strSoRank, 
            //            cellRowNumber, strPost, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, OnAppliedWO, OnWSRequestFailed);

            WebMethods.InsertDataOfDate(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById('<%=txtAsmtCode.ClientID %>').value, cellEmployeeNumber,
            DateInFormat(varDutyDate), "0", document.getElementById('<%=ddlWeek.ClientID %>').value, "Role",
            cellDesignationCode, cellShiftPatternCode, cellPatternPosition,
             cellDefaultSite, "0", strSoRank, "00:00", "00:00", "", "", cellRosterAutoID,
             "1", cellRowNumber, strPost, document.getElementById('<%=ddlAttendanceType.ClientID %>').value,
             DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value),
             DateInFormat(document.getElementById('<%=HFMaxDate.ClientID %>').value), document.getElementById('<%=HFCurrentSessionID.ClientID %>').value,
             SessionLocationAutoId, SessionUserId, OnInsertDataOfDateComplete, OnWSRequestFailed);


        }
        // This function is used to copy schedule to next week 
        function CopyToNextWeek() {

            /// ********* Copy selected text to clipbord **********
            if (window.getSelection) {
                CopiedTxt = window.getSelection();
            }
            else if (document.selection.type == 'None') {
                alert('Browser does not support this functionality!');
                return;
            }
            else {
                CopiedTxt = document.selection.createRange();
            }

            CopiedTxt.execCommand("Copy");
            var strDates = window.clipboardData.getData('Text');

            if (strDates.indexOf("$") < 0)  // for copy assignment
            {

                var arr2 = new Array;
                strDates = strDates.trim();
                arr2 = strDates.split("  ");
                for (var i = 0; i < arr2.length; i++) {
                    if (i == 0)
                    { strFromDate = arr2[i]; strToDate = arr2[i]; }
                    else
                    { strToDate = arr2[i]; }
                }
                strFromDate = strFromDate.substring(0, 11);
                strToDate = strToDate.substring(0, 11);

                WebMethods.AsmtScheduleCopy(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById('<%= ddlWeek.ClientID %>').value, document.getElementById('<%= txtAsmtCode.ClientID %>').value, strFromDate, strToDate, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, SessionUserId, document.getElementById('<%=ddlPost.ClientID %>').value, OnWSRequestComplete, OnWSRequestFailed);
            }
            else {

                var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
                var rowClientId = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
                var strEmployee = "txtEmpNumberDutyDate";
                var strShiftPatternCode = "txtShiftPatternCode";
                var strPatternPosition = "txtPatternPosition";
                var strRowNumber = "lblRowID";
                var cellShiftPatternCode = document.getElementById(getClientId(rowClientId, strShiftPatternCode)).value;
                var cellPatternPosition = document.getElementById(getClientId(rowClientId, strPatternPosition)).value;
                var cellEmployeeNumber = document.getElementById(getClientId(rowClientId, strEmployee)).value;
                var cellRowNumber = document.getElementById(getClientId(rowClientId, strRowNumber)).innerText;
                var cellDefaultSite;

                var strAutoIds = "";
                var strFromDate = "";
                var strToDate = "";

                arr = strDates.split("$");
                for (var i = 1; i < arr.length; i = i + 2) {
                    var arr1 = new Array;
                    arr1 = arr[i].split("#");
                    if (i == 1)
                    { strFromDate = arr1[1]; strToDate = arr1[1]; strAutoIds = arr1[0]; }
                    else
                    { strToDate = arr1[1]; strAutoIds = strAutoIds + "," + arr1[0]; }
                }

                if (strFromDate == "")
                { alert(Dataisnotcopiedproperly); return; }

                if (cellShiftPatternCode == "")
                { cellDefaultSite = "0"; }
                else
                { cellDefaultSite = "1"; }

                if (cellEmployeeNumber == "")
                { alert(InvalidEmpCode); return; }

                WebMethods.ScheduleCopy(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById('<%= ddlWeek.ClientID %>').value, cellEmployeeNumber, strAutoIds, strFromDate, strToDate, cellShiftPatternCode, cellPatternPosition, cellDefaultSite, cellRowNumber, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, SessionUserId, OnWSRequestComplete, OnWSRequestFailed);
            }

        }
        // this function is used to copy schedule on a range
        function CopyRange() {

            /// Copy selected text to clipbord
            if (window.getSelection) {
                CopiedTxt = window.getSelection();
            }
            else if (document.selection.type == 'None') {
                alert('Browser does not support this functionality!');
                return;
            }
            else {
                CopiedTxt = document.selection.createRange();
            }

            CopiedTxt.execCommand("Copy");
            GlobStrCopyRange = window.clipboardData.getData('Text');

        }
        // this function is used to paste schedule on a range
        function PasteRange() {

            /// ********* Copy selected text to clipbord **********
            if (window.getSelection) {
                CopiedTxt = window.getSelection();
            }
            else if (document.selection.type == 'None') {
                alert('Browser does not support this functionality!');
                return;
            }
            else {
                CopiedTxt = document.selection.createRange();
            }

            CopiedTxt.execCommand("Copy");
            var strDates = window.clipboardData.getData('Text');

            var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
            var rowClientId = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var strEmployee = "txtEmpNumberDutyDate";
            var strShiftPatternCode = "txtShiftPatternCode";
            var strPatternPosition = "txtPatternPosition";
            var strRowNumber = "lblRowID";
            var cellShiftPatternCode = document.getElementById(getClientId(rowClientId, strShiftPatternCode)).value;
            var cellPatternPosition = document.getElementById(getClientId(rowClientId, strPatternPosition)).value;
            var cellEmployeeNumber = document.getElementById(getClientId(rowClientId, strEmployee)).value;
            var cellRowNumber = document.getElementById(getClientId(rowClientId, strRowNumber)).innerText;
            var cellDefaultSite;
            var strAutoIds = "";
            var strFromDate = "";
            var strToDate = "";

            var arr = new Array;

            //alert(GlobStrCopyRange);
            arr = GlobStrCopyRange.split("$");

            for (var i = 1; i < arr.length; i = i + 2) {
                var arr1 = new Array;
                arr1 = arr[i].split("#");
                if (strAutoIds != "")
                    strAutoIds = strAutoIds + "," + arr1[0];
                else
                    strAutoIds = arr1[0];
            }

            if (strAutoIds == "")
            { alert(Dataisnotcopiedproperly); return; }

            arr = strDates.split("$");

            for (var i = 1; i < arr.length; i = i + 2) {
                var arr1 = new Array;
                arr1 = arr[i].split("#");
                if (i == 1)
                { strFromDate = arr1[1]; strToDate = arr1[1]; }
                else
                    strToDate = arr1[1];
            }

            if (strFromDate == "")
            { alert(Dataisnotcopiedproperly); return; }

            if (cellShiftPatternCode == "")
            { cellDefaultSite = "0"; }
            else
            { cellDefaultSite = "1"; }

            if (cellEmployeeNumber == "")
            { alert(InvalidEmpCode); return; }

            WebMethods.ScheduleCopy(document.getElementById('<%= HidCon.ClientID %>').value, "0", cellEmployeeNumber, strAutoIds, DateInFormat(strFromDate), DateInFormat(strToDate), cellShiftPatternCode, cellPatternPosition, cellDefaultSite, cellRowNumber, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, SessionUserId, OnWSRequestComplete, OnWSRequestFailed);

        }
        function ClientAndAsmtWiseTotalHours() {
            GetEmployeeCountClientWiseAndpostWise();

        }

        function SaleOrderConstraint() {
            WebMethods.ShowSaleOrderDeployment(document.getElementById('<%= HidCon.ClientID %>').value, SessionLocationAutoId, document.getElementById('<%=txtAsmtCode.ClientID %>').value, document.getElementById('<%=ddlPost.ClientID %>').value, OnSaleOrderConstraintRequestComplete, OnWSRequestFailed);
        }

        function OnSaleOrderConstraintRequestComplete(result) {
            var res1 = result;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");
            var l = 0;
            for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {
                window.showModalDialog('../Sales/SOLineSkillSet.aspx?LocationAutoID=' + xmlDoc1.getElementsByTagName("AsmtLocationAutoID")[l].firstChild.nodeValue + '&SoNo=' + xmlDoc1.getElementsByTagName("SoNo")[l].firstChild.nodeValue + '&SOAmendNO=' + xmlDoc1.getElementsByTagName("SoAmendNo")[l].firstChild.nodeValue + '&SOLineNo=' + xmlDoc1.getElementsByTagName("SoLineNo")[l].firstChild.nodeValue + '&SOStatus=' + "AUTHORIZED" + '&IsMAXSOAmendNo=' + "MAX" + '&Checked=' + xmlDoc1.getElementsByTagName("Active")[l].firstChild.nodeValue, null, 'status:off;center:yes;scroll:no;dialogWidth:1200px;dialogheight:600px;help:no;');
            }
        }
        function SaleOrderDeployment() {

            WebMethods.ShowSaleOrderDeployment(document.getElementById('<%= HidCon.ClientID %>').value, SessionLocationAutoId, document.getElementById('<%=txtAsmtCode.ClientID %>').value, document.getElementById('<%=ddlPost.ClientID %>').value, OnSaleOrderDeploymentRequestComplete, OnWSRequestFailed);

        }

        function OnSaleOrderDeploymentRequestComplete(result) {
            var res1 = result;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");
            var l = 0;
            for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {
                window.showModalDialog('../Sales/SOLineDeptShifts.aspx?LocationAutoID=' + SessionLocationAutoId + '&SoNo=' + xmlDoc1.getElementsByTagName("SoNo")[l].firstChild.nodeValue + '&SOAmendNO=' + xmlDoc1.getElementsByTagName("SoAmendNo")[l].firstChild.nodeValue + '&SOLineNo=' + xmlDoc1.getElementsByTagName("SoLineNo")[l].firstChild.nodeValue + '&SOStatus=' + "AUTHORIZED" + '&IsMAXSOAmendNo=' + "MAX" + '&Hours=' + xmlDoc1.getElementsByTagName("DeploymentPattern")[l].firstChild.nodeValue + '&NoOfPost=' + xmlDoc1.getElementsByTagName("NoOfPost")[l].firstChild.nodeValue + '&ChargeRatePerHrs=' + xmlDoc1.getElementsByTagName("ChargeRatePerHour")[l].firstChild.nodeValue + '&PayRatePerHrs=' + xmlDoc1.getElementsByTagName("MinWages")[l].firstChild.nodeValue + '&OtherAllowances=' + xmlDoc1.getElementsByTagName("OtherAllowances")[l].firstChild.nodeValue + '&IsAllowanceBillable=' + xmlDoc1.getElementsByTagName("IsAllowanceBillable")[l].firstChild.nodeValue + '&RemainingDays=' + xmlDoc1.getElementsByTagName("RemainingDays")[l].firstChild.nodeValue + '&BillingPattern=' + xmlDoc1.getElementsByTagName("SoType")[l].firstChild.nodeValue + '&Checked=' + xmlDoc1.getElementsByTagName("Active")[l].firstChild.nodeValue + '&IsBillable=' + xmlDoc1.getElementsByTagName("Billable")[l].firstChild.nodeValue, null, 'status:off;center:yes;scroll:no;dialogWidth:1250px;dialogheight:500px;help:no;');
            }

        }
        //
        function GetEmployeeCountClientWiseAndpostWise() {
            if (document.getElementById('<% =txtAsmtCode.ClientID %>').value != "" && document.getElementById('<%=ddlPost.ClientID %>').value != "") {
                var strPageName = "../Transactions/EmployeeCountClientAndPostWise.aspx?ConnectionString=" + document.getElementById('<%= HidCon.ClientID %>').value +
                "&CompanyCode=" + SessionCompanyCode +
                "&HrLocationCode=" + SessionHrLocationCode +
                "&LocationCode=" + SessionLocationCode +
                "&AttendanceType=" + document.getElementById('<%=ddlAttendanceType.ClientID %>').value +
                "&Post=" + document.getElementById('<%=ddlPost.ClientID %>').value +
                "&FromDate=" + DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value) +
                "&ToDate=" + DateInFormat(document.getElementById('<%=HFToDate.ClientID %>').value) +
                "&AsmtCode=" + document.getElementById('<%=txtAsmtCode.ClientID %>').value;
                var FrmChild = window.showModalDialog(strPageName, null, 'status:off;center:yes;scroll:no;dialogWidth:1240px;dialogHeight:350px;');
            }
        }
        //Show Employee Count Client Wise and Post Wise
        function OnGetEmployeeCountClientWiseAndpostWiseComplete(result) {
            document.getElementById('spanShowEmployeeCountClientAndPostWise').innerHTML = '';
            var res1 = result;
            var xmlDocDate = new ActiveXObject("Microsoft.XMLDOM");
            xmlDocDate.async = "false";
            xmlDocDate.loadXML(res1);
            var nodesDate = xmlDocDate.selectSingleNode("NewDataSet");
            var asmtcDate = nodesDate.selectNodes("Table");

            var xmlDocCount = new ActiveXObject("Microsoft.XMLDOM");
            xmlDocCount.async = "false";
            xmlDocCount.loadXML(res1);
            var nodesCount = xmlDocCount.selectSingleNode("NewDataSet");
            var asmtcCount = nodesCount.selectNodes("Table");
            // 
            var l = 0;
            var strTable;
            strTable = "<table border='1' cellpadding=0 cellspacing=0 style='font-size:11px; border-color:grey' > ";
            strTable = strTable + "<tr style='background-color:#B7CEEC' >";
            for (var myasmt = asmtcDate.nextNode(); myasmt; myasmt = asmtcDate.nextNode()) {
                if (l == '0') {
                    strTable = strTable + "<td>" + DateRange + "</td><td align='center'>";
                }
                else {
                    strTable = strTable + "<td align='center'>";
                }
                strTable = strTable + xmlDocDate.getElementsByTagName("DutyDate")[l].firstChild.nodeValue + "</td>";
                l++;
            }

            l = 0;
            strTable = strTable + "<tr>";
            for (var myasmt = asmtcCount.nextNode(); myasmt; myasmt = asmtcCount.nextNode()) {
                if (l == '0') {
                    strTable = strTable + "<td>" + Total + "</td><td align='center' style='font-weight'>";
                }
                else {
                    strTable = strTable + "<td align='center' style='font-weight'>";
                }
                strTable = strTable + xmlDocCount.getElementsByTagName("ClientPostTotal")[l].firstChild.nodeValue + "</td>";
                l++;
            }
            strTable = strTable + "</tr>";
            strTable = strTable + "</table>";
            document.getElementById('spanShowEmployeeCountClientAndPostWise').innerHTML = strTable;
        }
        // this function is called when Mark week off function is exceuted successfully
        function OnAppliedWO() {

            ParentWindowFunction1();
        }
        // this function is called when copy function is executed successfully
        function OnWSRequestComplete(result) {
            var res1 = result;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");

            var l = 0;
            var strTable;
            strTable = FollowingRecordscannotbecopied + "\n";

            var arr = new Array;
            var TMin = 0;
            for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {
                strTable = strTable + xmlDoc1.getElementsByTagName("EmployeeNumber")[l].firstChild.nodeValue + "\t";
                strTable = strTable + xmlDoc1.getElementsByTagName("DutyDate")[l].firstChild.nodeValue + "\t";
                strTable = strTable + xmlDoc1.getElementsByTagName("MessageString")[l].firstChild.nodeValue + "\n";

                l++;
            }

            if (l > 0) {
                alert(strTable);
            }
            else {
                alert(SuccessfullyCopied);
            }

            ParentWindowFunction1();
        }

        function OnWSRequestFailed(error) {
            LoadingComplete();
            ParentWindowFunction1();
            alert(error.get_message());
        }

        //******************************************************************************************
        // This function is called from other pop up windows like Leave jobBreak down etc to refresh the parent grid 
        function ParentWindowFunction1() {
            document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
            if (document.getElementById('<%=ddlPost.ClientID %>').selectedIndex != -1) {
                document.getElementById('<%=HFPostText.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').options[document.getElementById('<%=ddlPost.ClientID %>').selectedIndex].text;
            }
            if (document.getElementById('<%=HFPost.ClientID %>').value == '') {
                document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
            }
            document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            document.getElementById('<%=btnProceed.ClientID %>').click();

            if (document.getElementById('DivJobBreakUp') == "[object]") {

                document.getElementById('DivJobBreakUp').style.display = "none";
            }
            if (document.getElementById(GlobObjTofade) == '[object]') {
                var obj = document.getElementById(GlobObjTofade);
                if (obj.style.display == 'block') {
                    fade(GlobObjTofade, GlobObjfadeDisplay, GlobObjfadeImageObject, GlobObjfadeColumnIndex);
                }
            }
            LoadingComplete();
            return false;
        }
        // this function is called when user clicks on the row of the gridview to get the RowID of the gridview
        function GetRowIDOnMouseClick(strRowId) {
            document.getElementById('<%=MouseClickRowID.ClientID %>').value = "";
            document.getElementById('<%=MouseClickRowID.ClientID %>').value = strRowId;


        }
        // this function is called when user clicks on the column of the gridview to get the COLUMNID of the gridview
        function GetColumnIndexOnMouseClick(strColumnIndex) {
            document.getElementById('<%=MouseClickColumnID.ClientID %>').value = "";
            document.getElementById('<%=MouseClickColumnID.ClientID %>').value = strColumnIndex;
        }
        // This function is used to Open Create pattern sequence window
        function CreatePatternSeq(strAsmtCode) {
            var pageName = "../Transactions/CreateShiftPatternSeq.aspx?AsmtCode=" + strAsmtCode + "&Status=" + "CreatePattern"; ;
            var winW = 850;
            var winH = 670;
            var winX = (screen.availWidth - winW) / 2;
            var winY = (screen.availHeight - winH) / 2;
            var features = 'left=' + winX + ',top=' + winY + ',height=' + winH + ',' + 'width=' + winW + ',status=yes,' + 'toolbar=no,menubar=no,location=no';
            window.open(pageName, 'Search', features);
        }
        // Gets the job break down summary on each cell of the gridview
        function JobBreakDownSummaryDetail() {
            //used when user click job break down button in the POP
            var columnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var schRosterAutoId = "HFSchRosterAutoID" + columnIndex;
            var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
            var rowClientId = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];

            var converted = "HFIsConverted" + columnIndex;
            var cellConverted = document.getElementById(getClientId(rowClientId, converted)).value;

            if (document.getElementById('HFJobBreakDownSchRosterAutoID').value != '') {
                var strPageName = "../Transactions/JobBreakDownSummary.aspx?ScheduleRosterAutoID=" + document.getElementById('HFJobBreakDownSchRosterAutoID').value + "&AttendanceType=" + document.getElementById('<%=ddlAttendanceType.ClientID %>').value + "&AreaID=" + document.getElementById('<%=ddlArea.ClientID %>').value + "&FromDate=" + DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value) + "&ToDate=" + DateInFormat(document.getElementById('<%=HFToDate.ClientID %>').value) + "&Converted=" + cellConverted;
                var FrmChild = window.showModalDialog(strPageName, null, 'status:off;center:yes;scroll:no;dialogWidth:1000px;dialogHeight:550px;');
                if (FrmChild == "1") {
                    ParentWindowFunction1()
                }
            }
        }

        // This function is used to open JobBreakDownSummary Window
        function JobBreakDownSummary() {
            var columnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var schRosterAutoId = "HFSchRosterAutoID" + columnIndex;
            var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
            var rowClientId = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var cellScheduleRosterAutoId = document.getElementById(getClientId(rowClientId, schRosterAutoId)).value;
            var converted = "HFIsConverted" + columnIndex;
            var cellConverted = document.getElementById(getClientId(rowClientId, converted)).value;

            if (cellScheduleRosterAutoId != '0' && cellScheduleRosterAutoId != '') {
                var strPageName = "../Transactions/JobBreakDownSummary.aspx?ScheduleRosterAutoID=" + cellScheduleRosterAutoId + "&AttendanceType=" + document.getElementById('<%=ddlAttendanceType.ClientID %>').value + "&AreaID=" + document.getElementById('<%=ddlArea.ClientID %>').value + "&FromDate=" + DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value) + "&ToDate=" + DateInFormat(document.getElementById('<%=HFToDate.ClientID %>').value) + "&Converted=" + cellConverted;
                var FrmChild = window.showModalDialog(strPageName, null, 'status:off;center:yes;scroll:no;dialogWidth:1000px;dialogHeight:550px;');
                if (FrmChild == "1") {
                    ParentWindowFunction1()
                }
            }
        }
        // This function is used to apply week off when use right click on gridview and click on apply week off
        function ApplyWeekOFF() {
            var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
            var rowClientId = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var strEmployee = "txtEmpNumberDutyDate";
            var strShiftPatternCode = "txtShiftPatternCode";
            var strPatternPosition = "txtPatternPosition";
            var strDefaultSite = "CBIsDefaultSite";
            var cellShiftPatternCode = getClientId(rowClientId, strShiftPatternCode);
            var cellPatternPosition = getClientId(rowClientId, strPatternPosition);
            var cellEmployeeNumber = getClientId(rowClientId, strEmployee);
            var cellDefaultSite = getClientId(rowClientId, strDefaultSite);

            var varAsmtCode = document.getElementById('<%=txtAsmtCode.ClientID %>').value;
            var strSoRank = 'Guard';
            if (document.getElementById(cellEmployeeNumber).value != "") {

                var pageName = "SchEmpWiseDefineWeekOff_AnEmp.aspx?EmployeeNumber=" + document.getElementById(cellEmployeeNumber).value + "&FromDate=" + DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value) + "&ToDate=" + DateInFormat(document.getElementById('<%=HFToDate.ClientID %>').value) + "&AsmtCode=" + varAsmtCode + "&ShiftPatternCode=" + document.getElementById(cellShiftPatternCode).value + "&PatternPosition=" + document.getElementById(cellPatternPosition).value + "&DefaultSite=" + document.getElementById(cellDefaultSite).checked + "&SoRank=" + strSoRank;
                var winW = 950;
                var winH = 500;
                var winX = (screen.availWidth - winW) / 2;
                var winY = (screen.availHeight - winH) / 2;
                var features = 'left=' + winX + ',top=' + winY + ',height=' + winH + ',' + 'width=' + winW + ',status=yes,' + 'toolbar=no,menubar=no,location=no';
                window.open(pageName, 'Search', features);
            }
        }
        // This function is used to open leave window
        function ApplyLeave() {

            var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
            var rowClientId = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var strEmployee = "txtEmpNumberDutyDate";
            var strShiftPatternCode = "txtShiftPatternCode";
            var strPatternPosition = "txtPatternPosition";
            var strDefaultSite = "CBIsDefaultSite";
            var cellEmployeeNumber = getClientId(rowClientId, strEmployee);
            var cellShiftPatternCode = getClientId(rowClientId, strShiftPatternCode);
            var cellPatternPosition = getClientId(rowClientId, strPatternPosition);
            var cellDefaultSite = getClientId(rowClientId, strDefaultSite);
            var columnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var strDutyDate = "lblHeaderDutyDate" + columnIndex;
            var dutyDate = 'gvScheduleRoster_ctl01_' + strDutyDate;
            var strRowNumber = "lblRowID";
            var cellRowNumber = document.getElementById(getClientId(rowClientId, strRowNumber)).innerText;

            if (document.getElementById(dutyDate).innerText != "" && document.getElementById(cellEmployeeNumber).value != "") {
                var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;

                var strPageName = "../HRManagement/LeaveApplicationAndPosting.aspx?EmployeeNumber=" + document.getElementById(cellEmployeeNumber).value + "&DutyDate=" + DateInFormat(document.getElementById(dutyDate).innerText) + "&AsmtCode=" + document.getElementById('<%=txtAsmtCode.ClientID %>').value + "&ShiftPatternCode=" + document.getElementById(cellShiftPatternCode).value + "&PatternCode=" + document.getElementById(cellPatternPosition).value + "&DefaultSite=" + document.getElementById(cellDefaultSite).value + "&RowNumber=" + cellRowNumber + "&AttendanceType=" + document.getElementById('<%=ddlAttendanceType.ClientID %>').value + "&Post=" + strPost;
                var FrmChild = window.showModalDialog(strPageName, null, 'status:off;center:yes;scroll:no;dialogWidth:1000px;dialogHeight:550px;');
                if (FrmChild == "1") {
                    ParentWindowFunction1()
                }
            }
        }

        // This function is called when user click on the ? symbol on the gridview which shows the Employee skill search.
        function SearchEmployeeSkillWise(strEmployee) {
            var elPd = document.getElementById('<%=ddlPost.ClientID %>').value; //document.getElementById('hidPdLineNo' + i).value;
            var elEmp = strEmployee;
            var clientCode = document.getElementById('<%=txtClientCode.ClientID %>').value;
            var clientName = document.getElementById('<%=ddClient.ClientID %>').options[document.getElementById('<%=ddClient.ClientID %>').selectedIndex].text;
            var asmtCode = document.getElementById('<%=txtAsmtCode.ClientID %>').value;
            var asmtName = document.getElementById('<%=ddAssignment.ClientID %>').options[document.getElementById('<%=ddAssignment.ClientID %>').selectedIndex].text;
            var postName = document.getElementById('<%=ddlPost.ClientID %>').options[document.getElementById('<%=ddlPost.ClientID %>').selectedIndex].text;

            //Area ID Added to search on selected Area
            var pageName = "../search/EmployeeWiseAdvanceSearch.aspx?AsmtMasterAutoID=" + document.getElementById('<% =AsmtId.ClientID %>').value + "&PostCode=" + elPd + "&SoRank=&FromDate=" + DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value) + "&ToDate=" + DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value) + "&ControlId=" + elEmp + "&AttendanceType=" + document.getElementById('<%=ddlAttendanceType.ClientID %>').value + "&AreaID=" + document.getElementById('<%=ddlArea.ClientID %>').value + "&ClientCode=" + clientCode + "&ClientName=" + encodeURIComponent(clientName) + "&AsmtCode=" + asmtCode + "&AsmtName=" + encodeURIComponent(asmtName) + "&PostName=" + encodeURIComponent(postName);
            var winW = 1300;
            var winH = 600;
            var winX = (screen.availWidth - winW) / 2;
            var winY = (screen.availHeight - winH) / 2;
            var features = 'left=' + winX + ',top=' + winY + ',height=' + winH + ',' + 'width=' + winW + ',status=yes,' + 'toolbar=no,menubar=no,location=no';
            window.open(pageName, 'Search', features);

        }
        // This function Hids all DIVS 
        function HideDivs() {
            if (document.getElementById('divShift') == "[object]") {
                if (document.getElementById('divShift').style.display != "none") {
                    document.getElementById('divShift').style.display = "none";
                }
            }

            if (document.getElementById('divEmployeeContainer') == "[object]") {
                if (document.getElementById('divEmployeeContainer').style.display != "none") {
                    document.getElementById('divEmployeeContainer').style.display = "none";
                }
            }
            if (document.getElementById('DivShiftPatterns') == "[object]") {
                if (document.getElementById('DivShiftPatterns').style.display != "none") {
                    document.getElementById('DivShiftPatterns').style.display = "none";
                }
            }
            if (document.getElementById('DIVPostSearch') == "[object]") {
                if (document.getElementById('DIVPostSearch').style.display != "none") {
                    document.getElementById('DIVPostSearch').style.display = "none";
                }
            }
        }
        // This function gets the requirement and schedule of the selected client assignment and post
        function GetReqSch() {
            document.getElementById('divManPowerReq').innerHTML = "";
            WebMethods.GetSchAndReqManpower(document.getElementById('<%= HidCon.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), document.getElementById('<% =txtAsmtCode.ClientID %>').value, SessionLocationAutoId, document.getElementById('<%= ddlPost.ClientID %>').value, document.getElementById('<% =ddlScheduleType.ClientID %>').value, document.getElementById('<% =ddlWeek.ClientID %>').value, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, OnGetSchAndReqManpowerComplete, OnWSRequestFailed);
        }

        function OnGetSchAndReqManpowerComplete(result) {
            document.getElementById('divManPowerReq').innerHTML = result;
            ShowAllAsmtShifts();
            return true;

        }
        // This function is executed wen    GetReqSch function has exected successfully
        function FillReqSch(strOutput) {
            // Commented on Oct 29 2012

            //            document.getElementById('divManPowerReq').innerHTML = strOutput;
            //            ShowAllAsmtShifts();

            //end of  Commented on Oct 29 2012
            return true;
        }

        //Functions Related to Move the DIv
        var pickedUp = new Array("", false);
        function MoveDuplicateMsgDiv(element, evt) {
            pickedUp[0] = document.getElementById(element).id; //element;
            pickedUp[1] = true;
        }

        function checkLoadedObjects(evt) {
            if (pickedUp[1] == true) {
                var currentSelection = document.getElementById(pickedUp[0]);
                currentSelection.style.position = "absolute";
                currentSelection.style.top = (evt.clientY - 50) + "px";
                currentSelection.style.left = (evt.clientX - 120) + "px";
            }
        }

        function dropLoadedObject(evt) {
            if (pickedUp[1] == true) {
                var currentSelection = document.getElementById(pickedUp[0]);
                currentSelection.style.position = "absolute";
                currentSelection.style.top = (evt.clientY - 50) + "px";
                currentSelection.style.left = (evt.clientX - 120) + "px";
                pickedUp = new Array("", false);
            }
        }
        //=======================================
        //Function Related to Close of DIV [Overwrite]
        function CloseMsgBoxShift() {

            document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
            if (document.getElementById('<%=ddlPost.ClientID %>').selectedIndex != -1) {
                document.getElementById('<%=HFPostText.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').options[document.getElementById('<%=ddlPost.ClientID %>').selectedIndex].text;
            }
            document.getElementById('DIVMultipleOverwrite').style.display = "none";

            document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            document.getElementById('<%=btnProceed.ClientID %>').click();

            var strScreenType = document.getElementById('<%=ddlAttendanceType.ClientID %>').value;

            // WebMethods.GetExceptionRecords(document.getElementById('<%= HidCon.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFMaxDate.ClientID %>').value), document.getElementById('<% =txtAsmtCode.ClientID %>').value, document.getElementById('<%= HFCurrentSessionID.ClientID %>').value, SessionLocationAutoId, strScreenType, document.getElementById(GlobEmployeeNumber).value, SessionUserId, OnGetExceptionRecordsComplete, OnWSRequestFailed);
            return;
        }
        //=======================================
        // Find The position to display the dropdown
        //=======================================
        function findPos(obj) {
            var curleft = curtop = 0;
            try {
                if (obj.offsetParent) {
                    curleft = obj.offsetLeft;
                    curtop = obj.offsetTop;
                    while (obj = obj.offsetParent) {
                        curleft += obj.offsetLeft;
                        curtop += obj.offsetTop;
                    }
                }
                return [curleft, curtop];
            }
            catch (Error) { return; }
        }
        //=======================================
        // Function To Search Employee Number in the dropDown
        //=======================================
        function SearchEmployee(obj) {

            var strEmployee = "txtEmpNumberDutyDate";
            var strEmployeeName = "txtEmpNameDutyDate";
            var elEmployee = getClientId(obj, strEmployee);
            var employeeNameClientId = getClientId(obj, strEmployeeName);
            GlobEmployeeNumber = elEmployee;
            GlobEmployeeName = employeeNameClientId;
            var elList = document.getElementById('<% =LBEmployeeList.ClientID %>');
            var elEmpList = document.getElementById('<% =ddlEmployees.ClientID %>');
            try {
                if (window.event.keyCode == 13) {
                    if (elList.selectedIndex > -1) {
                        document.getElementById(elEmployee).value = elList.options[elList.selectedIndex].value;
                        document.getElementById(employeeNameClientId).value = elList.options[elList.selectedIndex].text;
                        document.getElementById('divEmployeeContainer').style.display = "none";
                        GlobEmployeeName = getClientId(document.getElementById(elEmployee), "txtEmpNameDutyDate");
                        GlobEmployeeDesgDesc = getClientId(document.getElementById(elEmployee), "txtEmpDesignationDesc");
                        GlobEmployeeDesgCode = getClientId(document.getElementById(elEmployee), "HFDesignationCode");
                        var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                        //Added Area ID option to search only those employee that belongs to that Area
                        var strScreenType;
                        if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {
                            strScreenType = 'ACT';
                        }
                        else {
                            strScreenType = 'SCH';
                        }
                        WebMethods.GetEmployeeDetail(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById(elEmployee).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), strPost, 'GETEMP', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType, SessionCompanyCode, SessionHrLocationCode, SessionLocationAutoId, SessionUserId, OnGetEmployeeDetailComplete, OnWSRequestFailed);

                    }
                    return;
                }
                else if (window.event.keyCode == 40) {
                    if (document.getElementById('divEmployeeContainer').style.display == "block") {
                        elList.focus();
                    }
                    return;
                }
                else if (window.event.keyCode == 9) {
                    return;
                }
                else if (window.event.keyCode == 0 && elList.length > 0) /////// on blur
                {
                    document.getElementById('divEmployeeContainer').style.display = "block";
                    if (elList.selectedIndex > -1) {
                        document.getElementById(elEmployee).value = elList.options[elList.selectedIndex].value;
                        document.getElementById(employeeNameClientId).value = elList.options[elList.selectedIndex].text;

                        GlobEmployeeName = getClientId(document.getElementById(elEmployee), "txtEmpNameDutyDate");
                        GlobEmployeeDesgDesc = getClientId(document.getElementById(elEmployee), "txtEmpDesignationDesc");
                        GlobEmployeeDesgCode = getClientId(document.getElementById(elEmployee), "HFDesignationCode");
                        var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                        //Added Area ID option to search only those employee that belongs to that Area
                        var strScreenType;
                        if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {
                            strScreenType = 'ACT';
                        }
                        else {
                            strScreenType = 'SCH';
                        }
                        WebMethods.GetEmployeeDetail(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById(elEmployee).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), strPost, 'GETEMP', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType, SessionCompanyCode, SessionHrLocationCode, SessionLocationAutoId, SessionUserId, OnGetEmployeeDetailComplete, OnWSRequestFailed);

                    }
                    elList.selectedIndex = -1;
                    return;
                }
                else {
                    if (window.event.keyCode == 0) {
                        document.getElementById('divEmployeeContainer').style.display = "block";
                        return;
                    }
                    var lyr = document.getElementById('divEmployeeContainer');
                    var coors = findPos(document.getElementById(elEmployee));
                    lyr.style.top = coors[1] + 20 + 'px';
                    lyr.style.left = coors[0] + 'px';
                    document.getElementById('divEmployeeContainer').style.display = "block";
                    var j = 0;
                    j = FindIndex(elEmpList, 0, elEmpList.length, document.getElementById(employeeNameClientId).value.toLowerCase());
                    elList.length = 0;
                    for (i = j; i < j + 50 && i < elEmpList.length; i++) {
                        if (elEmpList.options[i].text.toLowerCase().substr(0, document.getElementById(employeeNameClientId).value.length) == document.getElementById(employeeNameClientId).value.toLowerCase()) {
                            elList.options.add(new Option(elEmpList.options[i].text, elEmpList.options[i].value));
                            elList.selectedIndex = 0;
                        }
                    }
                }
            }

            catch (Error) { return; }

        }

        // This function is used to find the client side index of the gridview controls
        function FindIndex(objList, indx, eIndx, str) {
            if (objList.options[indx].text.toLowerCase().substr(0, str.length) < str) {
                indx = indx + (eIndx - indx) / 2;
                if (eIndx - indx > 20)
                { return FindIndex(objList, indx, eIndx, str); }
                else if (indx < 20)
                { return 0; }
                else
                { return indx - 20; }
            }
            else if (objList.options[indx].text.toLowerCase().substr(0, str.length) >= str) {

                if (indx - (eIndx - indx) >= 0)
                { return FindIndex(objList, indx - (eIndx - indx), indx, str); }
                else
                { return 0; }
            }
        }
        //=======================================
        //Function Used to select EmployeeNumber After Searchin Drop Down
        //=======================================
        function SelectEmployee(obj) {

            var el = GlobEmployeeNumber;
            var employeeNameClientId = GlobEmployeeName;
            if (obj.selectedIndex >= 0) {
                document.getElementById(el).value = obj.options[obj.selectedIndex].value;
                document.getElementById(employeeNameClientId).value = obj.options[obj.selectedIndex].text;
                document.getElementById(el).focus();
                document.getElementById('divEmployeeContainer').style.display = "none";
                GlobEmployeeName = getClientId(document.getElementById(el), "txtEmpNameDutyDate");
                GlobEmployeeDesgDesc = getClientId(document.getElementById(el), "txtEmpDesignationDesc");
                GlobEmployeeDesgCode = getClientId(document.getElementById(el), "HFDesignationCode");
                GlobShiftPatternCode = getClientId(document.getElementById(el), "txtShiftPatternCode");

                globBorrowedEmployeeStatus = getClientId(document.getElementById(el), "hfBorrowedEmployeeStatus");

                var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                //Added Area ID option to search only those employee that belongs to that Area
                var strScreenType;
                if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {
                    strScreenType = 'ACT';
                }
                else {
                    strScreenType = 'SCH';
                }
                WebMethods.GetEmployeeDetail(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById(el).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), strPost, 'GETEMP', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType, SessionCompanyCode, SessionHrLocationCode, SessionLocationAutoId, SessionUserId, OnGetEmployeeDetailComplete, OnWSRequestFailed);

            }
            return;
        }

        //=======================================
        //Function Used to Search Shift In Drop Down
        //=======================================
        function OnGetAllShiftWSRequestComplete(result) {
            var columnIndex;
            var strReversedString = GlobObject.id.split('').reverse().join('');
            columnIndex = strReversedString.substring(0, 2);
            if (isNaN(columnIndex)) {
                columnIndex = strReversedString.substring(0, 1);
            }
            else {
                columnIndex = columnIndex.toString().split('').reverse().join('');
            }
            var res1 = result;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");

            var l = 0;
            document.getElementById('<% =LBShift.ClientID %>').length = 0;
            for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {
                var option = document.createElement("OPTION");
                option.text = xmlDoc1.getElementsByTagName("ShiftDetails")[l].firstChild.nodeValue;
                option.value = xmlDoc1.getElementsByTagName("PDLineNo")[l].firstChild.nodeValue;
                document.getElementById('<% =LBShift.ClientID %>').options.add(option);
                l++;
            }
            document.getElementById('<% =LBShift.ClientID %>').selectedIndex = -1;

            //********************************************
            var elList = document.getElementById('<% =LBShift.ClientID %>');
            var strTimeFrom = getClientId(GlobObject, "txtTimeFrom" + columnIndex);
            var strTimeTo = getClientId(GlobObject, "txtTimeTo" + columnIndex);
            GlobEmployeeTimeFrom = strTimeFrom;
            GlobEmployeeTimeTo = strTimeTo;
            var strShift = "txtEmpShiftDutyDate" + columnIndex;
            var elShift = getClientId(GlobObject, strShift);
            GlobEmployeeShiftCode = elShift;

            if (GlobKeyCode == 13) {
                if (elList.selectedIndex > -1) {
                    document.getElementById(elShift).value = elList.options[elList.selectedIndex].text.substring(0, 1);
                    document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value = document.getElementById(elShift).value;
                    document.getElementById('<%=HFNewPDLineNo.ClientID %>').value = elList.options[elList.selectedIndex].value;
                    var arr = new Array;
                    arr = elList.options[elList.selectedIndex].text.split("[");
                    var arr1 = new Array;
                    arr1 = arr[1].split('/');
                    var arrTimeDetail = arr1[0].split('-');
                    document.getElementById(GlobEmployeeTimeFrom).value = arrTimeDetail[0];
                    document.getElementById(GlobEmployeeTimeTo).value = arrTimeDetail[1];
                    document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = arrTimeDetail[0];
                    document.getElementById('<%=HFNewTimeTo.ClientID %>').value = arrTimeDetail[1];
                    document.getElementById('divShift').style.display = "none";
                }
                return;
            }
            else if (GlobKeyCode == 40) {
                if (document.getElementById('divShift').style.display == "block") {
                    elList.focus();
                }
                return;
            }
            else if (GlobKeyCode == 9) {
                if (document.getElementById(elShift).value != "") {
                    try {
                        document.getElementById(elShift).value = elList.options[elList.selectedIndex].text.substring(0, 1);
                        document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value = document.getElementById(elShift).value;
                        document.getElementById('<%=HFNewPDLineNo.ClientID %>').value = elList.options[elList.selectedIndex].value;
                        var arr = new Array;
                        arr = elList.options[elList.selectedIndex].text.split("[");
                        var arr1 = new Array;
                        arr1 = arr[1].split('/');
                        var arrTimeDetail = arr1[0].split('-');
                        document.getElementById(GlobEmployeeTimeFrom).value = arrTimeDetail[0];
                        document.getElementById(GlobEmployeeTimeTo).value = arrTimeDetail[1];
                        document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = arrTimeDetail[0];
                        document.getElementById('<%=HFNewTimeTo.ClientID %>').value = arrTimeDetail[1];
                        document.getElementById('divShift').style.display = "none";
                        return;
                    }
                    catch (Error) { return; }
                }
            }
            else if (GlobKeyCode == 0 && elList.length > 0) /////// on blur
            {
                if (elList.selectedIndex > -1) {
                    document.getElementById(elShift).value = elList.options[elList.selectedIndex].text.substring(0, 1);
                    document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value = document.getElementById(elShift).value;
                    document.getElementById('<%=HFNewPDLineNo.ClientID %>').value = elList.options[elList.selectedIndex].value;
                    var arr = new Array;
                    arr = elList.options[elList.selectedIndex].text.split("[");
                    var arr1 = new Array;
                    arr1 = arr[1].split('/');
                    var arrTimeDetail = arr1[0].split('-');
                    document.getElementById(GlobEmployeeTimeFrom).value = arrTimeDetail[0];
                    document.getElementById(GlobEmployeeTimeTo).value = arrTimeDetail[1];
                    document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = arrTimeDetail[0];
                    document.getElementById('<%=HFNewTimeTo.ClientID %>').value = arrTimeDetail[1];
                }
                document.getElementById('divShift').style.display = "none";
                elList.selectedIndex = -1;
                return;
            }
            else {
                if (GlobKeyCode == 0)
                { return; }
                var lyr = document.getElementById('divShift');
                var coors = findPos(document.getElementById(elShift));
                lyr.style.top = coors[1] + 20 + 'px';
                lyr.style.left = coors[0] + 'px';
                document.getElementById('divShift').style.display = "block";
                elList.selectedIndex = -1;
                for (i = 0; i < elList.length; i++) {
                    if (elList.options[i].text.toLowerCase().substr(0, document.getElementById(elShift).value.length) == document.getElementById(elShift).value.toLowerCase()) {
                        elList.options[i].selected = true;
                        return;
                    }
                }
            }

            //**************************************************

        }

        function OnGetAllShiftWSRequestFailed() {

        }
        var GlobKeyCode;
        // This function is used to search Shift 
        function SearchShift(obj) {
            if (window.event.keyCode == 45 || window.event.keyCode == 46) { // Insert Key AND DELETE KEY Pressed to copy to next day
                return;
            }
            var columnIndex;
            var strReversedString = obj.id.split('').reverse().join('');
            columnIndex = strReversedString.substring(0, 2);
            if (isNaN(columnIndex)) {
                columnIndex = strReversedString.substring(0, 1);
            }
            else {
                columnIndex = columnIndex.toString().split('').reverse().join('');
            }
            var strDutyDate = "lblHeaderDutyDate" + columnIndex;
            var dutyDate = 'gvScheduleRoster_ctl01_' + strDutyDate;
            GlobObject = obj;
            WebMethods.GetAllShiftsOfDay(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById('<%= txtAsmtCode.ClientID %>').value, SessionLocationAutoId, DateInFormat(document.getElementById(dutyDate).innerText), document.getElementById('<%=ddlWeek.ClientID %>').value, document.getElementById('<%=ddlPost.ClientID %>').value, OnGetAllShiftWSRequestComplete, OnGetAllShiftWSRequestFailed);
            GlobKeyCode = window.event.keyCode;
        }
        //=======================================
        //Function Used to select Shift After Searchin Drop Down
        //=======================================
        function SelectShift(obj) {
            var el = GlobEmployeeShiftCode;
            if (obj.selectedIndex >= 0) {
                var arr = new Array;
                arr = obj.options[obj.selectedIndex].text.split("[");
                var arr1 = new Array;
                arr1 = arr[1].split(']');
                var arrTimeDetail = arr1[0].split('-');
                document.getElementById(el).value = obj.options[obj.selectedIndex].text.substring(0, 1);
                document.getElementById(el).focus();
                document.getElementById(GlobEmployeeTimeFrom).value = arrTimeDetail[0];
                document.getElementById(GlobEmployeeTimeTo).value = arrTimeDetail[1];
                document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = arrTimeDetail[0];
                document.getElementById('<%=HFNewTimeTo.ClientID %>').value = arrTimeDetail[1];
                document.getElementById('<%=HFNewPDLineNo.ClientID %>').value = obj.options[obj.selectedIndex].value;
                document.getElementById('divShift').style.display = "none";
            }
            return;
        }
        //=======================================
        //Function Used to Search Shift Pattern In Drop Down
        //=======================================
        function SearchShiftPattern(obj) {

            if (window.event.keyCode == 45) { // Insert Key Pressed to copy to next day
                return;
            }
            if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {

                return;
            }
            var strShiftPatternCode = "txtShiftPatternCode";
            var elShiftPatternCode = getClientId(obj, strShiftPatternCode);
            GlobShiftPatternCode = elShiftPatternCode;
            var elList = document.getElementById('<% =LBShiftPatterns.ClientID %>');
            if (window.event.keyCode == 13) {
                if (elList.selectedIndex > -1) {
                    GlobPDLineWiseShiftPatternCode = elList.options[elList.selectedIndex].value;
                    document.getElementById(elShiftPatternCode).value = elList.options[elList.selectedIndex].text;
                    document.getElementById('DivShiftPatterns').style.display = "none";
                }
                return;
            }
            else if (window.event.keyCode == 40) {
                if (document.getElementById('DivShiftPatterns').style.display == "block") {
                    elList.focus();
                }
                return;

            }
            else if (window.event.keyCode == 9) {
                return;
            }
            else if (window.event.keyCode == 0 && elList.length > 0) /////// on blur
            {
                document.getElementById('DivShiftPatterns').style.display = "block";
                if (elList.selectedIndex > -1) {
                    GlobPDLineWiseShiftPatternCode = elList.options[elList.selectedIndex].value;
                    document.getElementById(elShiftPatternCode).value = elList.options[elList.selectedIndex].text;
                }
                elList.selectedIndex = -1;
                return;
            }
            else {
                if (window.event.keyCode == 0) {
                    document.getElementById('DivShiftPatterns').style.display = "block";
                    return;
                }
                var lyr = document.getElementById('DivShiftPatterns');
                var coors = findPos(document.getElementById(elShiftPatternCode));
                lyr.style.top = coors[1] + 20 + 'px';
                lyr.style.left = coors[0] + 'px';
                document.getElementById('DivShiftPatterns').style.display = "block";
                elList.selectedIndex = -1;
                for (i = 0; i < elList.length; i++) {
                    if (elList.options[i].text.toLowerCase().substr(0, document.getElementById(elShiftPatternCode).value.length) == document.getElementById(elShiftPatternCode).value.toLowerCase()) {
                        elList.options[i].selected = true;
                        return;
                    }
                }
            }
        }
        //=======================================
        //Function Used to select Shift Pattern After Searchin Drop Down
        //=======================================
        function SelectShiftPattern(obj) {
            var el = GlobShiftPatternCode;
            if (obj.selectedIndex >= 0) {
                GlobPDLineWiseShiftPatternCode = obj.options[obj.selectedIndex].value;
                document.getElementById(el).value = obj.options[obj.selectedIndex].text;
                document.getElementById(el).focus();
                document.getElementById('DivShiftPatterns').style.display = "none";
            }
            return;
        }


        //=======================================
        //Function Used To Validate Time
        //=======================================
        function IsValidTime(obj, txtBoxType) {
            // var columnIndex = parseInt(document.getElementById('<%=HFColumnIndex.ClientID %>').value) - 1;
            var columnIndex;
            var strReversedString = obj.id.split('').reverse().join('');
            columnIndex = strReversedString.substring(0, 2);
            if (isNaN(columnIndex)) {
                columnIndex = strReversedString.substring(0, 1);
            }
            else {
                columnIndex = columnIndex.toString().split('').reverse().join('');
            }
            var strTime;
            if (txtBoxType == 'T') {
                strTime = "txtTimeTo" + columnIndex;
            }
            else {
                strTime = "txtTimeFrom" + columnIndex;
            }
            var timeStr = getClientId(obj, strTime);
            var timePat = /^(\d{2}):(\d{2})$/;
            if (document.getElementById(timeStr).value.length == 4 && document.getElementById(timeStr).value.charAt(2) != ":" && document.getElementById(timeStr).value.charAt(3) != ":") {
                document.getElementById(timeStr).value = document.getElementById(timeStr).value.substring(0, 2) + ":" + document.getElementById(timeStr).value.substring(2, 4);
                if (document.getElementById(timeStr).value != "") {
                    var matchArray = document.getElementById(timeStr).value.match(timePat);
                    if (matchArray == null) {
                        alert(TimeisNotInValidFormat);
                        document.getElementById(timeStr).value = "";
                        document.getElementById(timeStr).focus();
                        return false;
                    }
                    hour = matchArray[1];
                    minute = matchArray[2];

                    if (hour < 0 || hour > 23) {
                        alert(HourMustBeBetween0And23);
                        document.getElementById(timeStr).value = "";
                        document.getElementById(timeStr).focus();
                        return false;
                    }
                    if (minute < 0 || minute > 59) {
                        alert(MinuteMustBeBetween0And59);
                        document.getElementById(timeStr).value = "";
                        document.getElementById(timeStr).focus();
                        return false;
                    }
                }
                if (document.getElementById(timeStr).value == "") {
                    document.getElementById(timeStr).value = "00:00";
                    return true;
                }
                return true;
            }
            if (document.getElementById(timeStr).value.charAt(1) != ":" && document.getElementById(timeStr).value.charAt(2) != ":") {
                if (document.getElementById(timeStr).value.length == 1) {
                    document.getElementById(timeStr).value = "0" + document.getElementById(timeStr).value + ":00";
                    return true;
                }
                if (document.getElementById(timeStr).value.length == 2 && document.getElementById(timeStr).value < 24) {
                    document.getElementById(timeStr).value = document.getElementById(timeStr).value + ":00";
                    return true;
                }
            }

            if (document.getElementById(timeStr).value != "") {
                var matchArray = document.getElementById(timeStr).value.match(timePat);
                if (matchArray == null) {
                    alert(TimeisNotInValidFormat);
                    document.getElementById(timeStr).value = "";
                    document.getElementById(timeStr).focus();
                    return false;
                }
                hour = matchArray[1];
                minute = matchArray[2];

                if (hour < 0 || hour > 23) {
                    alert(HourMustBeBetween0And23);
                    document.getElementById(timeStr).value = "";
                    document.getElementById(timeStr).focus();
                    return false;
                }
                if (minute < 0 || minute > 59) {
                    alert(MinuteMustBeBetween0And59);
                    document.getElementById(timeStr).value = "";
                    document.getElementById(timeStr).focus();
                    return false;
                }
            }
            if (document.getElementById(timeStr).value == "") {
                document.getElementById(timeStr).value = "00:00";
                return true;
            }
            return true;
        }
        //=======================================
        // Function used After GetEmpDetails Function Is Called to Get Employee Details
        //=======================================

        function OnGetEmployeeDetailComplete(str) {
            LoadingComplete();
            var arr = new Array;
            arr = str.split(",");

            if (arr[12] == "1") {
                document.getElementById(GlobShiftPatternCode).disabled = true;
                if (document.getElementById(globBorrowedEmployeeStatus).value == "") {
                    document.getElementById(globBorrowedEmployeeStatus).value = "1";
                }
            }
            else {
                document.getElementById(GlobShiftPatternCode).disabled = false;
            }
            if (arr[1] == "Invalid") {


                if (arr[3] == "ENE") {
                    alert(InvalidEmpCode);
                    document.getElementById(GlobEmployeeNumber).value = "";
                }
                else if (arr[3] == "ENBL") {
                    alert(Employeedutydatecannotbegreaterthandateofresignation);
                    document.getElementById(GlobEmployeeNumber).value = "";
                }
                else if (arr[3] == "EmpJoiningDatecannotbegreaterthanDutydate") {
                    alert(EmpJoiningDatecannotbegreaterthanDutydate);
                    document.getElementById(GlobEmployeeNumber).value = "";
                }

                else if (arr[3] == "NA") {
                    alert(InvalidEmpCode);
                    document.getElementById(GlobEmployeeNumber).value = "";
                }
                else if (arr[3] == "B") {
                    alert(Employeeisbarredfromthisassignment);
                    document.getElementById(GlobEmployeeNumber).value = "";
                }
                else if (arr[3] == "MP") {
                    alert(Minimumprofitabilitynotmet);
                    document.getElementById(GlobEmployeeNumber).value = "";
                }
                else if (arr[3] == "IA") {
                    alert(EmployeeDoesnotbelongstothisArea);
                }
                else if (arr[3] == "M") {
                    var arrSkills = new Array;
                    arrSkills = arr[4].split("/");
                    var strMsg = FollowingMandatoryskillsdoesnotmatch;
                    strMsg = strMsg + "\n";
                    for (var i = 0; i < parseInt(arrSkills.length); i++) {
                        strMsg = strMsg + arrSkills[i] + ",";
                    }
                    var replacedString = strMsg.replace("RefresherTrainingPending", RefresherTrainingPending);
                    alert(replacedString);
                    document.getElementById(GlobEmployeeNumber).value = "";
                }
                else {
                    alert(InvalidEmpCode);
                    document.getElementById(GlobEmployeeNumber).value = "";
                }
                document.getElementById(GlobEmployeeNumber).focus();
                document.getElementById('divEmployeeContainer').style.display = "none";
                return false;
            }
            else {
                var status = "";
                var reqMandatoryStatus = "";
                if (arr[8] != 'SINGLE' && arr[8] != 'COPY') {

                    if (arr[4] == "0") {
                        var status = confirm(EmployeeSkillsDoesNotMatchWithRequiredSkillsDoYouWantToContinue);
                        reqMandatoryStatus = "1";
                        if (!status) {
                            document.getElementById(GlobEmployeeNumber).focus();
                            document.getElementById('divEmployeeContainer').style.display = "none";
                            status = "";
                            return false;
                        }
                        status = "";
                    }
                    if (arr[4] == "1") {
                        var arrSkills = new Array;
                        arrSkills = arr[11].split("/");
                        var strMsg = FollowingMandatoryskillsdoesnotmatch;
                        strMsg = strMsg + "\n";
                        for (var i = 0; i < parseInt(arrSkills.length); i++) {

                            strMsg = strMsg + arrSkills[i] + ",";

                        }
                        var replacedString = strMsg.replace("RefresherTrainingPending", RefresherTrainingPending);
                        alert(replacedString);
                        document.getElementById(GlobEmployeeNumber).value = "";
                        document.getElementById(GlobEmployeeNumber).focus();
                        document.getElementById('divEmployeeContainer').style.display = "none";
                        return false;
                    }
                    if (arr[10] != "OK") {
                        var status = confirm(EmployeePayRateIsGreaterThanSaleOrderPayRateDoYouWantToContinue);
                        if (!status) {
                            document.getElementById(GlobEmployeeNumber).focus();
                            document.getElementById(GlobEmployeeNumber).value = "";
                            document.getElementById('divEmployeeContainer').style.display = "none";
                            status = "";
                            return false;
                        }
                        else {

                            if (arr[13] != "OK") {
                                var status = confirm(OptimumProfitabilityMismatch);
                                if (!status) {
                                    document.getElementById(GlobEmployeeNumber).focus();
                                    document.getElementById(GlobEmployeeNumber).value = "";
                                    document.getElementById('divEmployeeContainer').style.display = "none";
                                    status = "";
                                    return false;
                                }
                            }
                            document.getElementById(GlobEmployeeNumber).style.color = "red";
                            document.getElementById(GlobEmployeeName).style.color = "red";
                            document.getElementById(GlobEmployeeDesgDesc).style.color = "red";
                            document.getElementById(GlobPatternPosition).style.color = "red";
                            document.getElementById(GlobShiftPatternCode).style.color = "red";
                            // "2" when user clicks YES
                            var strScreenType;
                            if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {
                                strScreenType = 'ACT';
                            }
                            else {
                                strScreenType = 'SCH';
                            }
                            WebMethods.InsertExceptionRecords(document.getElementById('<%= HidCon.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), "", document.getElementById('<% =txtAsmtCode.ClientID %>').value, "", SessionLocationAutoId, strScreenType, document.getElementById(GlobEmployeeNumber).value, "2", SessionUserId, OnInsertExceptionRecordsComplete, OnWSRequestFailed);
                        }
                        status = "";
                    }
                    if (arr[9] != "" && reqMandatoryStatus != "1") {
                        var status = confirm(EmployeeSkillsDoesNotMatchWithRequiredSkillsDoYouWantToContinue);
                        if (!status) {
                            document.getElementById(GlobEmployeeNumber).focus();
                            document.getElementById('divEmployeeContainer').style.display = "none";
                            status = "";
                            return false;
                        }
                        status = "";

                    }
                }
                document.getElementById(GlobEmployeeName).value = arr[1];
                document.getElementById(GlobEmployeeDesgDesc).value = arr[2];
                document.getElementById('<%=HFNewEmployeeNumber.ClientID %>').value = document.getElementById(GlobEmployeeNumber).value;
                document.getElementById('<%=HFNewDesignationCode.ClientID %>').value = arr[5];
                document.getElementById(GlobEmployeeDesgCode).value = document.getElementById('<%=HFNewDesignationCode.ClientID %>').value;
                try {
                    document.getElementById(getClientId(document.getElementById(GlobEmployeeNumber), "txtShiftPatternCode")).select();
                }
                catch (Error) { }

                document.getElementById('divEmployeeContainer').style.display = "none";
                globCopyStatus = "0";
                if (arr[8] == 'SINGLE') {
                    SaveData();
                }
                else if (arr[8] == 'COPY') {
                    if (document.getElementById(GlobEmployeeSchRosterAutoID).value != "") {
                        globCopyStatus = "1";
                        CopyData(document.getElementById(GlobEmployeeSchRosterAutoID).value);
                    }
                }

            }
        }


        // Function to Copy data to next week when insert key is pressed
        function CopyData(schRosterAutoID) {

            var strScreenType = document.getElementById('<%=ddlAttendanceType.ClientID %>').value;
            WebMethods.CopyData(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById('<%= ddlWeek.ClientID %>').value, schRosterAutoID, strScreenType, document.getElementById('<%=HFCurrentSessionID.ClientID %>').value, SessionUserId, DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<%=HFMaxDate.ClientID %>').value), document.getElementById('<%=HFNewEmployeeNumber.ClientID %>').value, OnInsertDataOfDateComplete, OnWSRequestFailed);
        }

        function OnCheckAlertRequestComplete(strResult) {
            alert(strResult);
        }

        function OnCheckAlertRequestFailed() {

            alert('error');
        }
        //=======================================
        //Function used to Save Data
        //=======================================
        WebMethods.set_timeout = "300000";
        function SaveData() {

            var strDefaultSite;
            var strPatternPosition = document.getElementById(GlobPatternPosition).value;
            if (strPatternPosition == "" || strPatternPosition == "0") {
                strPatternPosition = 1;
            }
            var strShiftPatternCode = document.getElementById(GlobShiftPatternCode).value;
            if (strShiftPatternCode == '') {
                strDefaultSite = false;
            }
            else {
                strDefaultSite = true;
            }
            var pDlineNo;
            var strSoRank = "A-Site1-SGS";
            if (document.getElementById('<%=HFNewPDLineNo.ClientID %>').value != "") {
                pDlineNo = document.getElementById('<%=HFNewPDLineNo.ClientID %>').value;
            }
            else {

                if (document.getElementById(GlobPDLineNo).value != '') {
                    pDlineNo = document.getElementById(GlobPDLineNo).value;
                }
                else {
                    pDlineNo = '0';
                }
            }
            var strOpsShift = document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value;
            if (pDlineNo == '') {
                alert(InvalidShift);
                return;
            }
            if (document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value == "") {
                document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = 0;
            }
            //=======================================
            //Parameters Used In InsertData By Order
            //=========================================
            var entryType = "";

            if (document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value != "" && document.getElementById('<%=HFNewDesignationCode.ClientID %>').value != "" && document.getElementById('<%=HFNewTimeFrom.ClientID %>').value != "" && document.getElementById('<%=HFNewTimeTo.ClientID %>').value != "" && pDlineNo != "") {
                var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;

                var roleCode = "Role";
                var dutyTypeCode = "DutyType";
                var screenType = document.getElementById('<%= ddlAttendanceType.ClientID%>').value;
                if (document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value != "0" && document.getElementById('<%=HFNewTimeFrom.ClientID %>').value == "00:00" && document.getElementById('<%=HFNewTimeTo.ClientID %>').value == "00:00") {
                    alert("Invalid Shift and Time");
                    return;
                }

                WebMethods.InsertDataOfDate(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById('<%=txtAsmtCode.ClientID %>').value, document.getElementById('<%=HFNewEmployeeNumber.ClientID %>').value, DateInFormat(document.getElementById(GlobEmployeeDutyDate).innerText), document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value, document.getElementById('<%=ddlWeek.ClientID %>').value, roleCode, document.getElementById('<%=HFNewDesignationCode.ClientID %>').value, strShiftPatternCode, strPatternPosition, strDefaultSite, strOpsShift, strSoRank, document.getElementById('<%=HFNewTimeFrom.ClientID %>').value, document.getElementById('<%=HFNewTimeTo.ClientID %>').value, dutyTypeCode, entryType, document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value, pDlineNo, document.getElementById(GlobRowNumber).innerText, strPost, screenType, DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<%=HFMaxDate.ClientID %>').value), document.getElementById('<%=HFCurrentSessionID.ClientID %>').value, SessionLocationAutoId, SessionUserId, OnInsertDataOfDateComplete, OnWSRequestFailed);

            }
            else {
                if (document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value == "") {
                    alert(ShiftCodeCannotbeleftBlank);
                    document.getElementById(GlobEmployeeShiftCode).focus();
                }
                if (document.getElementById('<%=HFNewTimeFrom.ClientID %>').value == "") {
                    alert(TimeFromCannotbeleftBlank);
                    document.getElementById(GlobEmployeeTimeFrom).focus();
                }
                if (document.getElementById('<%=HFNewTimeTo.ClientID %>').value == "") {
                    alert(TimeToCannotbeleftBlank);
                    document.getElementById(GlobEmployeeTimeTo).focus();
                }
            }
        }
        // This function is used to overwrite multiple records
        function OverWriteMultiRecord() {
            // try {
            var i;
            var xmlString = "";
            var overwriteStatus = 0;

            var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
            var rowClientId = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var strEmployee = "txtEmpNumberDutyDate";
            var strShiftPatternCode = "txtShiftPatternCode";
            var cellShiftPatternCode = document.getElementById(getClientId(rowClientId, strShiftPatternCode)).value;
            var employeeNumber = document.getElementById(getClientId(rowClientId, strEmployee)).value;
            var columnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var rowNumber = document.getElementById(getClientId(rowClientId, "lblRowID")).innerText;

            try {
                var strScheduleRosterAutoID = "HFSchRosterAutoID" + columnIndex;
                var cellRosterAutoID = document.getElementById(getClientId(rowClientId, strScheduleRosterAutoID)).value;
                if (document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value == "") {
                    document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = "0";
                }
            }
            catch (Error) { }
            for (i = 0; i < parseInt(document.getElementById('totalDuplicatedCount0').value); i++) {
                var k = parseInt(i);

                if (document.getElementById('chk' + parseInt(i)) == '[object]') {

                    var overwriteChecked = document.getElementById('chk' + parseInt(i)).checked;
                    if (overwriteChecked == true) {
                        var strDefaultSite;
                        var strPatternPosition = document.getElementById('HFPatternPosition' + parseInt(i)).value;
                        // var strShiftPatternCode = document.getElementById(GlobShiftPatternCode).value;
                        var strShiftPatternCode = "";

                        if (cellShiftPatternCode == '') {
                            strDefaultSite = false;
                        }
                        else {
                            strDefaultSite = true;
                        }
                        var strSoRank = 'A-Site1-SGS';
                        var entryType = 'Multi';
                        var strOpsShift = strSoRank.substring(0, 1);
                        if (document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value == "") {
                            document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = 0;
                        }
                        GlobOverwriteStatus = 1;

                        xmlString = xmlString + "<Record>";
                        xmlString = xmlString + "<DutyDate>" + DateInFormat(document.getElementById('HFDutyDateToOverWrite' + parseInt(i)).value) + "</DutyDate>";
                        xmlString = xmlString + "<DupShiftCode>" + document.getElementById('HFShiftCodeToOverWrite' + parseInt(i)).value + "</DupShiftCode>";
                        xmlString = xmlString + "<PatternPosition>" + strPatternPosition + "</PatternPosition>";
                        xmlString = xmlString + "<FromTimeToOverwrite>" + document.getElementById('HFTimeFromToOverwrite' + parseInt(i)).value + "</FromTimeToOverwrite>";
                        xmlString = xmlString + "<ToTimeToOverwrite>" + document.getElementById('HFToTimeToOverwrite' + parseInt(i)).value + "</ToTimeToOverwrite>";
                        xmlString = xmlString + "<PDlineNoToOverWrite>" + document.getElementById('HFPDlineNoToOverwrite' + parseInt(i)).value + "</PDlineNoToOverWrite>";
                        xmlString = xmlString + "<ScheduleRosterAutoID>" + document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value + "</ScheduleRosterAutoID>";
                        xmlString = xmlString + "<DupSchRosterAutoID>" + document.getElementById('HFDupSchRosterAutoID' + parseInt(i)).value + "</DupSchRosterAutoID>";
                        xmlString = xmlString + "<RowNumber>" + rowNumber + "</RowNumber>";
                        xmlString = xmlString + "<RowId>" + i + "</RowId>";
                        xmlString = xmlString + "</Record>";
                        overwriteStatus = 1;

                    }
                    else {
                        GlobOverwriteStatus = 0;
                    }
                }


            }
            xmlString = "<root>" + xmlString + "</root>";
            if (overwriteStatus == 1) {
                WebMethods.OverwriteSchedule(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById('<%=txtAsmtCode.ClientID %>').value, employeeNumber, document.getElementById('<%=ddlWeek.ClientID %>').value, document.getElementById('<%=HFNewDesignationCode.ClientID %>').value, cellShiftPatternCode, SessionLocationAutoId, SessionUserId, xmlString, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, OnSucessfulOverwrite, OnWSRequestFailed);
            }
            else {
                document.getElementById('DIVMultipleOverwrite').style.display = "none";
            }

            //            }
            //            catch (Error) {
            //                return;
            //            }
        }

        function OnSucessfulOverwrite(result) {

            if (result != "") {
                document.getElementById('span2').innerHTML = result;
                return

            }

            document.getElementById('span2').innerHTML = "";
            document.getElementById('DIVMultipleOverwrite').style.display = "none";
            document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            document.getElementById('<%=btnProceed.ClientID %>').click();
            var strScreenType = document.getElementById('<%=ddlAttendanceType.ClientID %>').value;

            //  WebMethods.GetExceptionRecords(document.getElementById('<%= HidCon.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFMaxDate.ClientID %>').value), document.getElementById('<% =txtAsmtCode.ClientID %>').value, document.getElementById('<%= HFCurrentSessionID.ClientID %>').value, SessionLocationAutoId, strScreenType, document.getElementById(GlobEmployeeNumber).value, SessionUserId, OnGetExceptionRecordsComplete, OnWSRequestFailed);
            GlobPDLineWiseShiftPatternCode = '';
        }

        // This function is used to show exception message when user enters Data for a particular employee
        function OnGetExceptionRecordsComplete(strResult) {
            var res1 = strResult;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");

            var l = 0;
            var strTable;

            var currentRowMessageId = "";
            var nextRowMessageId = "";

            var strExceptionLog = "";
            for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {
                var strExceptionMessage = "";
                try {
                    if (l == "0") {

                        document.getElementById('<%=lblMsgExceptionEmployeeNumber.ClientID %>').innerHTML = xmlDoc1.getElementsByTagName("EmployeeNumber")[l].firstChild.nodeValue;
                        document.getElementById('<%=lblMsgExceptionMaxToDate.ClientID %>').innerHTML = DateInFormat(document.getElementById('<%=HFMaxDate.ClientID %>').value);
                    }
                    if (xmlDoc1.getElementsByTagName("MessageID")[l].firstChild.nodeValue == xmlDoc1.getElementsByTagName("MessageID")[l + 1].firstChild.nodeValue) {
                        currentRowMessageId = (xmlDoc1.getElementsByTagName("MessageDesc")[l].firstChild.nodeValue);
                        nextRowMessageId = (xmlDoc1.getElementsByTagName("MessageDesc")[l + 1].firstChild.nodeValue);
                        strExceptionMessage = strExceptionMessage + currentRowMessageId + "," + nextRowMessageId;
                        l = l + 1;
                    }
                    else {
                        currentRowMessageId = (xmlDoc1.getElementsByTagName("MessageDesc")[l].firstChild.nodeValue) + ",";
                        strExceptionMessage = strExceptionMessage + currentRowMessageId;
                    }
                }
                catch (Error) {
                    currentRowMessageId = (xmlDoc1.getElementsByTagName("MessageDesc")[l].firstChild.nodeValue) + ",";
                    strExceptionMessage = strExceptionMessage + currentRowMessageId;
                }

                strExceptionLog = strExceptionLog + strExceptionMessage;
                l++;
            }
            document.getElementById('<%=lblMsgIDException.ClientID %>').innerHTML = "119";
            document.getElementById('<%=lblMsgException.ClientID %>').innerHTML = strExceptionLog;
            showExceptionMessage();

        }

        //===========================================
        //Function To Show the output After single Cell Insert
        //===========================================
        function OnInsertDataOfDateComplete(strOutPut) {
            document.getElementById('span2').innerHTML = "";
            document.getElementById('span2').innerHTML = strOutPut;

            var j = 0;
            try {
                document.getElementById(getClientId(GlobObject, "ImgbtnUpdateTran")).disabled = false;
            }
            catch (Error) {
            }

            var totalCount = document.getElementById('totalDuplicatedCount' + j).value;
            document.getElementById('btnOverWrite').style.display = 'none';
            document.getElementById('btnCheckAll').style.display = "none";
            document.getElementById('btnUnCheckAll').style.display = "none";
            if (document.getElementById('HFIsDuplicateExists0') == "[object]") {
                if (document.getElementById('HFIsDuplicateExists0').value == "1") {
                    document.getElementById('btnOverWrite').style.display = 'block';
                    document.getElementById('btnCheckAll').style.display = "block";
                }
                else {
                    document.getElementById('btnOverWrite').style.display = 'none';
                }
            }
            if (totalCount > 0) {


                document.getElementById('DIVMultipleOverwrite').style.display = "none";
                if (document.getElementById('lblMsgShiftDuplicate' + j) == '[object]') {
                    if (document.getElementById('lblMsgShiftDuplicate' + j).innerHTML == Duplicate || document.getElementById('lblMsgShiftDuplicate' + j).innerHTML == "WeekOffAndDutyConflict" || document.getElementById('lblMsgShiftDuplicate' + j).innerHTML == "not a prefered day") {
                        //if (document.getElementById('HFDuplicateErrorExists' + j).value == "100") {
                        document.getElementById('tr' + j).style.display = "block";
                        document.getElementById('DIVMultipleOverwrite').style.display = "block";
                        document.getElementById('btnOverWrite').style.display = "block";
                        document.getElementById('btnCheckAll').style.display = "block";
                        document.getElementById('btnUnCheckAll').style.display = "block";
                        if (globCopyStatus == "1") {
                            var columnIndexDuplicate;
                            var strReversedString = GlobEmployeeShiftCode.split('').reverse().join('');
                            columnIndexDuplicate = strReversedString.substring(0, 2);
                            if (isNaN(columnIndexDuplicate)) {
                                columnIndexDuplicate = strReversedString.substring(0, 1);
                            }
                            else {
                                columnIndexDuplicate = columnIndexDuplicate.toString().split('').reverse().join('');
                            }
                            columnIndexDuplicate = (parseInt(columnIndexDuplicate) + 1);
                            var strScheduleRosterAutoID = "HFSchRosterAutoID" + columnIndexDuplicate;
                            GlobEmployeeSchRosterAutoID = getClientId(GlobObject, strScheduleRosterAutoID);
                            document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = document.getElementById(GlobEmployeeSchRosterAutoID).value;

                        }

                    }
                    else if (document.getElementById('lblMsgShiftDuplicate' + j).innerHTML == 'WeekOffAndDutyConflicts') {
                        document.getElementById('tr' + j).style.display = "none";
                        document.getElementById('DIVMultipleOverwrite').style.display = "none";
                        ParentWindowFunction1();

                        return;
                    }
                    else if (document.getElementById('lblMsgShiftDuplicate' + j).innerHTML == "Insert") {
                        document.getElementById('<%=HFNewPDLineNo.ClientID %>').value = '';
                        document.getElementById('DIVMultipleOverwrite').style.display = "none";
                        document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = '';
                        try {


                            if (document.getElementById('lblInsertShiftCode' + j).innerHTML == '0') {
                                document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
                                document.getElementById('<%=btnProceed.ClientID %>').click();
                            }

                        }
                        catch (Error) { }

                        if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {
                            if (document.getElementById('HFOT' + j).value > 0) {
                                // 
                                OTReason('DT0002');
                            }
                        }

                        document.getElementById('tr' + j).style.display = "none";
                        document.getElementById('DIVMultipleOverwrite').style.display = "none";
                        try {

                            var columnIndex;
                            var strReversedString = GlobEmployeeShiftCode.split('').reverse().join('');
                            columnIndex = strReversedString.substring(0, 2);
                            if (isNaN(columnIndex)) {
                                columnIndex = strReversedString.substring(0, 1);
                            }
                            else {
                                columnIndex = columnIndex.toString().split('').reverse().join('');
                            }


                            if (globCopyStatus == "1") {

                                columnIndex = (parseInt(columnIndex) + 1);
                                var strEmpDetails = "lblDutyDate" + columnIndex;
                                GlobEmployeeDetails = getClientId(GlobObject, strEmpDetails);
                                var strShiftCode = "txtEmpShiftDutyDate" + columnIndex;
                                var strTimeFrom = "txtTimeFrom" + columnIndex;
                                var strTimeTo = "txtTimeTo" + columnIndex;
                                var strScheduleRosterAutoID = "HFSchRosterAutoID" + columnIndex;
                                GlobEmployeeShiftCode = getClientId(GlobObject, strShiftCode);
                                GlobEmployeeTimeFrom = getClientId(GlobObject, strTimeFrom);
                                GlobEmployeeTimeTo = getClientId(GlobObject, strTimeTo);
                                GlobEmployeeSchRosterAutoID = getClientId(GlobObject, strScheduleRosterAutoID);
                                document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = document.getElementById(GlobEmployeeSchRosterAutoID).value;

                            }
                            document.getElementById(GlobEmployeeShiftCode).value = document.getElementById('lblInsertShiftCode' + j).innerHTML;
                            document.getElementById(GlobEmployeeTimeFrom).value = document.getElementById('lblInsertTimeFrom' + j).innerHTML;
                            document.getElementById(GlobEmployeeTimeTo).value = document.getElementById('lblInsertTimeTo' + j).innerHTML;
                            document.getElementById(GlobEmployeeDetails).innerText = document.getElementById(GlobEmployeeTimeFrom).value + '-' + document.getElementById(GlobEmployeeTimeTo).value;
                            if (parseInt(columnIndex) == 1) {
                                document.getElementById('<%=HFChangedEmpDetail1.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            }
                            if (parseInt(columnIndex) == 2) {
                                document.getElementById('<%=HFChangedEmpDetail2.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            }
                            if (parseInt(columnIndex) == 3) {
                                document.getElementById('<%=HFChangedEmpDetail3.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            }
                            if (parseInt(columnIndex) == 4) {
                                document.getElementById('<%=HFChangedEmpDetail4.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            }
                            if (parseInt(columnIndex) == 5) {
                                document.getElementById('<%=HFChangedEmpDetail5.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            }
                            if (parseInt(columnIndex) == 6) {
                                document.getElementById('<%=HFChangedEmpDetail6.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            }
                            if (parseInt(columnIndex) == 7) {
                                document.getElementById('<%=HFChangedEmpDetail7.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            }
                            if (parseInt(columnIndex) == 8) {
                                document.getElementById('<%=HFChangedEmpDetail8.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            }
                            if (parseInt(columnIndex) == 9) {
                                document.getElementById('<%=HFChangedEmpDetail9.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            }
                            if (parseInt(columnIndex) == 10) {
                                document.getElementById('<%=HFChangedEmpDetail10.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            }
                            if (parseInt(columnIndex) == 11) {
                                document.getElementById('<%=HFChangedEmpDetail11.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            }
                            if (parseInt(columnIndex) == 12) {
                                document.getElementById('<%=HFChangedEmpDetail12.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            }
                            if (parseInt(columnIndex) == 13) {
                                document.getElementById('<%=HFChangedEmpDetail13.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            }
                            if (parseInt(columnIndex) == 14) {
                                document.getElementById('<%=HFChangedEmpDetail14.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            }
                            if (parseInt(columnIndex) == 15) {
                                document.getElementById('<%=HFChangedEmpDetail15.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            } if (parseInt(columnIndex) == 16) {
                                document.getElementById('<%=HFChangedEmpDetail16.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            } if (parseInt(columnIndex) == 17) {
                                document.getElementById('<%=HFChangedEmpDetail17.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            } if (parseInt(columnIndex) == 18) {
                                document.getElementById('<%=HFChangedEmpDetail18.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            } if (parseInt(columnIndex) == 19) {
                                document.getElementById('<%=HFChangedEmpDetail19.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            } if (parseInt(columnIndex) == 20) {
                                document.getElementById('<%=HFChangedEmpDetail20.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            } if (parseInt(columnIndex) == 21) {
                                document.getElementById('<%=HFChangedEmpDetail21.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            } if (parseInt(columnIndex) == 22) {
                                document.getElementById('<%=HFChangedEmpDetail22.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            } if (parseInt(columnIndex) == 23) {
                                document.getElementById('<%=HFChangedEmpDetail23.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            } if (parseInt(columnIndex) == 24) {
                                document.getElementById('<%=HFChangedEmpDetail24.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            } if (parseInt(columnIndex) == 25) {
                                document.getElementById('<%=HFChangedEmpDetail25.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            } if (parseInt(columnIndex) == 26) {
                                document.getElementById('<%=HFChangedEmpDetail26.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            } if (parseInt(columnIndex) == 27) {
                                document.getElementById('<%=HFChangedEmpDetail27.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            } if (parseInt(columnIndex) == 28) {
                                document.getElementById('<%=HFChangedEmpDetail28.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            }
                            if (parseInt(columnIndex) == 29) {
                                document.getElementById('<%=HFChangedEmpDetail29.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            } if (parseInt(columnIndex) == 30) {
                                document.getElementById('<%=HFChangedEmpDetail30.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            }
                            if (parseInt(columnIndex) == 31) {
                                document.getElementById('<%=HFChangedEmpDetail31.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                            }
                            if ((parseInt(columnIndex) + 1) < 33) {
                                if (globCopyStatus == "1") {

                                    columnIndex = (parseInt(columnIndex) - 1);
                                }

                                var strShiftCode = "txtEmpShiftDutyDate" + (parseInt(columnIndex) + 1);
                                // if (document.getElementById('<%=ddlScheduleType.ClientID %>').value != "Daily") {
                                document.getElementById(getClientId(GlobObject, strShiftCode)).focus();
                                //}
                            }
                            if (document.getElementById(GlobEmployeeSchRosterAutoID) == "[object]") {

                                document.getElementById(GlobEmployeeSchRosterAutoID).value = document.getElementById('lblScheduleRosterAutoID' + j).innerHTML;
                            }
                            if (document.getElementById(GlobEmployeeDesgCode) == "[object]") {
                                document.getElementById(GlobEmployeeDesgCode).value = document.getElementById('<%=HFNewDesignationCode.ClientID %>').value;
                            }

                            //                            if (document.getElementById('<%=ddlScheduleType.ClientID %>').value == "Daily") {
                            //                                var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
                            //                                try {
                            //                                    var rowClientId = gvScheduleRoster.rows[parseInt(document.getElementById('<%=HFRowIndex.ClientID %>').value) + 2].cells[0].childNodes[0];
                            //                                    var strEmployee = "txtEmpNumberDutyDate";
                            //                                    document.getElementById(getClientId(rowClientId, strEmployee)).focus();
                            //                                }
                            //                                catch (Error) {
                            //                                    document.getElementById('<%=HFColumnIndex.ClientID %>').value = "1";
                            //                                    document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
                            //                                    document.getElementById('<%=btnProceed.ClientID %>').click();
                            //                                }

                            //                            }


                        }
                        catch (Error) { }

                        // Code to show Exceptions
                        if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Sch') {
                            showExceptionMessage();
                            // Code to show Exceptions
                        }

                        // if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Sch') {

                        GetReqSch();
                        //}
                    }
                    else if (document.getElementById('lblMsgShiftDuplicate' + j).innerHTML == Converted) {
                        document.getElementById('tr' + j).style.display = "block";
                        document.getElementById('DIVMultipleOverwrite').style.display = "block";
                        document.getElementById('btnOverWrite').style.display = "none";
                        document.getElementById('btnCheckAll').style.display = "none";
                        document.getElementById('btnUnCheckAll').style.display = "none";

                    }
                    else if (document.getElementById('lblMsgShiftDuplicate' + j).innerHTML == ErrorMessage) {
                        document.getElementById('tr' + j).style.display = "block";

                        document.getElementById('btnOverWrite').style.display = "none";
                        document.getElementById('btnCheckAll').style.display = "none";
                        document.getElementById('btnUnCheckAll').style.display = "none";
                    }
                    else if (document.getElementById('lblMsgShiftDuplicate' + j).innerHTML == Leave) {
                        document.getElementById('DIVMultipleOverwrite').style.display = "block";
                        document.getElementById('btnOverWrite').style.display = "none";
                        document.getElementById('btnCheckAll').style.display = "none";
                        document.getElementById('btnUnCheckAll').style.display = "none";


                    }
                    else {
                        document.getElementById('DIVMultipleOverwrite').style.display = "block";
                        document.getElementById('btnOverWrite').style.display = "none";
                        document.getElementById('btnCheckAll').style.display = "none";
                        document.getElementById('btnUnCheckAll').style.display = "none";

                    }
                }

            }

        }
        // This function is used to called after record has been deleted from gridview
        function OnDeleteRecordsComplete(strOutput) {
            if (document.getElementById('<%=HFPost.ClientID %>').value == '') {
                document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
            }

            var arrsplit = new Array;
            arrsplit = strOutput.split(",");
            if (arrsplit[0] == "2") {

                alert(AuthorizedRotaCannotbeDeleted);
                LoadingComplete();
                return false;
            }

            /* ================================================================================================*/

            try {
                var columnIndex;
                var strReversedString = GlobEmployeeShiftCode.split('').reverse().join('');
                columnIndex = strReversedString.substring(0, 2);
                if (isNaN(columnIndex)) {
                    columnIndex = strReversedString.substring(0, 1);
                }
                else {
                    columnIndex = columnIndex.toString().split('').reverse().join('');
                }


                var strEmpDetails = "lblDutyDate" + columnIndex;
                GlobEmployeeDetails = getClientId(GlobObject, strEmpDetails);
                var strShiftCode = "txtEmpShiftDutyDate" + columnIndex;
                var strTimeFrom = "txtTimeFrom" + columnIndex;
                var strTimeTo = "txtTimeTo" + columnIndex;
                var strScheduleRosterAutoID = "HFSchRosterAutoID" + columnIndex;
                GlobEmployeeShiftCode = getClientId(GlobObject, strShiftCode);
                GlobEmployeeTimeFrom = getClientId(GlobObject, strTimeFrom);
                GlobEmployeeTimeTo = getClientId(GlobObject, strTimeTo);
                GlobEmployeeSchRosterAutoID = getClientId(GlobObject, strScheduleRosterAutoID);
                document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = "";
                document.getElementById(GlobEmployeeSchRosterAutoID).value = "";
                document.getElementById(GlobEmployeeShiftCode).value = "";
                document.getElementById(GlobEmployeeTimeFrom).value = "";
                document.getElementById(GlobEmployeeTimeTo).value = "";
                document.getElementById(GlobEmployeeDetails).innerText = "";
                if (parseInt(columnIndex) == 1) {
                    document.getElementById('<%=HFChangedEmpDetail1.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                }
                if (parseInt(columnIndex) == 2) {
                    document.getElementById('<%=HFChangedEmpDetail2.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                }
                if (parseInt(columnIndex) == 3) {
                    document.getElementById('<%=HFChangedEmpDetail3.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                }
                if (parseInt(columnIndex) == 4) {
                    document.getElementById('<%=HFChangedEmpDetail4.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                }
                if (parseInt(columnIndex) == 5) {
                    document.getElementById('<%=HFChangedEmpDetail5.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                }
                if (parseInt(columnIndex) == 6) {
                    document.getElementById('<%=HFChangedEmpDetail6.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                }
                if (parseInt(columnIndex) == 7) {
                    document.getElementById('<%=HFChangedEmpDetail7.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                }
                if (parseInt(columnIndex) == 8) {
                    document.getElementById('<%=HFChangedEmpDetail8.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                }
                if (parseInt(columnIndex) == 9) {
                    document.getElementById('<%=HFChangedEmpDetail9.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                }
                if (parseInt(columnIndex) == 10) {
                    document.getElementById('<%=HFChangedEmpDetail10.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                }
                if (parseInt(columnIndex) == 11) {
                    document.getElementById('<%=HFChangedEmpDetail11.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                }
                if (parseInt(columnIndex) == 12) {
                    document.getElementById('<%=HFChangedEmpDetail12.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                }
                if (parseInt(columnIndex) == 13) {
                    document.getElementById('<%=HFChangedEmpDetail13.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                }
                if (parseInt(columnIndex) == 14) {
                    document.getElementById('<%=HFChangedEmpDetail14.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                }
                if (parseInt(columnIndex) == 15) {
                    document.getElementById('<%=HFChangedEmpDetail15.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                } if (parseInt(columnIndex) == 16) {
                    document.getElementById('<%=HFChangedEmpDetail16.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                } if (parseInt(columnIndex) == 17) {
                    document.getElementById('<%=HFChangedEmpDetail17.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                } if (parseInt(columnIndex) == 18) {
                    document.getElementById('<%=HFChangedEmpDetail18.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                } if (parseInt(columnIndex) == 19) {
                    document.getElementById('<%=HFChangedEmpDetail19.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                } if (parseInt(columnIndex) == 20) {
                    document.getElementById('<%=HFChangedEmpDetail20.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                } if (parseInt(columnIndex) == 21) {
                    document.getElementById('<%=HFChangedEmpDetail21.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                } if (parseInt(columnIndex) == 22) {
                    document.getElementById('<%=HFChangedEmpDetail22.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                } if (parseInt(columnIndex) == 23) {
                    document.getElementById('<%=HFChangedEmpDetail23.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                } if (parseInt(columnIndex) == 24) {
                    document.getElementById('<%=HFChangedEmpDetail24.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                } if (parseInt(columnIndex) == 25) {
                    document.getElementById('<%=HFChangedEmpDetail25.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                } if (parseInt(columnIndex) == 26) {
                    document.getElementById('<%=HFChangedEmpDetail26.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                } if (parseInt(columnIndex) == 27) {
                    document.getElementById('<%=HFChangedEmpDetail27.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                } if (parseInt(columnIndex) == 28) {
                    document.getElementById('<%=HFChangedEmpDetail28.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                }
                if (parseInt(columnIndex) == 29) {
                    document.getElementById('<%=HFChangedEmpDetail29.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                } if (parseInt(columnIndex) == 30) {
                    document.getElementById('<%=HFChangedEmpDetail30.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                }
                if (parseInt(columnIndex) == 31) {
                    document.getElementById('<%=HFChangedEmpDetail31.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText;
                }
                if ((parseInt(columnIndex) + 1) < 33) {
                    if (globCopyStatus == "1") {

                        columnIndex = (parseInt(columnIndex));
                    }

                    var strShiftCode = "txtEmpShiftDutyDate" + (parseInt(columnIndex));
                    // if (document.getElementById('<%=ddlScheduleType.ClientID %>').value != "Daily") {
                    document.getElementById(getClientId(GlobObject, strShiftCode)).focus();
                    //}

                }
                //if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Sch') {

                GetReqSch();
                //}
            }
            catch (Error) {

                document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
                document.getElementById('<%=btnProceed.ClientID %>').click();
            }

            /* ================================================================================================*/




            if (document.getElementById(GlobShiftPatternCode) == "[object]") {
                document.getElementById(GlobShiftPatternCode).disabled = false;
            }
            document.getElementById('divShift').style.display = "none";
            // alert(strOutput);
            document.getElementById('divEmployeeContainer').style.display = "none";
            //// GetReqSch();

            LoadingComplete();
        }
        //============================
        //Function Used to Get The Client ID Of Control
        //=======================================
        function getClientId(obj, cId) {
            var arr = new Array;
            var clId = "";  // clientId
            arr = obj.id.split("_");
            for (i = 0; i < arr.length - 1; i++) {
                clId = clId + arr[i] + "_";
            }
            clId = clId + cId;
            return clId;
        }
        //OT Reason   On 30-05-2012
        function OTReason(DutyType) {
            var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
            var RowClientID = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var ColumnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var SchRosterAutoID = "HFSchRosterAutoID" + ColumnIndex;
            var AsmtCode = document.getElementById('<% =txtAsmtCode.ClientID %>').value;
            var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
            var ClientCode = document.getElementById('<% =txtClientCode.ClientID %>').value;
            var cellScheduleRosterAutoID = document.getElementById(getClientId(RowClientID, SchRosterAutoID)).value;

            if (document.getElementById('ddlAttendanceType').value == 'Act') {
                if (document.getElementById('HFOTReason').value == '1') {
                    if (cellScheduleRosterAutoID != '') {
                        var strPageName = "../Transactions/OTReaasonTransaction.aspx?ScheduleRosterAutoID=" + cellScheduleRosterAutoID + "&AttendanceType=" + document.getElementById('<%=ddlAttendanceType.ClientID %>').value + "&ClientCode=" + ClientCode + "&AsmtCode=" + AsmtCode + "&strPost=" + strPost;
                        var FrmChild = window.showModalDialog(strPageName, null, 'status:off;center:yes;scroll:no;dialogWidth:1000px;dialogHeight:550px;');
                        if (FrmChild == "1") {
                            ParentWindowFunction1()
                        }
                    }
                }
            }
            else {
                ChangeDutyType(DutyType);
            }
        }
        //=======================================
        // Function Called to lock employee schedule
        //=======================================
        function LockScheduleEmpWise() {

            WebMethods.LockSchedule(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById('<% =txtClientCode.ClientID %>').value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, document.getElementById('<%=ddlPost.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), SessionLocationAutoId, SessionUserId, OnLockScheduleComplete, OnWSRequestFailed);
        }
        function OnLockScheduleComplete(result) {
            document.getElementById('<% =lblErrorMsg.ClientID %>').innerHTML = result;

            if (document.getElementById('<%=HFPost.ClientID %>').value == '') {
                document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
            }

            if (document.getElementById('<% =lblErrorMsg.ClientID %>').innerHTML == MsgSuccessfullyLocked) {

                document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
                document.getElementById('<%=btnProceed.ClientID %>').click();
            }
            LoadingComplete();
        }
        // this function is called when any key down event is done on gridview controls
        function FunctionCallOnKeyDown(elName, obj) {

            if (document.getElementById(GlobObjTofade) == '[object]') {
                var fadeobjjobBreakDown = document.getElementById(GlobObjTofade);
                if (fadeobjjobBreakDown.style.display == 'block') {
                    fadeobjjobBreakDown.style.display = 'none';
                    document.getElementById('HFJobBreakDownSchRosterAutoID').value = '';
                }
            }
            var columnIndex;
            GlobObject = obj;
            document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
            if (document.getElementById('<%=ddlPost.ClientID %>').selectedIndex != -1) {
                document.getElementById('<%=HFPostText.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').options[document.getElementById('<%=ddlPost.ClientID %>').selectedIndex].text;
            }
            if (window.event.keyCode == 9) {
                if (document.getElementById('divShift') == "[object]") {
                    if (document.getElementById('divShift').style.display != "none") {
                        document.getElementById('divShift').style.display = "none";
                    }
                }
            }
            if (window.event.keyCode == 46) {
                document.getElementById('divEmployeeContainer').style.display = "none";

            }

            var strReversedString = obj.id.split('').reverse().join('');
            columnIndex = strReversedString.substring(0, 2);
            if (isNaN(columnIndex)) {
                columnIndex = strReversedString.substring(0, 1);
            }
            else {
                columnIndex = columnIndex.toString().split('').reverse().join('');
            }
            document.getElementById('<%=HFEditColumnIndex.ClientID %>').value = columnIndex;
            var strDutyDate = "lblHeaderDutyDate" + columnIndex;
            var strEmpNumber = "txtEmpNumberDutyDate";
            var dutyDate = 'gvScheduleRoster_ctl01_' + strDutyDate;
            GlobEmployeeDutyDate = dutyDate;
            var strEmployeeName = "txtEmpNameDutyDate";
            var strEmpDesignationDesc = "txtEmpDesignationDesc";
            var strDesignationCode = "HFDesignationCode";
            GlobEmployeeDesgCode = getClientId(obj, strDesignationCode);
            GlobRowNumber = getClientId(obj, "lblRowID");
            if (document.getElementById(globBorrowedEmployeeStatus) == "[object]") {

                document.getElementById(globBorrowedEmployeeStatus).value = "";
            }
            globBorrowedEmployeeStatus = getClientId(obj, "hfBorrowedEmployeeStatus");
            var strSerialNumber = getClientId(obj, "lblSerialNumber");
            try {
                document.getElementById('<%=HFRowIndex.ClientID %>').value = parseInt(document.getElementById(strSerialNumber).innerText) - 1;
                document.getElementById(getClientId(obj, "ImgbtnUpdateTran")).disabled = true;
            }
            catch (Error) {
            }
            document.getElementById('<%=HFNewDesignationCode.ClientID %>').value = document.getElementById(GlobEmployeeDesgCode).value;
            document.getElementById(GlobEmployeeDesgCode).value = document.getElementById('<%=HFNewDesignationCode.ClientID %>').value;
            GlobEmployeeNumber = getClientId(obj, strEmpNumber);
            document.getElementById('<%=HFNewEmployeeNumber.ClientID %>').value = document.getElementById(GlobEmployeeNumber).value;
            document.getElementById(GlobEmployeeNumber).value = document.getElementById('<%=HFNewEmployeeNumber.ClientID %>').value;
            var strDefaultSite = "CBIsDefaultSite";
            var strShiftPatternCode = "txtShiftPatternCode";
            var strPatternPosition = "txtPatternPosition";
            GlobDefaultSite = getClientId(obj, strDefaultSite);
            GlobShiftPatternCode = getClientId(obj, strShiftPatternCode);
            GlobPatternPosition = getClientId(obj, strPatternPosition);

            if (document.getElementById(GlobShiftPatternCode).value == "") {
                document.getElementById(GlobShiftPatternCode).value = '';
            }
            GlobPDLineWiseShiftPatternCode = document.getElementById(GlobShiftPatternCode).value
            var strScreenType;
            if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {
                strScreenType = 'ACT';
            }
            else {
                strScreenType = 'SCH';
            }
            var strShiftCode = "txtEmpShiftDutyDate" + columnIndex;
            var strTimeFrom = "txtTimeFrom" + columnIndex;
            var strTimeTo = "txtTimeTo" + columnIndex;
            var strPdLineNo = "HFPDLineNo" + columnIndex;
            var strScheduleRosterAutoID = "HFSchRosterAutoID" + columnIndex;
            GlobEmployeeName = getClientId(obj, strEmployeeName);
            GlobEmployeeDesgDesc = getClientId(obj, strEmpDesignationDesc);
            GlobEmployeeShiftCode = getClientId(obj, strShiftCode);
            GlobEmployeeTimeFrom = getClientId(obj, strTimeFrom);
            GlobEmployeeTimeTo = getClientId(obj, strTimeTo);
            GlobPDLineNo = getClientId(obj, strPdLineNo);
            GlobEmployeeSchRosterAutoID = getClientId(obj, strScheduleRosterAutoID);

            switch (elName) {

                case "TimeFrom":
                    if (window.event.keyCode == 9) {
                        IsValidTime(obj, 'F');
                    }

                    if (window.event.keyCode == 13) //select
                    {
                        var strEmpDetails = "lblDutyDate" + columnIndex;
                        GlobEmployeeDetails = getClientId(obj, strEmpDetails);
                        document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = document.getElementById(GlobEmployeeSchRosterAutoID).value;
                        document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value = document.getElementById(GlobEmployeeShiftCode).value;

                        var ReturnValue = IsValidTime(obj, 'F');
                        if (ReturnValue) {
                            document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = document.getElementById(GlobEmployeeTimeFrom).value;
                            document.getElementById('<%=HFNewTimeTo.ClientID %>').value = document.getElementById(GlobEmployeeTimeTo).value;
                            var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                            //Added Area ID option to search only those employee that belongs to that Area
                            LoadingStart();
                            WebMethods.GetEmployeeDetail(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById(GlobEmployeeNumber).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById(dutyDate).innerText), DateInFormat(document.getElementById(dutyDate).innerText), strPost, 'SINGLE', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType, SessionCompanyCode, SessionHrLocationCode, SessionLocationAutoId, SessionUserId, OnGetEmployeeDetailComplete, OnWSRequestFailed);
                            return;
                        }
                    }

                    if (window.event.keyCode == 45) { // Insert Key Pressed to copy to next day
                        var nextColumnIndex = parseInt(columnIndex) + 1;
                        var nextShiftCode = "txtEmpShiftDutyDate" + nextColumnIndex;

                        if (document.getElementById(getClientId(obj, nextShiftCode)) != "[object]") {
                            return;
                        }
                        if (document.getElementById(getClientId(obj, nextShiftCode)).disabled == true) {
                            return;
                        }
                        var strEmpDetails = "lblDutyDate" + columnIndex;
                        GlobEmployeeDetails = getClientId(obj, strEmpDetails);
                        document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = document.getElementById(GlobEmployeeSchRosterAutoID).value;
                        document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value = document.getElementById(GlobEmployeeShiftCode).value;

                        document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = document.getElementById(GlobEmployeeTimeFrom).value;
                        document.getElementById('<%=HFNewTimeTo.ClientID %>').value = document.getElementById(GlobEmployeeTimeTo).value;
                        var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                        document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = document.getElementById(GlobEmployeeTimeFrom).value;
                        document.getElementById('<%=HFNewTimeTo.ClientID %>').value = document.getElementById(GlobEmployeeTimeTo).value;
                        LoadingStart();

                        WebMethods.GetEmployeeDetail(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById(GlobEmployeeNumber).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById(dutyDate).innerText), DateInFormat(document.getElementById(dutyDate).innerText), strPost, 'COPY', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType, SessionCompanyCode, SessionHrLocationCode, SessionLocationAutoId, SessionUserId, OnGetEmployeeDetailComplete, OnWSRequestFailed);
                        return;
                    }

                    break;

                case "TimeTo":
                    if (window.event.keyCode == 9) {
                        IsValidTime(obj, 'T');
                    }
                    if (window.event.keyCode == 13) //select
                    {
                        var strEmpDetails = "lblDutyDate" + columnIndex;
                        GlobEmployeeDetails = getClientId(obj, strEmpDetails);
                        document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = document.getElementById(GlobEmployeeSchRosterAutoID).value;
                        document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value = document.getElementById(GlobEmployeeShiftCode).value;

                        var ReturnValue = IsValidTime(obj, 'T');
                        if (ReturnValue) {
                            document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = document.getElementById(GlobEmployeeTimeFrom).value;
                            document.getElementById('<%=HFNewTimeTo.ClientID %>').value = document.getElementById(GlobEmployeeTimeTo).value;
                            var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                            //Added Area ID option to search only those employee that belongs to that Area
                            LoadingStart();
                            WebMethods.GetEmployeeDetail(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById(GlobEmployeeNumber).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById(dutyDate).innerText), DateInFormat(document.getElementById(dutyDate).innerText), strPost, 'SINGLE', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType, SessionCompanyCode, SessionHrLocationCode, SessionLocationAutoId, SessionUserId, OnGetEmployeeDetailComplete, OnWSRequestFailed);
                            return;
                        }
                    }

                    if (window.event.keyCode == 45) { // Insert Key Pressed to copy to next day

                        var nextColumnIndex = parseInt(columnIndex) + 1;
                        var nextShiftCode = "txtEmpShiftDutyDate" + nextColumnIndex;

                        if (document.getElementById(getClientId(obj, nextShiftCode)) != "[object]") {
                            return;
                        }
                        if (document.getElementById(getClientId(obj, nextShiftCode)).disabled == true) {
                            return;
                        }

                        var strEmpDetails = "lblDutyDate" + columnIndex;
                        GlobEmployeeDetails = getClientId(obj, strEmpDetails);
                        document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = document.getElementById(GlobEmployeeSchRosterAutoID).value;
                        document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value = document.getElementById(GlobEmployeeShiftCode).value;

                        document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = document.getElementById(GlobEmployeeTimeFrom).value;
                        document.getElementById('<%=HFNewTimeTo.ClientID %>').value = document.getElementById(GlobEmployeeTimeTo).value;
                        var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                        document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = document.getElementById(GlobEmployeeTimeFrom).value;
                        document.getElementById('<%=HFNewTimeTo.ClientID %>').value = document.getElementById(GlobEmployeeTimeTo).value;
                        LoadingStart();


                        WebMethods.GetEmployeeDetail(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById(GlobEmployeeNumber).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById(dutyDate).innerText), DateInFormat(document.getElementById(dutyDate).innerText), strPost, 'COPY', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType, SessionCompanyCode, SessionHrLocationCode, SessionLocationAutoId, SessionUserId, OnGetEmployeeDetailComplete, OnWSRequestFailed);
                        return;
                    }
                    break;
                case "ShiftCode":
                    if (window.event.keyCode == 46) {  //delete Key Pressed
                        var strScheduleRosterAutoID = "HFSchRosterAutoID" + columnIndex;
                        GlobEmployeeSchRosterAutoID = getClientId(obj, strScheduleRosterAutoID);

                        document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = document.getElementById(GlobEmployeeSchRosterAutoID).value;
                        if (document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value != "0") {

                            var SchRosterAutoID = document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value;

                            var fromDate = DateInFormat(document.getElementById(dutyDate).innerText)
                            var maxDate = DateInFormat(document.getElementById(dutyDate).innerText)
                            var employeeNumber = document.getElementById(GlobEmployeeNumber).value;
                            var patternPosition = "txtPatternPosition";
                            var strPatternPosition = getClientId(obj, patternPosition);
                            // DeleteSchedule(SchRosterAutoID, document.getElementById(GlobRowNumber).innerText, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, DateInFormat(document.getElementById(dutyDate).innerText), document.getElementById(GlobEmployeeNumber).value, document.getElementById('<%=txtAsmtCode.ClientID %>').value);
                            LoadingStart();

                            var returnValue = confirm(MsgConfirmDelete);
                            if (returnValue) {
                                WebMethods.DeleteSchedule(document.getElementById('<%= HidCon.ClientID %>').value, SchRosterAutoID, employeeNumber, fromDate, maxDate, document.getElementById('<%=txtAsmtCode.ClientID %>').value, document.getElementById(GlobShiftPatternCode).value, document.getElementById(strPatternPosition).value, document.getElementById(GlobRowNumber).innerText, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, OnDeleteRecordsComplete, OnWSRequestFailed);

                            }
                            else {
                                LoadingComplete();
                            }


                        }
                    }
                    if (window.event.keyCode == 45) { // Insert Key Pressed to copy to next day
                        var nextColumnIndex = parseInt(columnIndex) + 1;
                        var nextShiftCode = "txtEmpShiftDutyDate" + nextColumnIndex;

                        if (document.getElementById(getClientId(obj, nextShiftCode)) != "[object]") {
                            return;
                        }
                        if (document.getElementById(getClientId(obj, nextShiftCode)).disabled == true) {
                            return;
                        }
                        var strEmpDetails = "lblDutyDate" + columnIndex;
                        GlobEmployeeDetails = getClientId(obj, strEmpDetails);
                        document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = document.getElementById(GlobEmployeeSchRosterAutoID).value;
                        document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value = document.getElementById(GlobEmployeeShiftCode).value;

                        document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = document.getElementById(GlobEmployeeTimeFrom).value;
                        document.getElementById('<%=HFNewTimeTo.ClientID %>').value = document.getElementById(GlobEmployeeTimeTo).value;
                        var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                        document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = document.getElementById(GlobEmployeeTimeFrom).value;
                        document.getElementById('<%=HFNewTimeTo.ClientID %>').value = document.getElementById(GlobEmployeeTimeTo).value;
                        LoadingStart();

                        WebMethods.GetEmployeeDetail(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById(GlobEmployeeNumber).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById(dutyDate).innerText), DateInFormat(document.getElementById(dutyDate).innerText), strPost, 'COPY', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType, SessionCompanyCode, SessionHrLocationCode, SessionLocationAutoId, SessionUserId, OnGetEmployeeDetailComplete, OnWSRequestFailed);
                        return;
                    }
                    if (window.event.keyCode == 13) //select
                    {
                        var strEmpDetails = "lblDutyDate" + columnIndex;
                        GlobEmployeeDetails = getClientId(obj, strEmpDetails);
                        document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = document.getElementById(GlobEmployeeSchRosterAutoID).value;
                        document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value = document.getElementById(GlobEmployeeShiftCode).value;

                        document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = document.getElementById(GlobEmployeeTimeFrom).value;
                        document.getElementById('<%=HFNewTimeTo.ClientID %>').value = document.getElementById(GlobEmployeeTimeTo).value;
                        var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                        document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = document.getElementById(GlobEmployeeTimeFrom).value;
                        document.getElementById('<%=HFNewTimeTo.ClientID %>').value = document.getElementById(GlobEmployeeTimeTo).value;
                        LoadingStart();

                        WebMethods.GetEmployeeDetail(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById(GlobEmployeeNumber).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById(dutyDate).innerText), DateInFormat(document.getElementById(dutyDate).innerText), strPost, 'SINGLE', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType, SessionCompanyCode, SessionHrLocationCode, SessionLocationAutoId, SessionUserId, OnGetEmployeeDetailComplete, OnWSRequestFailed);
                        return;
                    }
                    if (window.event.keyCode == 9) {

                    }
                    break;
                case "ShiftPatternCode":

                    if (window.event.keyCode == 40) {  //Down Key Pressed
                        //   document.getElementById(KeyNavigation(obj, "DOWN")).select();
                        return;
                    }
                    else if (window.event.keyCode == 38) //Up key movement
                    {
                        //document.getElementById(KeyNavigation(obj, "UP")).select();
                        return;
                    }
                    else if (window.event.keyCode == 37) //Left key movement
                    {
                        document.getElementById(GlobPatternPosition).select();
                        return;
                    }
                    //                    else if (window.event.keyCode == 39) //Right key movement
                    //                    {
                    //                        document.getElementById('<%=HFColumnIndex.ClientID %>').value = 2;
                    //                        document.getElementById('<%=btnEditMode.ClientID %>').click();
                    //                    }
                    if (window.event.keyCode == 13) {  //Enter Key Pressed

                        if (document.getElementById(GlobShiftPatternCode).value == '') {
                            document.getElementById(GlobDefaultSite).checked = false;
                        }
                        else {
                            document.getElementById(GlobDefaultSite).checked = true;
                        }
                        document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = "";
                        SaveDataPatternWise(obj);
                    }
                    break;

                case "PatternPosition":

                    if (window.event.keyCode == 40) {  //Down Key Pressed
                        //document.getElementById(KeyNavigation(obj, "DOWN")).select();
                        return;
                    }
                    else if (window.event.keyCode == 38) //Up key movement
                    {
                        //document.getElementById(KeyNavigation(obj, "UP")).select();
                        return;
                    }
                    else if (window.event.keyCode == 37) //Left key movement
                    {
                        document.getElementById(getClientId(obj, strEmployeeName)).select();
                        return;
                    }
                    else if (window.event.keyCode == 39) //Right key movement
                    {
                        document.getElementById(GlobShiftPatternCode).select();
                        return;
                    }

                    break;
                case "EmployeeName":

                    if (window.event.keyCode == 40) {  //Down Key Pressed
                        //document.getElementById(KeyNavigation(obj, "DOWN")).select();
                        return;
                    }
                    else if (window.event.keyCode == 38) //Up key movement
                    {
                        //document.getElementById(KeyNavigation(obj, "UP")).select();
                        return;
                    }
                    //                    else if (window.event.keyCode == 37) //Left key movement
                    //                    {
                    //                        document.getElementById(GlobEmployeeNumber).select();
                    //                        return;
                    //                    }
                    //                    else if (window.event.keyCode == 39) //Right key movement
                    //                    {
                    //                        document.getElementById(GlobPatternPosition).select();
                    //                        return;
                    //                    }

                    break;
                case "EmployeeNumber":
                    if (window.event.keyCode == 40) {  //Down Key Pressed
                        document.getElementById(KeyNavigation(obj, "DOWN")).select();
                        return;
                    }
                    else if (window.event.keyCode == 38) //Up key movement
                    {
                        document.getElementById(KeyNavigation(obj, "UP")).select();
                        return;
                    }
                    else if (window.event.keyCode == 39) //Right key movement
                    {
                        document.getElementById(GlobPatternPosition).select();
                        return;
                    }
                    if (window.event.keyCode == 120) {

                        if (document.getElementById(GlobEmployeeNumber).value == '') {
                            GlobEmployeeNumber = getClientId(obj, strEmpNumber);
                            GlobEmployeeName = getClientId(obj, strEmployeeName);
                            GlobEmployeeDesgDesc = getClientId(obj, strEmpDesignationDesc);
                            GetUnSchEmp(GlobEmployeeNumber);
                            return;
                        }
                        else {
                            GetUnSchEmp('');
                        }
                    }
                    if (window.event.keyCode == 40) {

                        if (document.getElementById('divEmployeeContainer').style.display != "none") {
                            if (document.getElementById('<%= LBEmployeeList.ClientID %>').selectedIndex > 0) {
                                document.getElementById('<%= LBEmployeeList.ClientID %>').selectedIndex = document.getElementById('<%= LBEmployeeList.ClientID %>').selectedIndex - 1;
                            }
                            GlobEmployeeNumber = obj.id;
                            document.getElementById('<%= LBEmployeeList.ClientID %>').focus();
                        }

                    }
                    else if (window.event.keyCode == 13) //select
                    {

                        GlobEmployeeName = getClientId(obj, strEmployeeName);
                        GlobEmployeeDesgDesc = getClientId(obj, strEmpDesignationDesc);
                        var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                        //Added Area ID option to search only those employee that belongs to that Area
                        LoadingStart();
                        WebMethods.GetEmployeeDetail(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById(GlobEmployeeNumber).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<%=HFToDate.ClientID %>').value), strPost, 'EmployeeNumber', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType, SessionCompanyCode, SessionHrLocationCode, SessionLocationAutoId, SessionUserId, OnGetEmployeeDetailComplete, OnWSRequestFailed);


                        return;
                    }
                    else if (window.event.keyCode == 46) {  //delete Key Pressed
                        var strSchRosterAutoId = '';
                        var fromDate = DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value);
                        var maxDate = DateInFormat(document.getElementById('<%=HFMaxDate.ClientID %>').value);
                        var employeeNumber = document.getElementById(GlobEmployeeNumber).value;
                        var patternPosition = "txtPatternPosition";
                        var strPatternPosition = getClientId(obj, patternPosition);
                        if (employeeNumber != "") {
                            LoadingStart();
                            WebMethods.DeleteSchedule(document.getElementById('<%= HidCon.ClientID %>').value, 0, employeeNumber, fromDate, maxDate, document.getElementById('<%=txtAsmtCode.ClientID %>').value, document.getElementById(GlobShiftPatternCode).value, document.getElementById(strPatternPosition).value, document.getElementById(GlobRowNumber).innerText, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, OnDeleteRecordsComplete, OnWSRequestFailed);
                        }
                    }
                    else if (window.event.keyCode == 16) //select
                    {
                        obj.select();
                        return;
                    }
                    else if (window.event.keyCode == 9) {
                        GlobEmployeeName = getClientId(obj, strEmployeeName);
                        GlobEmployeeDesgDesc = getClientId(obj, strEmpDesignationDesc);
                        if (document.getElementById(GlobEmployeeNumber).value != "") {
                            var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                            //Added Area ID option to search only those employee that belongs to that Area
                            LoadingStart();
                            WebMethods.GetEmployeeDetail(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById(GlobEmployeeNumber).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<%=HFToDate.ClientID %>').value), strPost, 'GETEMP', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType, SessionCompanyCode, SessionHrLocationCode, SessionLocationAutoId, SessionUserId, OnGetEmployeeDetailComplete, OnWSRequestFailed);
                        }
                    }
                    else {
                        return;
                    }
                default:

                    break;
            }
        }
        // This function is called when enter key is pressed on the Shift PatternCode/Shift PatternCode Sequence
        function SaveDataPatternWise(obj) {
            var list = document.getElementById('<% =LBShiftPatterns.ClientID %>');
            for (var i = 0; i < list.options.length; ++i) {
                if (list.options[i].text.toLowerCase() == document.getElementById(GlobShiftPatternCode).value.toLowerCase()) {
                    GlobPDLineWiseShiftPatternCode = list.options[i].value;
                    break;
                }
                else {
                    GlobPDLineWiseShiftPatternCode = "";
                }
            }
            if (GlobPDLineWiseShiftPatternCode != "") {

                var soRank = 'A-Site1-SGS';
                if (document.getElementById('<%=HFNewEmployeeNumber.ClientID %>').value != "") {
                    var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;

                    if (document.getElementById(GlobEmployeeDesgCode).value != "") {
                        LoadingStart();
                        WebMethods.InsertData(document.getElementById('<%= HidCon.ClientID %>').value, SessionLocationAutoId, document.getElementById('<%=txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<%=HFMaxDate.ClientID %>').value), document.getElementById('<%=HFNewEmployeeNumber.ClientID %>').value, document.getElementById(GlobShiftPatternCode).value, document.getElementById(GlobPatternPosition).value, document.getElementById(GlobRowNumber).innerText, strPost, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, document.getElementById('<%=ddlWeek.ClientID %>').value, document.getElementById('<%=HFCurrentSessionID.ClientID %>').value, SessionUserId, OnInsertRecordsComplete, OnWSRequestFailed);
                    }
                }
                else {
                    alert(EmployeecannotbeleftBlank);
                }
            }
            else {
                if (document.getElementById(GlobShiftPatternCode).value != "") {
                    alert(InvalidShiftPattern);
                }
            }
        }

        function LoadingStart() {
            $get('UpdateProgress1').style.display = 'block';
        }

        function LoadingComplete() {
            $get('UpdateProgress1').style.display = 'none';
        }

        function OnInsertRecordsComplete(result) {
            LoadingComplete();
            document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = '';
            document.getElementById('span2').innerHTML = "";
            document.getElementById('span2').innerHTML = result;
            document.getElementById('btnOverWrite').style.display = 'none';
            document.getElementById('btnCheckAll').style.display = "none";
            document.getElementById('btnUnCheckAll').style.display = "none";
            var j = 0;
            var totalCount = document.getElementById('totalDuplicatedCount0').value;
            var flag = 0;

            if (document.getElementById('HFIsDuplicateExists0') == "[object]") {
                if (document.getElementById('HFIsDuplicateExists0').value == "1") {
                    document.getElementById('btnOverWrite').style.display = 'block';
                    document.getElementById('btnCheckAll').style.display = "block";

                }
                else {
                    document.getElementById('btnOverWrite').style.display = 'none';
                }
            }
            if (totalCount > 0) {

                if (document.getElementById('lblMsgID' + j).innerHTML == "5") {

                    document.getElementById('tr' + j).style.display = "block";
                    document.getElementById('DIVMultipleOverwrite').style.display = "block";
                }
                else if (document.getElementById('lblMsgID' + j).innerHTML == "1") {
                    if (document.getElementById('<%=HFPost.ClientID %>').value == '') {
                        document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
                    }
                    document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
                    document.getElementById('<%=btnProceed.ClientID %>').click();
                    document.getElementById('tr' + j).style.display = "none";
                    document.getElementById('DIVMultipleOverwrite').style.display = "none";

                    // Code to show Exceptions
                    showExceptionMessage();
                    // Code to show Exceptions

                }

            }


        }
        // This function is called to show exception messages to user if there is any exception[Skill mismatch ,Prefrences mismatch etc..] while inserting records
        function showExceptionMessage() {

            var arrException = new Array;
            var strExceptionEmployeeNumber = "";
            var strMaxDutyDate = "";
            var strProceedStatus = "0";
            if (document.getElementById('lblMsgID' + 119) == '[object]') {
                if (document.getElementById('lblMsgID' + 119).innerHTML == "119") {
                    arrException = document.getElementById('lblMsgException' + 119).innerHTML.split(",");
                    strMaxDutyDate = document.getElementById('lblMsgExceptionMaxToDate' + 119).innerHTML;
                    strExceptionEmployeeNumber = document.getElementById('lblMsgExceptionEmployeeNumber' + 119).innerHTML;
                    strProceedStatus = "1";
                }
            }
            else if (document.getElementById('<%=lblMsgIDException.ClientID %>').innerHTML == "119") {
                arrException = document.getElementById('<%=lblMsgException.ClientID %>').innerHTML.split(",");
                strExceptionEmployeeNumber = document.getElementById('<%=lblMsgExceptionEmployeeNumber.ClientID %>').innerHTML;
                strMaxDutyDate = document.getElementById('<%=lblMsgExceptionMaxToDate.ClientID %>').innerHTML;
                strProceedStatus = "1";
            }
            else {
                return;
            }

            if (strProceedStatus == "1" && arrException[0] != "") {
                var strMsg = "Following Exception occured";
                strMsg = strMsg + "\n";
                for (var i = 0; i < arrException.length; i++) {
                    if (arrException[i] != "") {
                        strMsg = strMsg + (i + 1) + " . " + arrException[i] + "\n";
                    }
                }

                strMsg = strMsg + "\n";
                strMsg = strMsg + "Click OK to continue";
                var strScreenType;
                if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {
                    strScreenType = 'ACT';
                }
                else {
                    strScreenType = 'SCH';
                }

                GlobPDLineWiseShiftPatternCode = document.getElementById(GlobShiftPatternCode).value;

                var strExceptionClickStatus;
                if (confirm(strMsg)) {
                    strExceptionClickStatus = '2';

                    WebMethods.InsertExceptionRecords(document.getElementById('<%= HidCon.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(strMaxDutyDate), document.getElementById('<% =txtAsmtCode.ClientID %>').value, document.getElementById('<%= HFCurrentSessionID.ClientID %>').value, SessionLocationAutoId, strScreenType, strExceptionEmployeeNumber, strExceptionClickStatus, SessionUserId, OnInsertExceptionRecordsComplete, OnWSRequestFailed);
                }
                else {
                    strExceptionClickStatus = '3';
                    WebMethods.InsertExceptionRecords(document.getElementById('<%= HidCon.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(strMaxDutyDate), document.getElementById('<% =txtAsmtCode.ClientID %>').value, document.getElementById('<%= HFCurrentSessionID.ClientID %>').value, SessionLocationAutoId, strScreenType, strExceptionEmployeeNumber, strExceptionClickStatus, SessionUserId, OnInsertExceptionRecordsComplete, OnWSRequestFailed);
                }
            }
            try {
                document.getElementById('<%=lblMsgIDException.ClientID %>').innerHTML = "";
                document.getElementById('<%=lblMsgExceptionEmployeeNumber.ClientID %>').innerHTML = "";
                document.getElementById('<%=lblMsgExceptionMaxToDate.ClientID %>').innerHTML = "";
                document.getElementById('<%=lblMsgException.ClientID %>').innerHTML = "";
                document.getElementById('lblMsgID' + 119).innerHTML = "";
                document.getElementById('lblMsgException' + 119).innerHTML = "";
                /// GetReqSch();
            }

            catch (Error) {
                //                document.getElementById('btnProceed').disabled = false;
                //                document.getElementById('btnProceed').click();
            }
        }

        // This function is called when user clicks YES OR NO on the exception window 
        function OnInsertExceptionRecordsComplete(strResult) {
            ////  GetReqSch();
            var arr = new Array;
            arr = strResult.split("@@@");
            if (arr[0] == "STRING") {
                document.getElementById('span2').innerHTML = '';
                document.getElementById('span2').innerHTML = arr[1];
                document.getElementById('btnOverWrite').style.display = 'none';
                document.getElementById('btnCheckAll').style.display = "none";
                document.getElementById('btnUnCheckAll').style.display = "none";

                document.getElementById('DIVMultipleOverwrite').style.display = "block";
                if (document.getElementById('HFIsDuplicateExists0') == "[object]") {
                    if (document.getElementById('HFIsDuplicateExists0').value == "1") {
                        document.getElementById('btnOverWrite').style.display = 'block';
                        document.getElementById('btnCheckAll').style.display = "block";
                    }
                    else {
                        document.getElementById('btnOverWrite').style.display = 'none';
                    }
                }
            }
            else {
                document.getElementById('btnOverWrite').style.display = 'none';
                var res1 = strResult;
                var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
                xmlDoc1.async = "false";
                xmlDoc1.loadXML(res1);
                var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
                var asmtc = nodes1.selectNodes("Table");

                var l = 0;
                if (xmlDoc1.getElementsByTagName("MessageID")[l].firstChild.nodeValue == '3') { // When Called From PAy Rate Check
                    if (document.getElementById('<%=HFPost.ClientID %>').value == '') {
                        document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
                    }
                    return;
                }
                if (xmlDoc1.getElementsByTagName("MessageID")[l].firstChild.nodeValue == '2' || xmlDoc1.getElementsByTagName("MessageID")[l].firstChild.nodeValue == '1') {
                    if (document.getElementById('<%=HFPost.ClientID %>').value == '') {
                        document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
                    }
                    document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
                    document.getElementById('<%=btnProceed.ClientID %>').click();
                    return;
                }
            }


        }
        // This function is used to fill all post of the assignment in drop down
        function GetPost(strAsmtCode) {
            document.getElementById('<% =ddlPost.ClientID %>').options.length = 0;

            LoadingStart();
            WebMethods.GetAllPostOfAssignment(document.getElementById('<%= HidCon.ClientID %>').value, strAsmtCode, SessionLocationAutoId, DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<%=HFToDate.ClientID %>').value), OnGetAllPostWSRequestComplete, OnGetAllPostWSRequestFailed);

        }
        //This function is called when user changes the post code from post code dropdown
        function ChangePostCode() {
            document.getElementById('<%=HFEmployeeSearch.ClientID %>').value = "";
            ResetPaging();
            document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<% =ddlPost.ClientID %>').value;
            if (document.getElementById('<%=ddlPost.ClientID %>').selectedIndex != -1) {
                document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
                document.getElementById('<%=HFPostText.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').options[document.getElementById('<%=ddlPost.ClientID %>').selectedIndex].text;
            }
            else {
                document.getElementById('<%=btnProceed.ClientID %>').disabled = true;
            }
            if (document.getElementById('gvScheduleRoster') == '[object]') {
                document.getElementById('gvScheduleRoster').style.display = 'none';
                document.getElementById('<%=HFRowIndex.ClientID %>').value = "";
                document.getElementById('<%=HFColumnIndex.ClientID %>').value = "";
                document.getElementById('<%=txtPostID.ClientID %>').value = "";
            }

        }
        // This function is used to fill all post of the assignment in drop down when     GetPost function has executed successfully
        function OnGetAllPostWSRequestComplete(result) {
            var res1 = result;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");

            var l = 0;
            document.getElementById('<% =ddlPost.ClientID %>').options.length = 0;
            for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {
                var option = document.createElement("OPTION");
                option.text = xmlDoc1.getElementsByTagName("Post")[l].firstChild.nodeValue;
                option.value = xmlDoc1.getElementsByTagName("PDLineNo")[l].firstChild.nodeValue;
                document.getElementById('<% =ddlPost.ClientID %>').options.add(option);
                l++;
            }
            document.getElementById('<% =ddlPost.ClientID %>').selectedIndex = 0;
            if (document.getElementById('<%=hfParentClientCode.ClientID %>').value != "") {
                document.getElementById('<% =ddlPost.ClientID %>').value = document.getElementById('<%=HFPost.ClientID %>').value;
            }
            else {
                document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<% =ddlPost.ClientID %>').value;
            }
            if (document.getElementById('<%=ddlPost.ClientID %>').selectedIndex != -1) {
                document.getElementById('<%=HFPostText.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').options[document.getElementById('<%=ddlPost.ClientID %>').selectedIndex].text;
            }


            if (globPostDesc != 'undefined' && globPostDesc != '') {
                AssignPostIDDropDown();
            }

            if (document.getElementById('<%=HFPost.ClientID %>').value != "" && document.getElementById('<%=hfParentClientCode.ClientID %>').value != "") {

                document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
                document.getElementById('<%=btnProceed.ClientID %>').click();
                document.getElementById('<%= hfParentClientCode.ClientID %>').value = "";

            }
            if (document.getElementById('<%=ddlPost.ClientID %>').selectedIndex != -1) {
                document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            }
            else {
                document.getElementById('<%=btnProceed.ClientID %>').disabled = true;
            }
            if (dateChangeClientCode != "" && dateChangeAsmtCode != "" && dateChangePostCode != "") {
                document.getElementById('<%=txtClientCode.ClientID %>').value = dateChangeClientCode;
                document.getElementById('<%=ddClient.ClientID %>').value = dateChangeClientCode;
                document.getElementById('<%=txtAsmtCode.ClientID %>').value = dateChangeAsmtCode;
                document.getElementById('<%=HFPost.ClientID %>').value = dateChangePostCode;
                GlobAsmtCode = dateChangeAsmtCode;
                globPostDesc = dateChangePostCode;
                dateChangeClientCode = "";
                dateChangeAsmtCode = "";

                if (document.getElementById('<%= ddClient.ClientID %>').length != 0) {
                    var ddAssignment = document.getElementById('<%= ddAssignment.ClientID %>');
                    WebMethods.GetAllAssignments(document.getElementById('<%= HidCon.ClientID %>').value, SessionLocationAutoId, document.getElementById('<%= ddClient.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), SessionAreaInchargeNumber, IsAreaIncharge, document.getElementById('<%= ddlArea.ClientID %>').value, OnGetAllAssignments, OnWSRequestFailed, ddAssignment);
                }
            }
            LoadingComplete();
        }

        // this function is called when user search the post code and press enter key in the search box
        function AssignPostIDDropDown() {
            document.getElementById('<% =ddlPost.ClientID %>').value = globPostDesc.trim();

            document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<% =ddlPost.ClientID %>').value;
            if (document.getElementById('<%=ddlPost.ClientID %>').selectedIndex != -1) {
                document.getElementById('<%=HFPostText.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').options[document.getElementById('<%=ddlPost.ClientID %>').selectedIndex].text;

                if (globPostDesc != '') {

                    document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
                    if (dateChangePostCode == "") {
                        document.getElementById('<%=btnProceed.ClientID %>').click();
                    }
                }
            }
            else {
                document.getElementById('<%=btnProceed.ClientID %>').disabled = true;
            }

            dateChangeClientCode = "";
            dateChangeAsmtCode = "";
            dateChangePostCode = "";
            globPostDesc = '';
            if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {
                FillReqSch('');
            }
            if (document.getElementById('<%=ddlPost.ClientID %>').selectedIndex != -1) {
                document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            }
            else {
                document.getElementById('<%=btnProceed.ClientID %>').disabled = true;
            }
            return;
        }
        function OnGetAllPostWSRequestFailed() {

        }
        //=======================================
        //Function To Change The Date Fromat
        //=======================================
        function DateInFormat(str) {
            if (str == "") {
                return str;
            }
            else {

                var d = new Date();

                var arr = str.split("-");
                var strMonthName;
                var strDay, strYear;

                strMonthName = arr[1];
                strDay = arr[0];
                strYear = arr[2];

                var dateReturn;

                if (strMonthName.toUpperCase() == January.toUpperCase() || strMonthName.toUpperCase() == "JAN" || strMonthName.toUpperCase() == January.substring(0, 3).toUpperCase()) {
                    dateReturn = strDay + "-JAN-" + strYear;
                }
                else if (strMonthName.toUpperCase() == February.toUpperCase() || strMonthName.toUpperCase() == "FEB" || strMonthName.toUpperCase() == February.substring(0, 3).toUpperCase()) {

                    dateReturn = strDay + "-FEB-" + strYear;
                }
                else if (strMonthName.toUpperCase() == March.toUpperCase() || strMonthName.toUpperCase() == "MAR" || strMonthName.toUpperCase() == March.substring(0, 3).toUpperCase()) {
                    dateReturn = strDay + "-MAR-" + strYear;
                }
                else if (strMonthName.toUpperCase() == April.toUpperCase() || strMonthName.toUpperCase() == "APR" || strMonthName.toUpperCase() == April.substring(0, 3).toUpperCase()) {
                    dateReturn = strDay + "-APR-" + strYear;
                }
                else if (strMonthName.toUpperCase() == May.toUpperCase() || strMonthName.toUpperCase() == "MAY" || strMonthName.toUpperCase() == May.substring(0, 3).toUpperCase()) {
                    dateReturn = strDay + "-MAY-" + strYear;
                }
                else if (strMonthName.toUpperCase() == June.toUpperCase() || strMonthName.toUpperCase() == "JUN" || strMonthName.toUpperCase() == June.substring(0, 3).toUpperCase()) {
                    dateReturn = strDay + "-JUN-" + strYear;
                }
                else if (strMonthName.toUpperCase() == July.toUpperCase() || strMonthName.toUpperCase() == "JUL" || strMonthName.toUpperCase() == July.substring(0, 3).toUpperCase()) {
                    dateReturn = strDay + "-JUL-" + strYear;
                }
                else if (strMonthName.toUpperCase() == August.toUpperCase() || strMonthName.toUpperCase() == "AUG" || strMonthName.toUpperCase() == August.substring(0, 3).toUpperCase()) {
                    dateReturn = strDay + "-AUG-" + strYear;
                }
                else if (strMonthName.toUpperCase() == September.toUpperCase() || strMonthName.toUpperCase() == "SEP" || strMonthName.toUpperCase() == September.substring(0, 3).toUpperCase()) {
                    dateReturn = strDay + "-SEP-" + strYear;
                }
                else if (strMonthName.toUpperCase() == October.toUpperCase() || strMonthName.toUpperCase() == "OCT" || strMonthName.toUpperCase() == October.substring(0, 3).toUpperCase()) {
                    dateReturn = strDay + "-OCT-" + strYear;
                }
                else if (strMonthName.toUpperCase() == November.toUpperCase() || strMonthName.toUpperCase() == "NOV" || strMonthName.toUpperCase() == November.substring(0, 3).toUpperCase()) {
                    dateReturn = strDay + "-NOV-" + strYear;
                }
                else if (strMonthName.toUpperCase() == December.toUpperCase() || strMonthName.toUpperCase() == "DEC" || strMonthName.toUpperCase() == December.substring(0, 3).toUpperCase()) {
                    dateReturn = strDay + "-DEC-" + strYear;
                }

                return dateReturn;

            }
        }
        // This function is called when user click on the post where the employee has worked  and it is showing on the cell of the gridview
        function SelectPost(obj) {
            var obj = document.getElementById('<% =LBPost.ClientID %>');
            if (obj.selectedIndex >= 0) {

                document.getElementById('<%=txtPostID.ClientID %>').value = obj.options[obj.selectedIndex].text;
                document.getElementById('<%=txtPostID.ClientID %>').focus();
                WebMethods.GetAssignmentClientAndPostBasedOnAsmtAutoId(document.getElementById('<%= HidCon.ClientID %>').value, obj.options[obj.selectedIndex].value, document.getElementById('<%= txtAsmtCode.ClientID %>').value, document.getElementById('<%= ddlPost.ClientID %>').value, OnGetAssignmentClientAndPostBasedOnAsmtAutoIdComplete, OnWSRequestFailed);
                document.getElementById('DIVPostSearch').style.display = "none";
                document.getElementById('<%=txtPostID.ClientID %>').value = '';
            }
            return;
        }
        function AssignPostIDValue() {
            document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
            document.getElementById('<%=HFEmployeeSearch.ClientID %>').value = "";

            var objPost = document.getElementById('<%=ddlPost.ClientID %>');
            if (objPost.selectedIndex != -1) {
                document.getElementById('<%=HFPostText.ClientID %>').value = objPost.options[objPost.selectedIndex].text;
            }

        }
        function OnGetPostIDComplete(result) {
            if (result != '') {
                var res1 = result;
                var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
                xmlDoc1.async = "false";
                xmlDoc1.loadXML(res1);
                var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
                var asmtc = nodes1.selectNodes("Table");

                var l = 0;

                if (document.getElementById('<% =LBPost.ClientID %>').length == 0) {
                    for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {
                        var Option = document.createElement("OPTION");
                        Option.text = xmlDoc1.getElementsByTagName("Post")[l].firstChild.nodeValue;
                        Option.value = xmlDoc1.getElementsByTagName("AsmtMasterAutoID")[l].firstChild.nodeValue;
                        document.getElementById('<% =LBPost.ClientID %>').options.add(Option);
                        l++;
                    }
                }

                document.getElementById('<% =LBPost.ClientID %>').selectedIndex = -1;
            }

            //********************************************
            var elList = document.getElementById('<% =LBPost.ClientID %>');

            if (GlobKeyCode == 13) {
                if (elList.selectedIndex > -1) {
                    document.getElementById('<%=txtPostID.ClientID %>').value = elList.options[elList.selectedIndex].text;
                    document.getElementById('<%=txtAsmtCode.ClientID %>').value = elList.options[elList.selectedIndex].value;
                    document.getElementById('DIVPostSearch').style.display = "none";
                }
                return;
            }
            else if (GlobKeyCode == 40) {
                if (document.getElementById('DIVPostSearch').style.display == "block") {
                    elList.focus();
                }
                return;
            }
            else if (GlobKeyCode == 9) {
                if (document.getElementById('<%=txtPostID.ClientID %>').value != "") {
                    try {
                        document.getElementById('<%=txtPostID.ClientID %>').value = elList.options[elList.selectedIndex].text;
                        document.getElementById('<%=txtAsmtCode.ClientID %>').value = elList.options[elList.selectedIndex].value;

                        document.getElementById('DIVPostSearch').style.display = "none";
                        return;
                    }
                    catch (Error) { return; }
                }
            }
            else if (GlobKeyCode == 0 && elList.length > 0) /////// on blur
            {
                if (elList.selectedIndex > -1) {
                    document.getElementById('<%=txtPostID.ClientID %>').value = elList.options[elList.selectedIndex].text;
                    document.getElementById('<%=txtAsmtCode.ClientID %>').value = elList.options[elList.selectedIndex].value;
                }
                document.getElementById('DIVPostSearch').style.display = "none";
                elList.selectedIndex = -1;
                return;
            }
            else {
                if (GlobKeyCode == 0)
                { return; }
                var lyr = document.getElementById('DIVPostSearch');
                var coors = findPos(document.getElementById('<%=txtPostID.ClientID %>'));
                lyr.style.top = coors[1] + 20 + 'px';
                lyr.style.left = coors[0] + 'px';
                document.getElementById('DIVPostSearch').style.display = "block";
                elList.selectedIndex = -1;
                for (i = 0; i < elList.length; i++) {
                    if (elList.options[i].text.toLowerCase().substr(0, document.getElementById('<%=txtPostID.ClientID %>').value.length) == document.getElementById('<%=txtPostID.ClientID %>').value.toLowerCase()) {
                        elList.options[i].selected = true;
                        return;
                    }
                }
            }
        }
        function SearchPostID(obj) {
            GlobKeyCode = window.event.keyCode;
            var strClientCode;
            if (SessionLoginType == 'C') {
                strClientCode = document.getElementById('<% =txtClientCode.ClientID %>').value;
            }
            else {
                strClientCode = '';
            }
            ///document.getElementById('<% =LBPost.ClientID %>').length = 0;  // Added on 17-Sep-2011 For adding Area Drop down
            WebMethods.SearchPostID(document.getElementById('<%= HidCon.ClientID %>').value, SessionLocationAutoId, '', DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), strClientCode, document.getElementById('<%= ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, OnGetPostIDComplete, OnWSRequestFailed);
        }
        //============ function added by  on 25-aug-2010 for searching employee schedule====================
        function GetUnSchEmp(strEmpClientId) {
            GlobEmployeeNumber = strEmpClientId;
            document.getElementById('<%=btnUnScheduledEmp.ClientID %>').click();
        }
        function CloseUnSchEmpDiv(obj) {
            document.getElementById('<%=DIVUnScheduledEmployees.ClientID %>').style.display = "none";
        }
        function BorrowUnSchEmpDiv(obj) {
            document.getElementById('<%=btnBorrowedEmp.ClientID %>').click();
        }

        /*Code added by   on 17-Aug-2011*/
        var oldTextAry = new Array();

        function changeText(fieldObj, newTexStr) {
            if (newTexStr == fieldObj.innerHTML) {
                fieldObj.innerHTML = oldTextAry[fieldObj.id];
            } else {
                oldTextAry[fieldObj.id] = fieldObj.innerHTML;
                fieldObj.innerHTML = newTexStr;
            }
        }
        /*End Code added by   on 17-Aug-2011*/

        function AssignToSelectedTextBox(obj) {
            if (GlobEmployeeNumber != '') {

                document.getElementById('<%=DIVUnScheduledEmployees.ClientID %>').style.display = "none";
                var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                //Added Area ID option to search only those employee that belongs to that Area
                var strScreenType;
                if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {
                    strScreenType = 'ACT';
                }
                else {
                    strScreenType = 'SCH';
                }
                document.getElementById(GlobEmployeeNumber).value = document.getElementById(obj.id).innerText;
                WebMethods.GetEmployeeDetail(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById(GlobEmployeeNumber).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), strPost, 'GETEMP', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType, SessionCompanyCode, SessionHrLocationCode, SessionLocationAutoId, SessionUserId, OnGetEmployeeDetailComplete, OnWSRequestFailed);
            }
        }

        function Search_GetEmployeeSchedule() {

            //Added Area ID option to search only those employee that belongs to that Area
            WebMethods.GetEmployeeSchedule(document.getElementById('<%= HidCon.ClientID %>').value, SessionLocationAutoId, document.getElementById('search_txtEmployeeNumber').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), document.getElementById('<%=ddlAttendanceType.ClientID %>').value, document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, OnGetScheduleComplete, OnWSRequestFailed);
        }
        function OnGetScheduleComplete(result) {
            var res1 = result;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");
            var l = 0;
            var strTable;
            strTable = "<table border='0' cellpadding=0 cellspacing=1 style='font-size:11px' > ";
            strTable = strTable + "<tr style='background-color:#B7CEEC' >";
            strTable = strTable + "<td width=150px>Location</td>";
            strTable = strTable + "<td width=100px>AsmtCode</td>";
            strTable = strTable + "<td width=50px>PostCode</td>";
            strTable = strTable + "<td width=80px>DutyDate</td>";
            strTable = strTable + "<td width=30px>Shift</td>";
            strTable = strTable + "<td width=40px>From</td>";
            strTable = strTable + "<td width=40px>To</td>";
            strTable = strTable + "<td width=40px>Hrs</td>";

            strTable = strTable + "</tr><tr>";
            var arr = new Array;
            var TMin = 0;
            var postCode;
            var strJavascriptFunctionName;
            for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {

                strTable = strTable + "<tr><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("LocationDesc")[l].firstChild.nodeValue + "</td><td>";
                strJavascriptFunctionName = "javascript:SwitchToThisAssignment('" + xmlDoc1.getElementsByTagName("PostCode")[l].firstChild.nodeValue + "');";
                strTable = strTable + '<a Style="cursor: pointer" onclick="' + strJavascriptFunctionName + '">';
                strTable = strTable + xmlDoc1.getElementsByTagName("AsmtCode")[l].firstChild.nodeValue + "</a></td><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("PostCodeDesc")[l].firstChild.nodeValue + "</td><td>";

                strTable = strTable + xmlDoc1.getElementsByTagName("DutyDate")[l].firstChild.nodeValue + "</td><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("ShiftCode")[l].firstChild.nodeValue + "</td><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("TimeFrom")[l].firstChild.nodeValue + "</td><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("TimeTo")[l].firstChild.nodeValue + "</td><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("DutyMin")[l].firstChild.nodeValue + "</td></tr>";

                arr = xmlDoc1.getElementsByTagName("DutyMin")[l].firstChild.nodeValue.split(":");
                TMin = TMin + parseInt(arr[0] * 60) + parseInt(arr[1]);

                l++;
            }

            var totHours = parseInt(TMin / 60);
            var totMinutes = TMin % 60;

            if (totHours < 10)
            { totHours = "0" + totHours; }
            if (totMinutes < 10)
            { totMinutes = "0" + totMinutes; }

            strTable = strTable + "<tr><td colspan=7><b>Total Hours</b></td><td><b>" + totHours + ":" + totMinutes + "</b></td></tr>";

            strTable = strTable + "</table>";
            document.getElementById('span_EmployeeSchedule').innerHTML = strTable;

        }

        function SwitchToThisAssignment(strPostCode) {
            // 
            document.getElementById('<%=lblOldAsmtCode.ClientID %>').innerText = strPostCode;
            LoadScheduleDetailsOnClientClick('Back');
            document.getElementById('divSearchEmployeeSchedule').style.display = "none";
        }

        //============ end function added by  on 25-aug-2010 for searching employee schedule====================
        // 
        ///// *******************Employee Name search *************************************************************************
        function func_EmpNameSearch(objEmpName) {

            var elList = document.getElementById('<% =lstBox_Employees.ClientID %>');
            var elEmpList = document.getElementById('<% =ddlEmployeesForSearch.ClientID %>');
            if (window.event.keyCode == 13) {
                if (elList.selectedIndex > -1) {
                    document.getElementById('search_txtEmployeeNumber').value = elList.options[elList.selectedIndex].value;
                    document.getElementById('search_txtEmployeeName').value = elList.options[elList.selectedIndex].text;
                    document.getElementById('divEmployeeList').style.display = "none";

                }
                return;
            }
            else if (window.event.keyCode == 40) {
                if (document.getElementById('divEmployeeList').style.display == "block") {
                    elList.focus();
                }
                return;
            }
            else if (window.event.keyCode == 9) {
                return;
            }
            else if (window.event.keyCode == 0 && elList.length > 0) /////// on blur
            {
                document.getElementById('divEmployeeList').style.display = "block";
                if (elList.selectedIndex > -1) {
                    document.getElementById('search_txtEmployeeNumber').value = elList.options[elList.selectedIndex].value;
                    document.getElementById('search_txtEmployeeName').value = elList.options[elList.selectedIndex].text;

                }
                elList.selectedIndex = -1;
                return;
            }
            else {
                if (window.event.keyCode == 0) {
                    document.getElementById('divEmployeeList').style.display = "block";
                    return;
                }
                var lyr = document.getElementById('divEmployeeList');
                var coors = findPos(document.getElementById('search_txtEmployeeName'));
                lyr.style.top = coors[1] + 20 + 'px';
                lyr.style.left = coors[0] + 'px';
                document.getElementById('divEmployeeList').style.display = "block";
                var j = 0;
                j = FindIndex(elEmpList, 0, elEmpList.length, document.getElementById('search_txtEmployeeName').value.toLowerCase());
                elList.length = 0;
                for (i = j; i < j + 50 && i < elEmpList.length; i++) {
                    if (elEmpList.options[i].text.toLowerCase().substr(0, document.getElementById('search_txtEmployeeName').value.length) == document.getElementById('search_txtEmployeeName').value.toLowerCase()) {
                        elList.options.add(new Option(elEmpList.options[i].text, elEmpList.options[i].value));
                        elList.selectedIndex = 0;
                    }
                }
            }
        }

        function func_SelectEmployee(obj) {

            if (obj.selectedIndex > -1) {
                document.getElementById('search_txtEmployeeName').value = obj.options[obj.selectedIndex].text;
                document.getElementById('search_txtEmployeeNumber').value = obj.options[obj.selectedIndex].value;
                document.getElementById('divEmployeeList').style.display = "none";
            }

        }
        function backgroundOnFocus(txtClientId) {
            document.getElementById(txtClientId).style.background = "yellow";
        }

        function backgroundOnBlur(txtClientId) {
            document.getElementById(txtClientId).style.background = "white";
        }
        //Swap Duty
        function SwapDuty() {
            var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
            var RowClientID = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var ColumnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var SchRosterAutoID = "HFSchRosterAutoID" + ColumnIndex;
            var cellScheduleRosterAutoId = document.getElementById(getClientId(RowClientID, SchRosterAutoID)).value;

            if (cellScheduleRosterAutoId != '') {
                var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                var strPageName = "../Transactions/SwapDuty.aspx?ScheduleRosterAutoID=" + cellScheduleRosterAutoId + "&AttendanceType=" + document.getElementById('<%=ddlAttendanceType.ClientID %>').value;
                //var FrmChild = window.showModalDialog(strPageName, null, 'status:off;center:yes;scroll:no;dialogWidth:1000px;dialogHeight:300px;');

                var winW = 1000;
                var winH = 300;
                var winX = (screen.availWidth - winW) / 2;
                var winY = (screen.availHeight - winH) / 2;
                var features = 'left=' + winX + ',top=' + winY + ',height=' + winH + ',' + 'width=' + winW + ',status=yes,' + 'toolbar=no,menubar=no,location=no';
                window.open(strPageName, 'Search', features);
            }
        }

        function KeyNavigation(obj, direction) {
            var arr = new Array;
            var clId = "";  // clientId
            arr = obj.id.split("_");
            for (i = 0; i < arr.length - 2; i++) {
                clId = clId + arr[i] + "_";
            }

            var currentIndex = arr[arr.length - 2].substring(3);

            if (currentIndex.length > 1 && currentIndex.substring(0, 1) == "0") {
                currentIndex = currentIndex.substring(1);
            }

            if (direction.toUpperCase() == "DOWN") {
                currentIndex = parseInt(currentIndex) + 1;
            }
            else {
                currentIndex = parseInt(currentIndex) - 1;
            }

            if (currentIndex < 10)
            { currentIndex = "0" + currentIndex; }

            clId = clId + "ctl" + currentIndex + "_";
            clId = clId + arr[arr.length - 1];

            if (document.getElementById(clId) != "[object]")
            { clId = obj.id; }

            return clId;
        }

        function SearchEmploueeSchedule() {
            document.getElementById('span_EmployeeSchedule').innerHTML = "";
            document.getElementById('divSearchEmployeeSchedule').style.display = "block";
        }
        function closeEmployeeSearch(obj) {
            document.getElementById('divSearchEmployeeSchedule').style.display = "none";
        }

        //// ************ Functions related to adjustment entries ********************************

        function funcHoursAdjustment(ops) {
            var columnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var rowClientId = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var strDutyDate = "lblHeaderDutyDate" + columnIndex;
            strDutyDate = document.getElementById('gvScheduleRoster_ctl01_' + strDutyDate).innerText;

            var schRosterAutoId = "HFSchRosterAutoID" + columnIndex;
            var strEmployee = "txtEmpNumberDutyDate"; //"HFOrgEmployeeNumber";
            strEmployee = document.getElementById(getClientId(rowClientId, strEmployee)).value;
            schRosterAutoId = document.getElementById(getClientId(rowClientId, schRosterAutoId)).value;

            var adjustmentHrs = document.getElementById('<%= txtAdjustmentHrs.ClientID %>').value;
            var adjustmentType = document.getElementById('<%= AdjType.ClientID %>').value;
            var adjustmentRemark = document.getElementById('<%= txtAdjustmentRemark.ClientID %>').value;
            var post = document.getElementById('<%=ddlPost.ClientID %>').value;
            if (strEmployee == "") {
                CloseAdjustment();
                return;
            }

            if (ops == "I") {
                if (adjustmentHrs == "00:00" || adjustmentHrs == "00.00" || strEmployee == "" || adjustmentHrs == "") {
                    alert("Invalid Hours");
                    return;
                }
                WebMethods.AdjustmentHoursInsert(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById('<%= txtAsmtCode.ClientID %>').value, post, SessionLocationAutoId, strDutyDate, strEmployee, strDutyDate, adjustmentHrs, adjustmentType, adjustmentRemark, SessionUserId, OnAdjustmentHoursSaved, OnWSRequestFailed);
            }
            else if (ops == "D") {
                if (adjustmentHrs == "00:00" || adjustmentHrs == "00.00") {
                    alert("Invalid Hours");
                    return;
                }
                WebMethods.AdjustmentHoursDelete(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById('<%= txtAsmtCode.ClientID %>').value, strDutyDate, strEmployee, OnAdjustmentHoursDeleted, OnWSRequestFailed);
            }
            else if (ops == "R") {
                var lblSelect = "lblSelect" + columnIndex;
                var lyr = document.getElementById('divAdjustment');
                var coors = findPos(document.getElementById(getClientId(rowClientId, lblSelect)));
                lyr.style.top = coors[1] + 20 + 'px';
                lyr.style.left = coors[0] - 1 + 'px';

                WebMethods.AdjustmentHoursGet(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById('<%= txtAsmtCode.ClientID %>').value, strDutyDate, strEmployee, OnGetAdjustmentHours, OnWSRequestFailed);

            }
        }

        function OnAdjustmentHoursDeleted(result) {
            CloseAdjustment();

            var columnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var rowClientId = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];

            var adjustmentImage = "adjustmentImage" + document.getElementById('<%=MouseClickRowID.ClientID %>').value + (parseInt(columnIndex) + 1);
            document.getElementById(getClientId(rowClientId, adjustmentImage)).style.display = "none";

        }

        function OnAdjustmentHoursSaved(result) {
            var columnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var rowClientId = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var adjustmentImage = "adjustmentImage" + document.getElementById('<%=MouseClickRowID.ClientID %>').value + (parseInt(columnIndex) + 1);
            var arr = new Array;
            arr = result.split("$");
            if (arr[0].toString() == "error") {
                alert(arr[1].toString());
                return;
            }
            document.getElementById(getClientId(rowClientId, adjustmentImage)).style.display = "block";
            CloseAdjustment();

        }

        function OnGetAdjustmentHours(result) {
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(result);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");

            if (asmtc.nextNode()) {
                document.getElementById('<%= AdjType.ClientID %>').value = xmlDoc1.getElementsByTagName("AdjHeadCode")[0].firstChild.nodeValue;
                document.getElementById('<%= txtAdjustmentHrs.ClientID %>').value = xmlDoc1.getElementsByTagName("HrsAdjusted")[0].firstChild.nodeValue;
                if (xmlDoc1.getElementsByTagName("Remark")[0].firstChild != null) {
                    document.getElementById('<%= txtAdjustmentRemark.ClientID %>').value = xmlDoc1.getElementsByTagName("Remark")[0].firstChild.nodeValue;
                }
                document.getElementById('DeleteAdjustment').style.display = "block";
                document.getElementById('SaveAdjustment').innerHTML = "Update";
            }
            else {
                document.getElementById('<%= txtAdjustmentHrs.ClientID %>').value = "00:00";
                document.getElementById('<%= txtAdjustmentRemark.ClientID %>').value = "";
                document.getElementById('DeleteAdjustment').style.display = "none";
                document.getElementById('SaveAdjustment').innerHTML = "Save";

            }
            document.getElementById('divAdjustment').style.display = "block";

        }


        function CloseAdjustment() {

            document.getElementById('divAdjustment').style.display = "none";
        }
        //// *************End Functions related to adjustment entries******************************

        function GetXmlHttpObject() {
            var objXMLHttp = null;
            if (window.XMLHttpRequest) {
                objXMLHttp = new XMLHttpRequest();
            }
            else if (window.ActiveXObject) {
                objXMLHttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            return objXMLHttp;
        }

    </script>
</body>
</html>
