
        String.prototype.trim = function () {
            return this.replace(/^\s*/, "").replace(/\s*$/, "");
        }
        document.onkeyup = ShortCutKeys;
        var SessionCulture = '<% = Session["MyCulture"] %>';
        var SessionUserId = '<% = Session["UserID"] %>';
        var SessionLocationAutoId = '<% = Session["LocationAutoID"] %>';
        var SessionCompanyCode = '<% = Session["CompanyCode"] %>';
        var SessionHrLocationCode = '<% = Session["HrLocationCode"] %>';
        var SessionLocationCode = '<% = Session["LocationCode"] %>';
        var SessionLoginType = '<% = Session["UserIDType"] %>';
        var GlobEmployeeNumber;
        var GlobEmployeeName;
        var GlobEmployeeRoleDesc;
        var GlobEmployeeRoleCode;
        var GlobEmployeeDesgDesc;
        var GlobEmployeeDesgCode;
        var GlobEmployeeDutyType;
        var GlobEmployeeDutyDate;
        var GlobEmployeeDutyTypeCode;
        var GlobEmployeeTimeFrom;
        var GlobEmployeeTimeTo;
        var GlobEmployeeSchRosterAutoID;
        var GlobEmployeeShiftCode;
        var GlobEmployeeDetails;
        var GlobPDLineNo;
        var GlobColumnType;
        var GlobDefaultSite;
        var GlobPatternPosition;
        var GlobShiftPatternCode;
        var GlobPDLineWiseShiftPatternCode;
        var GlobOverwriteStatus;
        var GlobStrCopyRange;
        var GlobRowNumber;
        var GlobObject;
        var SessionAreaInchargeNumber = '<% = Session["EmployeeNumber"] %>';
        var IsAreaIncharge = '<% = Session["IsAreaIncharge"] %>';

        var January = '<%= Resources.Resource.January %>' //Resourcevalue("January");
        var February = '<%= Resources.Resource.February %>';
        var March = '<%= Resources.Resource.March %>';
        var April = '<%= Resources.Resource.April %>';
        var May = '<%= Resources.Resource.May %>';
        var June = '<%= Resources.Resource.June %>';
        var July = '<%= Resources.Resource.July %>';
        var August = '<%= Resources.Resource.August %>';
        var September = '<%= Resources.Resource.September %>';
        var October = '<%= Resources.Resource.October %>';
        var November = '<%= Resources.Resource.November %>';
        var December = '<%= Resources.Resource.December %>';

        var JobbreakDownSummary = '<%= Resources.Resource.JobbreakDownSummary %>';
        var InvalidEmpCode = '<%= Resources.Resource.InvalidEmpCode %>';
        var InvalidShiftPatternPosition = '<%= Resources.Resource.InvalidShiftPatternPosition %>';
        var InvalidAssignment = '<%= Resources.Resource.InvalidAssignment %>';
        var Dataisnotcopiedproperly = '<%= Resources.Resource.Dataisnotcopiedproperly %>';
        var FollowingRecordscannotbecopied = '<%= Resources.Resource.FollowingRecordscannotbecopied %>';
        var SuccessfullyCopied = '<%= Resources.Resource.MsgSuccessfullyCopied %>';
        var TimeisNotInValidFormat = '<%= Resources.Resource.TimeisNotInValidFormat %>';
        var HourMustBeBetween0And23 = '<%= Resources.Resource.HourMustBeBetween0And23 %>';
        var MinuteMustBeBetween0And59 = '<%= Resources.Resource.MinuteMustBeBetween0And59 %>';
        var NoDatatoCopy = '<%= Resources.Resource.NoDatatoCopy %>';
        var ShiftCodeCannotbeleftBlank = '<%= Resources.Resource.ShiftCanNotBeLeftBlank %>';
        var RoleCannotbeleftBlank = '<%= Resources.Resource.RoleCannotbeleftBlank %>';
        var TimeFromCannotbeleftBlank = '<%= Resources.Resource.TimeFromCannotbeleftBlank %>';
        var TimeFromCannotbeleftBlank = '<%= Resources.Resource.TimeFromCannotbeleftBlank %>';

        var InvalidShiftPattern = '<%= Resources.Resource.InvalidShiftPattern %>';

        var DutyTypeCannotbeleftBlank = '<%= Resources.Resource.DutyTypeCannotbeleftBlank %>';
        var Duplicate = '<%= Resources.Resource.Duplicate %>';
        var AreyousureyouwanttoLocktheSchedule = '<%= Resources.Resource.AreyousureyouwanttoLocktheSchedule %>';

        var OverWrite = '<%= Resources.Resource.OverWrite %>';

        var Insert = '<%= Resources.Resource.Insert %>';
        var Alert = '<%= Resources.Resource.Alert %>';

        var ErrorMessage = '<%= Resources.Resource.ErrorMessage %>';
        var EmployeeNumberCannotbeleftBlank = '<%= Resources.Resource.EmployeeNumberCannotbeleftBlank %>';
        var InvalidShift = '<%= Resources.Resource.InvalidShift %>';
        var Converted = '<%= Resources.Resource.Converted %>';
        var Leave = '<%= Resources.Resource.Leave %>';
        var Times = '<%= Resources.Resource.Time %>';
        var Shift = '<%= Resources.Resource.Shift %>';
        var Close = '<%= Resources.Resource.Close %>';
        var Copy = '<%= Resources.Resource.Copy %>';
        var OverWriteShift = '<%= Resources.Resource.OverWriteShift %>';
        var CheckAll = '<%= Resources.Resource.CheckAll %>';
        var UnCheckALL = '<%= Resources.Resource.UnCheckALL %>';
        var EmployeeSkillsDoesNotMatchWithRequiredSkillsDoYouWantToContinue = '<%= Resources.Resource.EmployeeSkillsDoesNotMatchWithRequiredSkillsDoYouWantToContinue %>';
        var EmployeePayRateIsGreaterThanSaleOrderPayRateDoYouWantToContinue = '<%= Resources.Resource.EmployeePayRateIsGreaterThanSaleOrderPayRateDoYouWantToContinue %>';

        var Employeeisbarredfromthisassignment = '<%= Resources.Resource.Employeeisbarredfromthisassignment %>';
        var EmployeeDoesnotbelongstothisArea = '<%= Resources.Resource.EmployeeDoesnotbelongstothisArea %>';
        var FollowingMandatoryskillsdoesnotmatch = '<%= Resources.Resource.FollowingMandatoryskillsdoesnotmatch %>';

        function initializeVariables() {
            document.getElementById('btnJobBreakClose').value = Close;
            document.getElementById('btnCloseCopy').value = Close;
            document.getElementById('btnOverwriteSingleShift').value = OverWrite;
            document.getElementById('btnClose').alt = Close;
            document.getElementById('btnCopy').value = Copy;
            document.getElementById('btnCheckAll').value = CheckAll;
            document.getElementById('btnUnCheckAll').value = UnCheckALL;
            document.getElementById('btnCloseOverwrite').alt = Close;
            document.getElementById('btnOverWrite').value = OverWrite;
        }

        function CloseDivAdditionalHrs() {
            document.getElementById('DivAdditionalHrs').style.display = 'none';
        }
        function CheckAllMultiRecord() {
            var TotalCount = document.getElementById('hfTotalCount0').value;
            for (var i = 0; i < TotalCount; i++) {
                if (document.getElementById('chk' + i) == "[object]") {
                    if (document.getElementById('chk' + i).checked == false) {
                        document.getElementById('chk' + i).checked = true;
                    }
                }
            }
            document.getElementById('btnUnCheckAll').style.display = 'block';
            document.getElementById('btnCheckAll').style.display = 'none';
        }
        function UnCheckAllMultiRecord() {
            var TotalCount = document.getElementById('hfTotalCount0').value;
            for (var i = 0; i < TotalCount; i++) {
                if (document.getElementById('chk' + i) == "[object]") {
                    if (document.getElementById('chk' + i).checked == true) {
                        document.getElementById('chk' + i).checked = false;
                    }
                }
            }
            document.getElementById('btnUnCheckAll').style.display = 'none';
            document.getElementById('btnCheckAll').style.display = 'block';
        }

        var fadeOpacity = new Array();
        var fadeTimer = new Array();
        var fadeInterval = 10;  // milliseconds
        var GlobObjTofade;
        var GlobObjfadeDisplay;
        var GlobObjfadeImageObject;
        var GlobObjfadeColumnIndex;
        function fade(o, d, ImageObject, ColumnIndex) {

            // o - Object to fade in or out.
            // d - Display, true =  fade in, false = fade out
            if (document.getElementById(o) == '[object]') {
                GlobObjTofade = o;
                GlobObjfadeDisplay = d;
                GlobObjfadeImageObject = ImageObject;
                GlobObjfadeColumnIndex = ColumnIndex;
            }
            else {
                var obj = document.getElementById(GlobObjTofade);
                if (obj.style.display == 'block') {
                    obj.style.display = 'none'
                    document.getElementById('HFJobBreakDownSchRosterAutoID').value = '';
                    return;
                }
            }

            var obj = document.getElementById(o);
            if (obj.style.display == 'block') {
                obj.style.display = 'none'
            }

            var ColumnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var SchRosterAutoID = "HFSchRosterAutoID" + ColumnIndex;
            var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
            var RowClientID = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var cellScheduleRosterAutoID = document.getElementById(getClientId(RowClientID, SchRosterAutoID)).value;
            document.getElementById('HFJobBreakDownSchRosterAutoID').value = '';
            document.getElementById('HFJobBreakDownSchRosterAutoID').value = cellScheduleRosterAutoID;
            // Passed area Id to job Break Bown Summary page
            AutoCompleteTextBox.GetJobBreakDownSummary(document.getElementById('<%= HidCon.ClientID %>').value, SessionCompanyCode, SessionHrLocationCode, SessionLocationCode, cellScheduleRosterAutoID, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), OnGetJobBreakDownComplete, OnWSRequestFailed);

            if ((fadeTimer[o]) || (d && obj.style.display != 'block') || (!d && obj.style.display == 'block')) {

                if (fadeTimer[o])
                    clearInterval(fadeTimer[o]);
                else
                    if (d) fadeOpacity[o] = 0;
                    else fadeOpacity[o] = 9;

                obj.style.opacity = "." + fadeOpacity[o].toString();
                obj.style.filter = "alpha(opacity=" + fadeOpacity[o].toString() + "0)";

                if (d) {
                    obj.style.display = 'block';
                    var coors = findPos(ImageObject);
                    obj.style.top = coors[1] + 20 + 'px';
                    obj.style.left = coors[0] + 'px';
                    fadeTimer[o] = setInterval('fadeAnimation("' + o + '",1);', fadeInterval);
                }
                else
                    fadeTimer[o] = setInterval('fadeAnimation("' + o + '",-1);', fadeInterval);
            }
        }

        function fadeAnimation(o, i) {

            // o - o - Object to fade in or out.
            // i - increment, 1 = Fade In

            var obj = document.getElementById(o);
            fadeOpacity[o] += i;
            obj.style.opacity = "." + fadeOpacity[o].toString();
            obj.style.filter = "alpha(opacity=" + fadeOpacity[o].toString() + "0)";

            if ((fadeOpacity[o] == '9') | (fadeOpacity[o] == '0')) {
                if (fadeOpacity[o] == '0')
                    obj.style.display = 'none';
                else {
                    obj.style.opacity = "1";
                    obj.style.filter = "alpha(opacity=100)";
                }

                clearInterval(fadeTimer[o]);
                delete (fadeTimer[o]);
                delete (fadeTimer[o]);
                delete (fadeOpacity[o]);

            }
        }

        function OnGetJobBreakDownComplete(result) {
            document.getElementById('SpanjobBreakDownSummary').innerHTML = '';
            var res1 = result;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");
            var l = 0;
            var strTable;
            strTable = "<table border='0' cellpadding=0 cellspacing=1 style='font-size:11px' > ";
            strTable = strTable + "<tr style='background-color:#B7CEEC' >";
            strTable = strTable + "<td width=150px>Job Desc</td>";
            strTable = strTable + "<td width=80px>Time From</td>";
            strTable = strTable + "<td width=80px>Time To</td>";
            strTable = strTable + "</tr>";

            for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {
                strTable = strTable + "<tr><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("JobDesc")[l].firstChild.nodeValue + "</td><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("TimeFrom")[l].firstChild.nodeValue + "</td><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("TimeTo")[l].firstChild.nodeValue + "</td></tr>";
                l++;
            }

            strTable = strTable + "</table>";
            document.getElementById('SpanjobBreakDownSummary').innerHTML = strTable;
        }
        function JobBreakDownActive(ID) {

            if (document.images)
                document.getElementById(ID).src = "../Images/infored.gif";
        }

        function JobBreakDownInActive(ID) {
            if (document.images)

                document.getElementById(ID).src = "../Images/info.gif";
        }
        function OnLoad() {
            if (SessionLoginType != 'C') {

                initContextMenus();
                initializeVariables();
            }
        }
        function EnableProceed() {
            if (document.getElementById('gvScheduleRoster') == '[object]') {
                document.getElementById('gvScheduleRoster').style.display = 'none'
            }
            document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
        }
        //***************************************************************************
        function ShowAllAsmtShifts() {
            AutoCompleteTextBox.AllShiftsOfAsmt(document.getElementById('<%= HidCon.ClientID %>').value, SessionLocationAutoId, document.getElementById('<%= txtAsmtCode.ClientID %>').value, document.getElementById('<%=ddlWeek.ClientID %>').value, OnAsmtShiftWSRequestComplete, OnWSRequestFailed);
        }
        function OnAsmtShiftWSRequestComplete(result) {
            var res1 = result;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");

            var l = 0;
            var strTable;
            strTable = "<table width='200px' border='0' cellpadding=0 cellspacing=1 style='font-size:11px' > ";
            strTable = strTable + "<tr style='background-color:#B7CEEC' >";
            strTable = strTable + "<td width=50px>" + Shift + "</td>";
            strTable = strTable + "<td width=100px>" + Times + "</td>";
            strTable = strTable + "</tr><tr>";

            for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {
                strTable = strTable + "<tr><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("Shift")[l].firstChild.nodeValue + "</td><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("ShiftTimes")[l].firstChild.nodeValue + "</td><td>";
                l++;
            }
            strTable = strTable + "</table>";
            document.getElementById('span_showAllAsmtShift').innerHTML = strTable;

        }

        function ShortCutKeys() {
            var KeyID = (window.event) ? event.keyCode : e.keyCode;
            if (KeyID == 45) //INSERT KEY PRESSD
            {

            }
            else if (KeyID == 113)// F2 Pressed  Help Window
            {
                OpenHelpWindow();
            }
            else if (KeyID == 119)// F8 Pressed  For New Pattern
            {
                if (document.getElementById('<%=txtAsmtCode.ClientID %>') == '[object]') {
                    if (document.getElementById('<%=LBShiftPatterns.ClientID %>').title.toLowerCase() == "ShiftPatternCodeSequence".toLowerCase()) {
                        CreatePatternSeq(document.getElementById('<%=txtAsmtCode.ClientID %>').value);
                    }
                    else {
                        CreatePattern(document.getElementById('<%=txtAsmtCode.ClientID %>').value);
                    }
                }
            }
            else if (KeyID == 118)// F7 Pressed Lock Functionality
            {
                var ReturnValue = confirm('Are you sure you want to Lock the Schedule');
                if (ReturnValue) {
                    LockScheduleEmpWise();
                }
            }
            else if (KeyID == 121) // F10 Key Pressed
            {
                document.getElementById('<%=HFColumnIndex.ClientID %>').value = 2;
                document.getElementById('<%=btnEditMode.ClientID %>').click();
            }
            else if (KeyID == 27) // ESC Key Pressed
            {
                HideDivs();
            }
        }
        function OpenShiftOfAssignment() {
            var PageName = "../Transactions/CreateShiftPattern.aspx?AsmtCode=" + document.getElementById('<%=txtAsmtCode.ClientID %>').value + "&Status=" + "ShiftDetails";
            var winW = 950;
            var winH = 500;
            var winX = (screen.availWidth - winW) / 2;
            var winY = (screen.availHeight - winH) / 2;
            var features = 'left=' + winX + ',top=' + winY + ',height=' + winH + ',' + 'width=' + winW + ',status=yes,' + 'toolbar=no,menubar=no,location=no';
            window.open(PageName, 'Search', features);
        }

        function OpenHelpWindow() {
            var PageName = "../Transactions/SchEmpWiseHelp.aspx";
            var winW = 500;
            var winH = 500;
            var winX = (screen.availWidth - winW) / 2;
            var winY = (screen.availHeight - winH) / 2;
            var features = 'left=' + winX + ',top=' + winY + ',height=' + winH + ',' + 'width=' + winW + ',status=yes,' + 'toolbar=no,menubar=no,location=no';
            window.open(PageName, 'Search', features);
        }
        var GlobAsmtCode = "";
        function LoadScheduleDetailsOnClientClick(strObject) {

            var arrClientCode = new Array;
            if (document.getElementById(strObject).innerText.indexOf(':') > 0 || document.getElementById(strObject).innerText == "" || document.getElementById(strObject).innerText.toLowerCase().trim() == "WO".toLowerCase().trim() || document.getElementById(strObject).innerText.toLowerCase().trim() == "AL".toLowerCase().trim() || document.getElementById(strObject).innerText.toLowerCase().trim() == "CL".toLowerCase().trim() || document.getElementById(strObject).innerText.toLowerCase().trim() == "EL".toLowerCase().trim() || document.getElementById(strObject).innerText.toLowerCase().trim() == "FL".toLowerCase().trim() || document.getElementById(strObject).innerText.toLowerCase().trim() == "MAL".toLowerCase().trim() || document.getElementById(strObject).innerText.toLowerCase().trim() == "PA".toLowerCase().trim() || document.getElementById(strObject).innerText.toLowerCase().trim() == "PL".toLowerCase().trim() || document.getElementById(strObject).innerText.toLowerCase().trim() == "SL".toLowerCase().trim() || document.getElementById(strObject).innerText.toLowerCase().trim() == "UL".toLowerCase().trim()) {
                return false;
            }
            var strAsmtCode;
            var objPost = document.getElementById('<% =LBPost.ClientID %>');
            if (document.getElementById('<% =LBPost.ClientID %>') == '[object]') {
                for (var i = 0; i <= document.getElementById('<%=LBPost.ClientID %>').length - 1; i++) {
                    if (document.getElementById(strObject).innerText != '') {
                        if (document.getElementById('<% =LBPost.ClientID %>').options[i].text.toLowerCase() == document.getElementById(strObject).innerText.toLowerCase()) {
                            strAsmtCode = document.getElementById('<% =LBPost.ClientID %>').options[i].value;
                            document.getElementById('<% =txtPostID.ClientID %>').value = document.getElementById(strObject).innerText;
                            break;
                        }
                        else {
                            strAsmtCode = document.getElementById('<%=lblOldAsmtCode.ClientID %>').innerText;

                        }
                    }
                }
            }
            arrClientCode = strAsmtCode.split("/");
            if (SessionLoginType == 'C') {
                if (document.getElementById('<%=txtClientCode.ClientID %>').value != arrClientCode[0]) {
                    return;
                }
            }
            document.getElementById('<%=txtClientCode.ClientID %>').value = arrClientCode[0];
            document.getElementById('<%=ddClient.ClientID %>').value = arrClientCode[0];
            document.getElementById('<%=lblOldAsmtCode.ClientID %>').innerText = document.getElementById('<% =txtAsmtCode.ClientID %>').value;
            GetAsmtsAjax(document.getElementById('<% =ddAssignment.ClientID %>').id, document.getElementById('<% =txtAsmtCode.ClientID %>').id, document.getElementById('<% =txtAsmtStartDate.ClientID %>').id, document.getElementById('<% =txtAsmtEndDate.ClientID %>').id, document.getElementById('<% =txtClientCode.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), document.getElementById('<%=ddlArea.ClientID %>').value, "SelectAssignment", "NoAssignmentIsDefined");
            GlobAsmtCode = strAsmtCode;
        }

        function onAssignmentLoaded() {
            if (GlobAsmtCode != "") {
                document.getElementById('<%=txtAsmtCode.ClientID %>').value = GlobAsmtCode;
                changeAsmtCode();
                if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Sch') {
                    GetReqSch();
                }
                else {
                    document.getElementById('divManPowerReq').innerHTML = '';
                    document.getElementById('divManPowerReq').style.display = 'none';

                }
            }
            GlobAsmtCode = "";
            return false;

        }

        function ChangeDutyType(strDutyType) {

            /// ********* Copy selected text to clipbord **********
            CopiedTxt = document.selection.createRange();
            CopiedTxt.execCommand("Copy");
            var strSchIds = window.clipboardData.getData('Text');

            var strEmployee = "txtEmpNumberDutyDate";
            var strEmployee = "txtEmpNumberDutyDate";
            var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
            var RowClientID = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var cellEmployeeNumber = document.getElementById(getClientId(RowClientID, strEmployee)).value;
            var strAutoIds = "";
            var ColumnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var SchRosterAutoID = "HFSchRosterAutoID" + ColumnIndex;
            var cellScheduleRosterAutoID = document.getElementById(getClientId(RowClientID, SchRosterAutoID)).value;
            strAutoIds = strAutoIds + "," + cellScheduleRosterAutoID;

            if (cellEmployeeNumber == "")
            { alert(InvalidEmpCode); return; }

            AutoCompleteTextBox.ChangeDutyType(document.getElementById('<%= HidCon.ClientID %>').value, strAutoIds, strDutyType, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, SessionUserId, OnDutyTypeChanged, OnWSRequestFailed);

        }

        function OnDutyTypeChanged() {
            ParentWindowFunction1();
        }

        function MarkWeekOff() {
            var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
            var RowClientID = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var strRowNumber = "lblRowID";
            var strEmployee = "txtEmpNumberDutyDate";
            var strShiftPatternCode = "txtShiftPatternCode";
            var strPatternPosition = "txtPatternPosition";
            var cellShiftPatternCode = document.getElementById(getClientId(RowClientID, strShiftPatternCode)).value;
            var cellPatternPosition = document.getElementById(getClientId(RowClientID, strPatternPosition)).value;
            var cellEmployeeNumber = document.getElementById(getClientId(RowClientID, strEmployee)).value;
            var cellRowNumber = document.getElementById(getClientId(RowClientID, strRowNumber)).innerText;
            var cellDefaultSite;
            var ColumnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var strDutyDate = "lblHeaderDutyDate" + ColumnIndex;
            var DutyDate = 'gvScheduleRoster_ctl01_' + strDutyDate;
            var strSoRank = 'A-Site1-SGS';
            var varDutyDate = document.getElementById(DutyDate).innerText

            if (cellShiftPatternCode == "")
            { cellDefaultSite = "0"; }
            else
            { cellDefaultSite = "1"; }

            if (cellEmployeeNumber == "")
            { alert(InvalidEmpCode); return; }
            var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
            AutoCompleteTextBox.ApplyWeekOff(document.getElementById('<%= HidCon.ClientID %>').value, SessionLocationAutoId, cellEmployeeNumber, DateInFormat(varDutyDate), "1", SessionUserId, document.getElementById('<%= txtAsmtCode.ClientID %>').value, cellShiftPatternCode, cellPatternPosition, cellDefaultSite, strSoRank, cellRowNumber, strPost, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, OnAppliedWO, OnWSRequestFailed);
        }

        function CopyToNextWeek() {

            /// ********* Copy selected text to clipbord **********
            CopiedTxt = document.selection.createRange();
            CopiedTxt.execCommand("Copy");
            var strDates = window.clipboardData.getData('Text');

            if (strDates.indexOf("$") < 0)  // for copy assignment
            {

                var arr2 = new Array;
                strDates = strDates.trim();
                arr2 = strDates.split("  ");
                for (var i = 0; i < arr2.length; i++) {
                    if (i == 0)
                    { strFromDate = arr2[i]; strToDate = arr2[i]; }
                    else
                    { strToDate = arr2[i]; }
                }
                strFromDate = strFromDate.substring(0, 11);
                strToDate = strToDate.substring(0, 11);

                AutoCompleteTextBox.AsmtScheduleCopy(document.getElementById('<%= HidCon.ClientID %>').value, "1", document.getElementById('<%= txtAsmtCode.ClientID %>').value, strFromDate, strToDate, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, SessionUserId, OnWSRequestComplete, OnWSRequestFailed);

            }
            else {

                var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
                var RowClientID = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
                var strEmployee = "txtEmpNumberDutyDate";
                var strShiftPatternCode = "txtShiftPatternCode";
                var strPatternPosition = "txtPatternPosition";
                var strRowNumber = "lblRowID";
                var cellShiftPatternCode = document.getElementById(getClientId(RowClientID, strShiftPatternCode)).value;
                var cellPatternPosition = document.getElementById(getClientId(RowClientID, strPatternPosition)).value;
                var cellEmployeeNumber = document.getElementById(getClientId(RowClientID, strEmployee)).value;
                var cellRowNumber = document.getElementById(getClientId(RowClientID, strRowNumber)).innerText;
                var cellDefaultSite;

                var strAutoIds = "";
                var strFromDate = "";
                var strToDate = "";

                arr = strDates.split("$");
                for (var i = 1; i < arr.length; i = i + 2) {
                    var arr1 = new Array;
                    arr1 = arr[i].split("#");
                    if (i == 1)
                    { strFromDate = arr1[1]; strToDate = arr1[1]; strAutoIds = arr1[0]; }
                    else
                    { strToDate = arr1[1]; strAutoIds = strAutoIds + "," + arr1[0]; }
                }

                if (strFromDate == "")
                { alert(Dataisnotcopiedproperly); return; }

                if (cellShiftPatternCode == "")
                { cellDefaultSite = "0"; }
                else
                { cellDefaultSite = "1"; }

                if (cellEmployeeNumber == "")
                { alert(InvalidEmpCode); return; }

                AutoCompleteTextBox.ScheduleCopy(document.getElementById('<%= HidCon.ClientID %>').value, "1", cellEmployeeNumber, strAutoIds, strFromDate, strToDate, cellShiftPatternCode, cellPatternPosition, cellDefaultSite, cellRowNumber, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, SessionUserId, OnWSRequestComplete, OnWSRequestFailed);
            }

        }

        function CopyRange() {

            /// Copy selected text to clipbord
            CopiedTxt = document.selection.createRange();
            CopiedTxt.execCommand("Copy");
            GlobStrCopyRange = window.clipboardData.getData('Text');
        }

        function PasteRange() {

            /// ********* Copy selected text to clipbord **********
            CopiedTxt = document.selection.createRange();
            CopiedTxt.execCommand("Copy");
            var strDates = window.clipboardData.getData('Text');

            var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
            var RowClientID = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var strEmployee = "txtEmpNumberDutyDate";
            var strShiftPatternCode = "txtShiftPatternCode";
            var strPatternPosition = "txtPatternPosition";
            var strRowNumber = "lblRowID";
            var cellShiftPatternCode = document.getElementById(getClientId(RowClientID, strShiftPatternCode)).value;
            var cellPatternPosition = document.getElementById(getClientId(RowClientID, strPatternPosition)).value;
            var cellEmployeeNumber = document.getElementById(getClientId(RowClientID, strEmployee)).value;
            var cellRowNumber = document.getElementById(getClientId(RowClientID, strRowNumber)).innerText;
            var cellDefaultSite;
            var strAutoIds = "";
            var strFromDate = "";
            var strToDate = "";

            var arr = new Array;
            arr = GlobStrCopyRange.split("$");

            for (var i = 1; i < arr.length; i = i + 2) {
                var arr1 = new Array;
                arr1 = arr[i].split("#");
                if (strAutoIds != "")
                    strAutoIds = strAutoIds + "," + arr1[0];
                else
                    strAutoIds = arr1[0];
            }

            if (strAutoIds == "")
            { alert(Dataisnotcopiedproperly); return; }

            arr = strDates.split("$");

            for (var i = 1; i < arr.length; i = i + 2) {
                var arr1 = new Array;
                arr1 = arr[i].split("#");
                if (i == 1)
                { strFromDate = arr1[1]; strToDate = arr1[1]; }
                else
                    strToDate = arr1[1];
            }

            if (strFromDate == "")
            { alert(Dataisnotcopiedproperly); return; }

            if (cellShiftPatternCode == "")
            { cellDefaultSite = "0"; }
            else
            { cellDefaultSite = "1"; }

            if (cellEmployeeNumber == "")
            { alert(InvalidEmpCode); return; }

            AutoCompleteTextBox.ScheduleCopy(document.getElementById('<%= HidCon.ClientID %>').value, "0", cellEmployeeNumber, strAutoIds, DateInFormat(strFromDate), DateInFormat(strToDate), cellShiftPatternCode, cellPatternPosition, cellDefaultSite, cellRowNumber, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, SessionUserId, OnWSRequestComplete, OnWSRequestFailed);

        }

        function OnAppliedWO() {

            ParentWindowFunction1();
        }

        function OnWSRequestComplete(result) {
            var res1 = result;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");

            var l = 0;
            var strTable;
            strTable = FollowingRecordscannotbecopied;

            var arr = new Array;
            var TMin = 0;
            for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {
                strTable = strTable + xmlDoc1.getElementsByTagName("DutyDate")[l].firstChild.nodeValue + "\t";
                strTable = strTable + xmlDoc1.getElementsByTagName("MessageString")[l].firstChild.nodeValue + "\n";

                l++;
            }

            if (l > 0) {
                alert(strTable);
            }
            else {
                alert(SuccessfullyCopied);
            }

            ParentWindowFunction1();
        }
        function OnWSRequestFailed(error) {
            alert(error.get_message());
        }

        //******************************************************************************************

        function ParentWindowFunction1() {
            document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
            if (document.getElementById('<%=ddlPost.ClientID %>').selectedIndex != -1) {
                document.getElementById('<%=HFPostText.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').options[document.getElementById('<%=ddlPost.ClientID %>').selectedIndex].text;
            }
            if (document.getElementById('<%=HFPost.ClientID %>').value == '') {
                document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
            }
            document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            document.getElementById('<%=btnProceed.ClientID %>').click();

            if (document.getElementById(GlobObjTofade) == '[object]') {
                var obj = document.getElementById(GlobObjTofade);
                if (obj.style.display == 'block') {
                    fade(GlobObjTofade, GlobObjfadeDisplay, GlobObjfadeImageObject, GlobObjfadeColumnIndex);
                }
            }
            return false;
        }
        function GetRowIDOnMouseClick(strRowID) {
            document.getElementById('<%=MouseClickRowID.ClientID %>').value = "";
            document.getElementById('<%=MouseClickRowID.ClientID %>').value = strRowID;

        }
        function GetColumnIndexOnMouseClick(strColumnIndex) {
            document.getElementById('<%=MouseClickColumnID.ClientID %>').value = "";
            document.getElementById('<%=MouseClickColumnID.ClientID %>').value = strColumnIndex;
        }
        function CreatePattern(strAsmtCode) {
            var PageName = "../Transactions/CreateShiftPattern.aspx?AsmtCode=" + strAsmtCode + "&Status=" + "CreatePattern"; ;
            var winW = 950;
            var winH = 500;
            var winX = (screen.availWidth - winW) / 2;
            var winY = (screen.availHeight - winH) / 2;
            var features = 'left=' + winX + ',top=' + winY + ',height=' + winH + ',' + 'width=' + winW + ',status=yes,' + 'toolbar=no,menubar=no,location=no';
            window.open(PageName, 'Search', features);
        }
        function CreatePatternSeq(strAsmtCode) {
            var PageName = "../Transactions/CreateShiftPatternSeq.aspx?AsmtCode=" + strAsmtCode + "&Status=" + "CreatePattern"; ;
            var winW = 850;
            var winH = 670;
            var winX = (screen.availWidth - winW) / 2;
            var winY = (screen.availHeight - winH) / 2;
            var features = 'left=' + winX + ',top=' + winY + ',height=' + winH + ',' + 'width=' + winW + ',status=yes,' + 'toolbar=no,menubar=no,location=no';
            window.open(PageName, 'Search', features);
        }
        function SwapDuty() {
            var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
            var RowClientID = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var ColumnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var SchRosterAutoID = "HFSchRosterAutoID" + ColumnIndex;
            var cellScheduleRosterAutoID = document.getElementById(getClientId(RowClientID, SchRosterAutoID)).value;

            if (cellScheduleRosterAutoID != '') {
                var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                var PageName = "../Transactions/SwapDuty.aspx?ScheduleRosterAutoID=" + cellScheduleRosterAutoID + "&AttendanceType=" + document.getElementById('<%=ddlAttendanceType.ClientID %>').value;
                var winW = 1000;
                var winH = 300;
                var winX = (screen.availWidth - winW) / 2;
                var winY = (screen.availHeight - winH) / 2;
                var features = 'left=' + winX + ',top=' + winY + ',height=' + winH + ',' + 'width=' + winW + ',status=yes,' + 'toolbar=no,menubar=no,location=no';
                window.open(PageName, 'Search', features);
            }
        }
        function JobBreakDownSummaryDetail() {
            //used when user click job break down button in the POP
            if (document.getElementById('HFJobBreakDownSchRosterAutoID').value != '') {
                var PageName = "../Transactions/JobBreakDownSummary.aspx?ScheduleRosterAutoID=" + document.getElementById('HFJobBreakDownSchRosterAutoID').value + "&AttendanceType=" + document.getElementById('<%=ddlAttendanceType.ClientID %>').value + "&AreaID=" + document.getElementById('<%=ddlArea.ClientID %>').value + "&FromDate=" + DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value) + "&ToDate=" + DateInFormat(document.getElementById('<%=HFToDate.ClientID %>').value);
                var winW = 950;
                var winH = 500;
                var winX = (screen.availWidth - winW) / 2;
                var winY = (screen.availHeight - winH) / 2;
                var features = 'left=' + winX + ',top=' + winY + ',height=' + winH + ',' + 'width=' + winW + ',status=yes,' + 'toolbar=no,menubar=no,location=no';
                window.open(PageName, 'Search', features);
            }
        }
        function JobBreakDownSummary() {
            var ColumnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var SchRosterAutoID = "HFSchRosterAutoID" + ColumnIndex;
            var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
            var RowClientID = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var cellScheduleRosterAutoID = document.getElementById(getClientId(RowClientID, SchRosterAutoID)).value;

            if (cellScheduleRosterAutoID != '') {
                var PageName = "../Transactions/JobBreakDownSummary.aspx?ScheduleRosterAutoID=" + cellScheduleRosterAutoID + "&AttendanceType=" + document.getElementById('<%=ddlAttendanceType.ClientID %>').value + "&AreaID=" + document.getElementById('<%=ddlArea.ClientID %>').value + "&FromDate=" + DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value) + "&ToDate=" + DateInFormat(document.getElementById('<%=HFToDate.ClientID %>').value);
                var winW = 950;
                var winH = 500;
                var winX = (screen.availWidth - winW) / 2;
                var winY = (screen.availHeight - winH) / 2;
                var features = 'left=' + winX + ',top=' + winY + ',height=' + winH + ',' + 'width=' + winW + ',status=yes,' + 'toolbar=no,menubar=no,location=no';
                window.open(PageName, 'Search', features);
            }
        }
        function ApplyWeekOFF() {
            var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
            var RowClientID = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var strEmployee = "txtEmpNumberDutyDate";
            var strShiftPatternCode = "txtShiftPatternCode";
            var strPatternPosition = "txtPatternPosition";
            var strDefaultSite = "CBIsDefaultSite";
            var cellShiftPatternCode = getClientId(RowClientID, strShiftPatternCode);
            var cellPatternPosition = getClientId(RowClientID, strPatternPosition);
            var cellEmployeeNumber = getClientId(RowClientID, strEmployee);
            var cellDefaultSite = getClientId(RowClientID, strDefaultSite);

            var varAsmtCode = document.getElementById('<%=txtAsmtCode.ClientID %>').value;
            var strSoRank = 'Guard';
            if (document.getElementById(cellEmployeeNumber).value != "") {

                var PageName = "SchEmpWiseDefineWeekOff_AnEmp.aspx?EmployeeNumber=" + document.getElementById(cellEmployeeNumber).value + "&FromDate=" + DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value) + "&ToDate=" + DateInFormat(document.getElementById('<%=HFToDate.ClientID %>').value) + "&AsmtCode=" + varAsmtCode + "&ShiftPatternCode=" + document.getElementById(cellShiftPatternCode).value + "&PatternPosition=" + document.getElementById(cellPatternPosition).value + "&DefaultSite=" + document.getElementById(cellDefaultSite).checked + "&SoRank=" + strSoRank;
                var winW = 950;
                var winH = 500;
                var winX = (screen.availWidth - winW) / 2;
                var winY = (screen.availHeight - winH) / 2;
                var features = 'left=' + winX + ',top=' + winY + ',height=' + winH + ',' + 'width=' + winW + ',status=yes,' + 'toolbar=no,menubar=no,location=no';
                window.open(PageName, 'Search', features);
            }
        }

        function ApplyLeave() {

            var gvScheduleRoster = document.getElementById('<%= gvScheduleRoster.ClientID %>');
            var RowClientID = gvScheduleRoster.rows[parseInt(document.getElementById('<%=MouseClickRowID.ClientID %>').value) + 1].cells[0].childNodes[0];
            var strEmployee = "txtEmpNumberDutyDate";
            var strShiftPatternCode = "txtShiftPatternCode";
            var strPatternPosition = "txtPatternPosition";
            var strDefaultSite = "CBIsDefaultSite";
            var cellEmployeeNumber = getClientId(RowClientID, strEmployee);
            var cellShiftPatternCode = getClientId(RowClientID, strShiftPatternCode);
            var cellPatternPosition = getClientId(RowClientID, strPatternPosition);
            var cellEmployeeNumber = getClientId(RowClientID, strEmployee);
            var cellDefaultSite = getClientId(RowClientID, strDefaultSite);
            var ColumnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var strDutyDate = "lblHeaderDutyDate" + ColumnIndex;
            var DutyDate = 'gvScheduleRoster_ctl01_' + strDutyDate;
            var strRowNumber = "lblRowID";
            var cellRowNumber = document.getElementById(getClientId(RowClientID, strRowNumber)).innerText;
            var ColumnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var strDutyDate = "lblHeaderDutyDate" + ColumnIndex;
            var DutyDate = 'gvScheduleRoster_ctl01_' + strDutyDate;

            if (document.getElementById(DutyDate).innerText != "" && document.getElementById(cellEmployeeNumber).value != "") {
                var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                var PageName = "../HRManagement/LeaveApplicationAndPosting.aspx?EmployeeNumber=" + document.getElementById(cellEmployeeNumber).value + "&DutyDate=" + DateInFormat(document.getElementById(DutyDate).innerText) + "&AsmtCode=" + document.getElementById('<%=txtAsmtCode.ClientID %>').value + "&ShiftPatternCode=" + document.getElementById(cellShiftPatternCode).value + "&PatternCode=" + document.getElementById(cellPatternPosition).value + "&DefaultSite=" + document.getElementById(cellDefaultSite).value + "&RowNumber=" + cellRowNumber + "&AttendanceType=" + document.getElementById('<%=ddlAttendanceType.ClientID %>').value + "&Post=" + strPost;
                var winW = 950;
                var winH = 500;
                var winX = (screen.availWidth - winW) / 2;
                var winY = (screen.availHeight - winH) / 2;
                var features = 'left=' + winX + ',top=' + winY + ',height=' + winH + ',' + 'width=' + winW + ',status=yes,' + 'toolbar=no,menubar=no,location=no';
                window.open(PageName, 'Search', features);
            }
        }
        function SearchEmployeeSkillWise(strEmployee) {
            var elPd = document.getElementById('<%=ddlPost.ClientID %>').value; //document.getElementById('hidPdLineNo' + i).value;
            var elEmp = strEmployee;
            //Area ID Added to search on selected Area
            var PageName = "../search/EmployeeWiseAdvanceSearch.aspx?AsmtMasterAutoID=" + document.getElementById('<% =AsmtId.ClientID %>').value + "&PostCode=" + elPd + "&SoRank=&FromDate=" + DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value) + "&ToDate=" + DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value) + "&ControlId=" + elEmp + "&AttendanceType=" + document.getElementById('<%=ddlAttendanceType.ClientID %>').value + "&AreaID=" + document.getElementById('<%=ddlArea.ClientID %>').value;
            var winW = 1300;
            var winH = 580;
            var winX = (screen.availWidth - winW) / 2;
            var winY = (screen.availHeight - winH) / 2;
            var features = 'left=' + winX + ',top=' + winY + ',height=' + winH + ',' + 'width=' + winW + ',status=yes,' + 'toolbar=no,menubar=no,location=no';
            window.open(PageName, 'Search', features);

        }

        function HideDivs() {
            if (document.getElementById('divShift') == "[object]") {
                if (document.getElementById('divShift').style.display != "none") {
                    document.getElementById('divShift').style.display = "none";
                }
            }
            if (document.getElementById('diveRole') == "[object]") {
                if (document.getElementById('diveRole').style.display != "none") {
                    document.getElementById('diveRole').style.display = "none";
                }
            }
            if (document.getElementById('DivDutyType') == "[object]") {
                if (document.getElementById('DivDutyType').style.display != "none") {
                    document.getElementById('DivDutyType').style.display = "none";
                }
            }

            if (document.getElementById('divEmployeeContainer') == "[object]") {
                if (document.getElementById('divEmployeeContainer').style.display != "none") {
                    document.getElementById('divEmployeeContainer').style.display = "none";
                }
            }
            if (document.getElementById('DivShiftPatterns') == "[object]") {
                if (document.getElementById('DivShiftPatterns').style.display != "none") {
                    document.getElementById('DivShiftPatterns').style.display = "none";
                }
            }
            if (document.getElementById('DIVPostSearch') == "[object]") {
                if (document.getElementById('DIVPostSearch').style.display != "none") {
                    document.getElementById('DIVPostSearch').style.display = "none";
                }
            }
        }
        function GetReqSch() {
            if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Sch') {
                document.getElementById('divManPowerReq').style.display = 'block';
                var w = document.getElementById('<% =ddAssignment.ClientID %>').selectedIndex;
                if (w > 0) {
                    var SelectedAsmtDetails = document.getElementById('<% =ddAssignment.ClientID %>').options[w].value;
                    var arr = new Array;
                    arr = SelectedAsmtDetails.split("$");
                    document.getElementById('<% =AsmtId.ClientID %>').value = arr[1];
                    // Added document.getElementById('<% =ddlPost.ClientID %>').value to Show Req and Schedule Hrs Post Wise
                    GetManPowerReqAjax(document.getElementById('<% =txtAsmtCode.ClientID %>').value, document.getElementById('<% =AsmtId.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), document.getElementById('<% =ddlPost.ClientID %>').value, document.getElementById('<% =ddlScheduleType.ClientID %>').value, document.getElementById('<% =ddlWeek.ClientID %>').value);
                    return true;
                }
            }
            else {
                document.getElementById('divManPowerReq').innerHTML = '';
                document.getElementById('divManPowerReq').style.display = 'none';
            }

        }
        function FillReqSch(strOutput) {
            if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Sch') {
                document.getElementById('divManPowerReq').innerHTML = strOutput;
            }
            ShowAllAsmtShifts();
            return true;
        }

        //Functions Related to Move the DIv
        var pickedUp = new Array("", false);
        function MoveDuplicateMsgDiv(element, evt) {
            pickedUp[0] = document.getElementById(element).id; //element;
            pickedUp[1] = true;
        }

        function checkLoadedObjects(evt) {
            if (pickedUp[1] == true) {
                var currentSelection = document.getElementById(pickedUp[0]);
                currentSelection.style.position = "absolute";
                currentSelection.style.top = (evt.clientY - 50) + "px";
                currentSelection.style.left = (evt.clientX - 120) + "px";
            }
        }

        function dropLoadedObject(evt) {
            if (pickedUp[1] == true) {
                var currentSelection = document.getElementById(pickedUp[0]);
                currentSelection.style.position = "absolute";
                currentSelection.style.top = (evt.clientY - 50) + "px";
                currentSelection.style.left = (evt.clientX - 120) + "px";
                pickedUp = new Array("", false);
            }
        }
        //=======================================
        //Function Related to Close of DIV [Overwrite]
        function CloseMsgBoxShift() {
            if (document.getElementById('DivCopyDetails').style.display == 'block') {
                document.getElementById('DivCopyDetails').style.display = 'none'
            }
            document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
            if (document.getElementById('<%=ddlPost.ClientID %>').selectedIndex != -1) {
                document.getElementById('<%=HFPostText.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').options[document.getElementById('<%=ddlPost.ClientID %>').selectedIndex].text;
            }
            document.getElementById('DivOverWriteShift').style.display = "none";
            document.getElementById('DIVMultipleOverwrite').style.display = "none";

            document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            document.getElementById('<%=btnProceed.ClientID %>').click();

            var strScreenType = document.getElementById('<%=ddlAttendanceType.ClientID %>').value;

            AutoCompleteTextBox.GetExceptionRecords(document.getElementById('<%= HidCon.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFMaxDate.ClientID %>').value), document.getElementById('<% =txtAsmtCode.ClientID %>').value, document.getElementById('<%= HFCurrentSessionID.ClientID %>').value, SessionLocationAutoId, strScreenType, document.getElementById(GlobEmployeeNumber).value, SessionUserId, OnGetExceptionRecordsComplete, OnWSRequestFailed);
            return;
        }
        //=======================================
        // Find The position to display the dropdown
        //=======================================
        function findPos(obj) {
            var curleft = curtop = 0;
            if (obj.offsetParent) {
                curleft = obj.offsetLeft
                curtop = obj.offsetTop
                while (obj = obj.offsetParent) {
                    curleft += obj.offsetLeft
                    curtop += obj.offsetTop
                }
            }
            return [curleft, curtop];
        }
        //=======================================
        // Function To Search Employee Number in the dropDown
        //=======================================
        function SearchEmployee(obj) {
            var ColumnIndex = parseInt(document.getElementById('<%=HFColumnIndex.ClientID %>').value) - 1;

            var strEmployee = "txtEmpNumberDutyDate";
            var strEmployeeName = "txtEmpNameDutyDate";
            var el_Employee = getClientId(obj, strEmployee);
            var EmployeeNameClientID = getClientId(obj, strEmployeeName);
            GlobEmployeeNumber = el_Employee;
            GlobEmployeeName = EmployeeNameClientID;
            var el_List = document.getElementById('<% =LBEmployeeList.ClientID %>');
            var el_EmpList = document.getElementById('<% =ddlEmployees.ClientID %>');
            try {
                if (window.event.keyCode == 13) {
                    if (el_List.selectedIndex > -1) {
                        document.getElementById(el_Employee).value = el_List.options[el_List.selectedIndex].value;
                        document.getElementById(EmployeeNameClientID).value = el_List.options[el_List.selectedIndex].text;
                        document.getElementById('divEmployeeContainer').style.display = "none";
                        GlobEmployeeName = getClientId(document.getElementById(el_Employee), "txtEmpNameDutyDate");
                        GlobEmployeeDesgDesc = getClientId(document.getElementById(el_Employee), "txtEmpDesignationDesc");
                        GlobEmployeeDesgCode = getClientId(document.getElementById(el_Employee), "HFDesignationCode");
                        var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                        //Added Area ID option to search only those employee that belongs to that Area
                        var strScreenType;
                        if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {
                            strScreenType = 'ACT'
                        }
                        else {
                            strScreenType = 'SCH'
                        }
                        GetEmpName(document.getElementById(el_Employee).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), strPost, 'GETEMP', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType);

                    }
                    return;
                }
                else if (window.event.keyCode == 40) {
                    if (document.getElementById('divEmployeeContainer').style.display == "block") {
                        el_List.focus();
                    }
                    return;
                }
                else if (window.event.keyCode == 9) {
                    return;
                }
                else if (window.event.keyCode == 0 && el_List.length > 0) /////// on blur
                {
                    document.getElementById('divEmployeeContainer').style.display = "block";
                    if (el_List.selectedIndex > -1) {
                        document.getElementById(el_Employee).value = el_List.options[el_List.selectedIndex].value;
                        document.getElementById(EmployeeNameClientID).value = el_List.options[el_List.selectedIndex].text;

                        GlobEmployeeName = getClientId(document.getElementById(el_Employee), "txtEmpNameDutyDate");
                        GlobEmployeeDesgDesc = getClientId(document.getElementById(el_Employee), "txtEmpDesignationDesc");
                        GlobEmployeeDesgCode = getClientId(document.getElementById(el_Employee), "HFDesignationCode");
                        var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                        //Added Area ID option to search only those employee that belongs to that Area
                        var strScreenType;
                        if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {
                            strScreenType = 'ACT'
                        }
                        else {
                            strScreenType = 'SCH'
                        }
                        GetEmpName(document.getElementById(el_Employee).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), strPost, 'GETEMP', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType);

                    }
                    el_List.selectedIndex = -1
                    return;
                }
                else {
                    if (window.event.keyCode == 0) {
                        document.getElementById('divEmployeeContainer').style.display = "block";
                        return;
                    }
                    var lyr = document.getElementById('divEmployeeContainer');
                    var coors = findPos(document.getElementById(el_Employee));
                    lyr.style.top = coors[1] + 20 + 'px';
                    lyr.style.left = coors[0] + 'px';
                    document.getElementById('divEmployeeContainer').style.display = "block";
                    var j = 0;
                    j = FindIndex(el_EmpList, 0, el_EmpList.length, document.getElementById(EmployeeNameClientID).value.toLowerCase());
                    el_List.length = 0;
                    for (i = j; i < j + 50 && i < el_EmpList.length; i++) {
                        if (el_EmpList.options[i].text.toLowerCase().substr(0, document.getElementById(EmployeeNameClientID).value.length) == document.getElementById(EmployeeNameClientID).value.toLowerCase()) {
                            el_List.options.add(new Option(el_EmpList.options[i].text, el_EmpList.options[i].value));
                            el_List.selectedIndex = 0;
                        }
                    }
                }
            }

            catch (Error) { return; }

        }
        function FindIndex(objList, Indx, EIndx, str) {
            if (objList.options[Indx].text.toLowerCase().substr(0, str.length) < str) {
                Indx = Indx + (EIndx - Indx) / 2;
                if (EIndx - Indx > 20)
                { return FindIndex(objList, Indx, EIndx, str); }
                else if (Indx < 20)
                { return 0; }
                else
                { return Indx - 20; }
            }
            else if (objList.options[Indx].text.toLowerCase().substr(0, str.length) >= str) {

                if (Indx - (EIndx - Indx) >= 0)
                { return FindIndex(objList, Indx - (EIndx - Indx), Indx, str); }
                else
                { return 0; }
            }
        }
        //=======================================
        //Function Used to select EmployeeNumber After Searchin Drop Down
        //=======================================
        function SelectEmployee(obj) {

            var el = GlobEmployeeNumber;
            var EmployeeNameClientID = GlobEmployeeName;
            if (obj.selectedIndex >= 0) {
                document.getElementById(el).value = obj.options[obj.selectedIndex].value;
                document.getElementById(EmployeeNameClientID).value = obj.options[obj.selectedIndex].text;
                document.getElementById(el).focus();
                document.getElementById('divEmployeeContainer').style.display = "none";
                GlobEmployeeName = getClientId(document.getElementById(el), "txtEmpNameDutyDate");
                GlobEmployeeDesgDesc = getClientId(document.getElementById(el), "txtEmpDesignationDesc");
                GlobEmployeeDesgCode = getClientId(document.getElementById(el), "HFDesignationCode");
                var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                //Added Area ID option to search only those employee that belongs to that Area
                var strScreenType;
                if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {
                    strScreenType = 'ACT'
                }
                else {
                    strScreenType = 'SCH'
                }
                GetEmpName(document.getElementById(el).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), strPost, 'GETEMP', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType);

            }
            return;
        }
        //=======================================
        //Function Used to Search Role In Drop Down
        //=======================================
        function SearchRole(obj) {
            var ColumnIndex = parseInt(document.getElementById('<%=HFColumnIndex.ClientID %>').value) - 1;
            var strRole = "txtEmpRoleDesc" + ColumnIndex;
            var el_Roll = getClientId(obj, strRole);
            var strHiddenRoleCode = "HFRoleCode" + ColumnIndex;
            var el_hideRole = getClientId(obj, strHiddenRoleCode);
            GlobEmployeeRoleDesc = el_Roll;
            var el_List = document.getElementById('<% =LBRole.ClientID %>');
            if (window.event.keyCode == 13) {
                if (el_List.selectedIndex > -1) {
                    document.getElementById(el_Roll).value = el_List.options[el_List.selectedIndex].text;
                    document.getElementById('<%=HFNewRoleCode.ClientID %>').value = el_List.options[el_List.selectedIndex].value;
                    document.getElementById('diveRole').style.display = "none";
                }
                return;
            }
            else if (window.event.keyCode == 40) {
                if (document.getElementById('diveRole').style.display == "block") {
                    el_List.focus();
                }
                return;
            }
            else if (window.event.keyCode == 9) {
                return;
            }
            else if (window.event.keyCode == 0 && el_List.length > 0) /////// on blur
            {
                if (el_List.selectedIndex > -1) {
                    document.getElementById(el_Roll).value = el_List.options[el_List.selectedIndex].text;
                    document.getElementById('<%=HFNewRoleCode.ClientID %>').value = el_List.options[el_List.selectedIndex].value;
                }
                if (document.activeElement.id.search("Role") < 0) {
                    document.getElementById('diveRole').style.display = "none";
                }
                document.getElementById('diveRole').style.display = "none";
                el_List.selectedIndex = -1
                return;
            }
            else {
                if (window.event.keyCode == 0)
                { return; }
                var lyr = document.getElementById('diveRole');
                var coors = findPos(document.getElementById(el_Roll));
                lyr.style.top = coors[1] + 20 + 'px';
                lyr.style.left = coors[0] + 'px';
                document.getElementById('diveRole').style.display = "block";
                el_List.selectedIndex = -1;
                for (i = 0; i < el_List.length; i++) {
                    if (el_List.options[i].text.toLowerCase().substr(0, document.getElementById(el_Roll).value.length) == document.getElementById(el_Roll).value.toLowerCase()) {
                        el_List.options[i].selected = true;
                        return;
                    }
                }
            }
        }
        //=======================================
        //Function Used to select Role After Searchin Drop Down
        //=======================================
        function selectRole(obj) {
            var el = GlobEmployeeRoleDesc
            if (obj.selectedIndex >= 0) {
                document.getElementById(el).value = obj.options[obj.selectedIndex].text;
                document.getElementById(el).focus();
                document.getElementById('diveRole').style.display = "none";
            }
            document.getElementById('diveRole').style.display = "none";
            return;
        }
        // Function to Search Role For Footer
        function SearchRoleFooter(obj) {
            var el_Roll = obj.id;
            GlobEmployeeRoleDesc = el_Roll;
            var el_List = document.getElementById('<% =LBRole.ClientID %>');
            if (window.event.keyCode == 13) {
                if (el_List.selectedIndex > -1) {
                    document.getElementById(el_Roll).value = el_List.options[el_List.selectedIndex].text;
                    document.getElementById('<%=HFNewRoleCode.ClientID %>').value = el_List.options[el_List.selectedIndex].value;
                    document.getElementById('diveRole').style.display = "none";
                }
                return;
            }
            else if (window.event.keyCode == 40) {
                if (document.getElementById('diveRole').style.display == "block") {
                    el_List.focus();
                }
                return;
            }
            else if (window.event.keyCode == 9) {
                return;
            }
            else if (window.event.keyCode == 0 && el_List.length > 0) /////// on blur
            {
                if (el_List.selectedIndex > -1) {
                    document.getElementById(el_Roll).value = el_List.options[el_List.selectedIndex].text;
                    document.getElementById('<%=HFNewRoleCode.ClientID %>').value = el_List.options[el_List.selectedIndex].value;
                }

                if (document.activeElement.id.search("Role") < 0) {
                    document.getElementById('diveRole').style.display = "none";
                }
                document.getElementById('diveRole').style.display = "none";
                el_List.selectedIndex = -1
                return;
            }
            else {
                if (window.event.keyCode == 0)
                { return; }
                var lyr = document.getElementById('diveRole');
                var coors = findPos(document.getElementById(el_Roll));
                lyr.style.top = coors[1] + 20 + 'px';
                lyr.style.left = coors[0] + 'px';
                document.getElementById('diveRole').style.display = "block";
                el_List.selectedIndex = -1;
                for (i = 0; i < el_List.length; i++) {
                    if (el_List.options[i].text.toLowerCase().substr(0, document.getElementById(el_Roll).value.length) == document.getElementById(el_Roll).value.toLowerCase()) {
                        el_List.options[i].selected = true;
                        return;
                    }
                }
            }
        }
        //=======================================
        //Function Used to Search Shift In Drop Down
        //=======================================
        function SearchShiftFooter(obj) {
            var ColumnIndex;
            var strReversedString = obj.id.split('').reverse().join('');
            ColumnIndex = strReversedString.substring(0, 2);
            if (isNaN(ColumnIndex)) {
                ColumnIndex = strReversedString.substring(0, 1);
            }
            else {
                ColumnIndex = ColumnIndex.toString().split('').reverse().join('');
            }
            var strDutyDate = "lblHeaderDutyDate" + ColumnIndex;
            var DutyDate = 'gvScheduleRoster_ctl01_' + strDutyDate;
            GlobObject = obj;
            AutoCompleteTextBox.GetAllShiftsOfDay(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById('<%= txtAsmtCode.ClientID %>').value, SessionLocationAutoId, DateInFormat(document.getElementById(DutyDate).innerText), document.getElementById('<%=ddlWeek.ClientID %>').value, document.getElementById('<%=ddlPost.ClientID %>').value, OnGetAllShiftWSRequestComplete, OnGetAllShiftWSRequestFailed);
            GlobKeyCode = window.event.keyCode;
        }
        //=======================================
        //Function Used to Search Shift In Drop Down
        //=======================================
        function OnGetAllShiftWSRequestComplete(result) {
            var ColumnIndex;
            var strReversedString = GlobObject.id.split('').reverse().join('');
            ColumnIndex = strReversedString.substring(0, 2);
            if (isNaN(ColumnIndex)) {
                ColumnIndex = strReversedString.substring(0, 1);
            }
            else {
                ColumnIndex = ColumnIndex.toString().split('').reverse().join('');
            }
            var res1 = result;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");

            var l = 0;
            document.getElementById('<% =LBShift.ClientID %>').length = 0;
            for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {
                var Option = document.createElement("OPTION");
                Option.text = xmlDoc1.getElementsByTagName("ShiftDetails")[l].firstChild.nodeValue;
                Option.value = xmlDoc1.getElementsByTagName("PDLineNo")[l].firstChild.nodeValue;
                document.getElementById('<% =LBShift.ClientID %>').options.add(Option);
                l++;
            }
            document.getElementById('<% =LBShift.ClientID %>').selectedIndex = -1;

            //********************************************
            var el_List = document.getElementById('<% =LBShift.ClientID %>');
            var strTimeFrom = getClientId(GlobObject, "txtTimeFrom" + ColumnIndex);
            var strTimeTo = getClientId(GlobObject, "txtTimeTo" + ColumnIndex);
            GlobEmployeeTimeFrom = strTimeFrom;
            GlobEmployeeTimeTo = strTimeTo;
            var strShift = "txtEmpShiftDutyDate" + ColumnIndex;
            var el_Shift = getClientId(GlobObject, strShift);
            GlobEmployeeShiftCode = el_Shift;

            if (GlobKeyCode == 13) {
                if (el_List.selectedIndex > -1) {
                    document.getElementById(el_Shift).value = el_List.options[el_List.selectedIndex].text.substring(0, 1);
                    document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value = document.getElementById(el_Shift).value;
                    document.getElementById('<%=HFNewPDLineNo.ClientID %>').value = el_List.options[el_List.selectedIndex].value;
                    var arr = new Array;
                    arr = el_List.options[el_List.selectedIndex].text.split("[");
                    var arr1 = new Array;
                    arr1 = arr[1].split('/');
                    var arrTimeDetail = arr1[0].split('-');
                    document.getElementById(GlobEmployeeTimeFrom).value = arrTimeDetail[0];
                    document.getElementById(GlobEmployeeTimeTo).value = arrTimeDetail[1];
                    document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = arrTimeDetail[0];
                    document.getElementById('<%=HFNewTimeTo.ClientID %>').value = arrTimeDetail[1];
                    document.getElementById('divShift').style.display = "none";
                }
                return;
            }
            else if (GlobKeyCode == 40) {
                if (document.getElementById('divShift').style.display == "block") {
                    el_List.focus();
                }
                return;
            }
            else if (GlobKeyCode == 9) {
                if (document.getElementById(el_Shift).value != "") {
                    try {
                        document.getElementById(el_Shift).value = el_List.options[el_List.selectedIndex].text.substring(0, 1);
                        document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value = document.getElementById(el_Shift).value;
                        document.getElementById('<%=HFNewPDLineNo.ClientID %>').value = el_List.options[el_List.selectedIndex].value;
                        var arr = new Array;
                        arr = el_List.options[el_List.selectedIndex].text.split("[");
                        var arr1 = new Array;
                        arr1 = arr[1].split('/');
                        var arrTimeDetail = arr1[0].split('-');
                        document.getElementById(GlobEmployeeTimeFrom).value = arrTimeDetail[0];
                        document.getElementById(GlobEmployeeTimeTo).value = arrTimeDetail[1];
                        document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = arrTimeDetail[0];
                        document.getElementById('<%=HFNewTimeTo.ClientID %>').value = arrTimeDetail[1];
                        document.getElementById('divShift').style.display = "none";
                        return;
                    }
                    catch (Error) { return; }
                }
            }
            else if (GlobKeyCode == 0 && el_List.length > 0) /////// on blur
            {
                if (el_List.selectedIndex > -1) {
                    document.getElementById(el_Shift).value = el_List.options[el_List.selectedIndex].text.substring(0, 1);
                    document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value = document.getElementById(el_Shift).value;
                    document.getElementById('<%=HFNewPDLineNo.ClientID %>').value = el_List.options[el_List.selectedIndex].value;
                    var arr = new Array;
                    arr = el_List.options[el_List.selectedIndex].text.split("[");
                    var arr1 = new Array;
                    arr1 = arr[1].split('/');
                    var arrTimeDetail = arr1[0].split('-');
                    document.getElementById(GlobEmployeeTimeFrom).value = arrTimeDetail[0];
                    document.getElementById(GlobEmployeeTimeTo).value = arrTimeDetail[1];
                    document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = arrTimeDetail[0];
                    document.getElementById('<%=HFNewTimeTo.ClientID %>').value = arrTimeDetail[1];
                }
                document.getElementById('divShift').style.display = "none";
                el_List.selectedIndex = -1
                return;
            }
            else {
                if (GlobKeyCode == 0)
                { return; }
                var lyr = document.getElementById('divShift');
                var coors = findPos(document.getElementById(el_Shift));
                lyr.style.top = coors[1] + 20 + 'px';
                lyr.style.left = coors[0] + 'px';
                document.getElementById('divShift').style.display = "block";
                el_List.selectedIndex = -1;
                for (i = 0; i < el_List.length; i++) {
                    if (el_List.options[i].text.toLowerCase().substr(0, document.getElementById(el_Shift).value.length) == document.getElementById(el_Shift).value.toLowerCase()) {
                        el_List.options[i].selected = true;
                        return;
                    }
                }
            }

            //**************************************************

        }

        function OnGetAllShiftWSRequestFailed() {

        }
        var GlobKeyCode;
        function SearchShift(obj) {
            var ColumnIndex;
            var strReversedString = obj.id.split('').reverse().join('');
            ColumnIndex = strReversedString.substring(0, 2);
            if (isNaN(ColumnIndex)) {
                ColumnIndex = strReversedString.substring(0, 1);
            }
            else {
                ColumnIndex = ColumnIndex.toString().split('').reverse().join('');
            }
            var strDutyDate = "lblHeaderDutyDate" + ColumnIndex;
            var DutyDate = 'gvScheduleRoster_ctl01_' + strDutyDate;
            GlobObject = obj;
            AutoCompleteTextBox.GetAllShiftsOfDay(document.getElementById('<%= HidCon.ClientID %>').value, document.getElementById('<%= txtAsmtCode.ClientID %>').value, SessionLocationAutoId, DateInFormat(document.getElementById(DutyDate).innerText), document.getElementById('<%=ddlWeek.ClientID %>').value, document.getElementById('<%=ddlPost.ClientID %>').value, OnGetAllShiftWSRequestComplete, OnGetAllShiftWSRequestFailed);
            GlobKeyCode = window.event.keyCode;
        }
        //=======================================
        //Function Used to select Shift After Searchin Drop Down
        //=======================================
        function SelectShift(obj) {
            var el = GlobEmployeeShiftCode;
            if (obj.selectedIndex >= 0) {
                var arr = new Array;
                arr = obj.options[obj.selectedIndex].text.split("[");
                var arr1 = new Array;
                arr1 = arr[1].split('/');
                var arrTimeDetail = arr1[0].split('-');
                document.getElementById(el).value = obj.options[obj.selectedIndex].text.substring(0, 1);
                document.getElementById(el).focus();
                document.getElementById(GlobEmployeeTimeFrom).value = arrTimeDetail[0];
                document.getElementById(GlobEmployeeTimeTo).value = arrTimeDetail[1];
                document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = arrTimeDetail[0];
                document.getElementById('<%=HFNewTimeTo.ClientID %>').value = arrTimeDetail[1];
                document.getElementById('<%=HFNewPDLineNo.ClientID %>').value = obj.options[obj.selectedIndex].value;
                document.getElementById('divShift').style.display = "none";
            }
            return;
        }
        //=======================================
        //Function Used to Search Shift Pattern In Drop Down
        //=======================================
        function SearchShiftPattern(obj) {
            var strShiftPatternCode = "txtShiftPatternCode";
            var el_ShiftPatternCode = getClientId(obj, strShiftPatternCode);
            GlobShiftPatternCode = el_ShiftPatternCode;
            var el_List = document.getElementById('<% =LBShiftPatterns.ClientID %>');
            if (window.event.keyCode == 13) {
                if (el_List.selectedIndex > -1) {
                    GlobPDLineWiseShiftPatternCode = el_List.options[el_List.selectedIndex].value;
                    document.getElementById(el_ShiftPatternCode).value = el_List.options[el_List.selectedIndex].text;
                    document.getElementById('DivShiftPatterns').style.display = "none";
                }
                return;
            }
            else if (window.event.keyCode == 40) {
                if (document.getElementById('DivShiftPatterns').style.display == "block") {
                    el_List.focus();
                }
                return;

            }
            else if (window.event.keyCode == 9) {
                return;
            }
            else if (window.event.keyCode == 0 && el_List.length > 0) /////// on blur
            {
                document.getElementById('DivShiftPatterns').style.display = "block";
                if (el_List.selectedIndex > -1) {
                    GlobPDLineWiseShiftPatternCode = el_List.options[el_List.selectedIndex].value;
                    document.getElementById(el_ShiftPatternCode).value = el_List.options[el_List.selectedIndex].text;
                }
                el_List.selectedIndex = -1
                return;
            }
            else {
                if (window.event.keyCode == 0) {
                    document.getElementById('DivShiftPatterns').style.display = "block";
                    return;
                }
                var lyr = document.getElementById('DivShiftPatterns');
                var coors = findPos(document.getElementById(el_ShiftPatternCode));
                lyr.style.top = coors[1] + 20 + 'px';
                lyr.style.left = coors[0] + 'px';
                document.getElementById('DivShiftPatterns').style.display = "block";
                el_List.selectedIndex = -1;
                for (i = 0; i < el_List.length; i++) {
                    if (el_List.options[i].text.toLowerCase().substr(0, document.getElementById(el_ShiftPatternCode).value.length) == document.getElementById(el_ShiftPatternCode).value.toLowerCase()) {
                        el_List.options[i].selected = true;
                        return;
                    }
                }
            }
        }
        //=======================================
        //Function Used to select Shift Pattern After Searchin Drop Down
        //=======================================
        function SelectShiftPattern(obj) {
            var el = GlobShiftPatternCode;
            if (obj.selectedIndex >= 0) {
                GlobPDLineWiseShiftPatternCode = obj.options[obj.selectedIndex].value;
                document.getElementById(el).value = obj.options[obj.selectedIndex].text;
                document.getElementById(el).focus();
                document.getElementById('DivShiftPatterns').style.display = "none";
            }
            return;
        }
        //=======================================
        //Function Used to Search Duty Type in Footer in the Drop Down
        //=======================================
//        function SearchDutyTypeFooter(obj) {
//            var el_Roll = obj.id;
//            GlobEmployeeDutyType = el_Roll;
//            var el_List = document.getElementById('<% =LBDutyType.ClientID %>');
//            if (window.event.keyCode == 13) {
//                if (el_List.selectedIndex > -1) {
//                    document.getElementById(el_Roll).value = el_List.options[el_List.selectedIndex].text;
//                    document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value = el_List.options[el_List.selectedIndex].value;
//                    document.getElementById('DivDutyType').style.display = "none";
//                }
//                return;
//            }
//            else if (window.event.keyCode == 40) {
//                if (document.getElementById('DivDutyType').style.display == "block") {
//                    el_List.focus();
//                }
//                return;
//            }
//            else if (window.event.keyCode == 9) {
//                return;
//            }
//            else if (window.event.keyCode == 0 && el_List.length > 0) /////// on blur
//            {
//                if (el_List.selectedIndex > -1) {
//                    document.getElementById(el_Roll).value = el_List.options[el_List.selectedIndex].text;
//                    document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value = el_List.options[el_List.selectedIndex].value;
//                }
//                el_List.selectedIndex = -1
//                return;
//            }
//            else {
//                if (window.event.keyCode == 0)
//                { return; }
//                var lyr = document.getElementById('DivDutyType');
//                var coors = findPos(document.getElementById(el_Roll));
//                lyr.style.top = coors[1] + 20 + 'px';
//                lyr.style.left = coors[0] + 'px';
//                document.getElementById('DivDutyType').style.display = "block";

//                el_List.selectedIndex = -1;
//                for (i = 0; i < el_List.length; i++) {
//                    if (el_List.options[i].text.toLowerCase().substr(0, document.getElementById(el_Roll).value.length) == document.getElementById(el_Roll).value.toLowerCase()) {
//                        el_List.options[i].selected = true;
//                        return;
//                    }
//                }
//            }
//        }
//        //=======================================
//        //Function Used to Search Duty Type in the Drop Down
//        //=======================================
//        function SearchDutyType(obj) {
//            var ColumnIndex = parseInt(document.getElementById('<%=HFColumnIndex.ClientID %>').value) - 1;
//            var strRole = "txtEmpDutyTypeDesc" + ColumnIndex;
//            var el_Roll = getClientId(obj, strRole);
//            GlobEmployeeDutyType = el_Roll;
//            var el_List = document.getElementById('<% =LBDutyType.ClientID %>');
//            if (window.event.keyCode == 13) {
//                if (el_List.selectedIndex > -1) {
//                    document.getElementById(el_Roll).value = el_List.options[el_List.selectedIndex].text;
//                    document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value = el_List.options[el_List.selectedIndex].value;
//                    document.getElementById('DivDutyType').style.display = "none";
//                }
//                return;
//            }
//            else if (window.event.keyCode == 40) {
//                if (document.getElementById('DivDutyType').style.display == "block") {
//                    el_List.focus();
//                }
//                return;
//            }
//            else if (window.event.keyCode == 9) {
//                return;
//            }
//            else if (window.event.keyCode == 0 && el_List.length > 0) /////// on blur
//            {
//                if (el_List.selectedIndex > -1) {
//                    document.getElementById(el_Roll).value = el_List.options[el_List.selectedIndex].text;
//                    document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value = el_List.options[el_List.selectedIndex].value;
//                }
//                el_List.selectedIndex = -1
//                return;
//            }
//            else {
//                if (window.event.keyCode == 0)
//                { return; }
//                var lyr = document.getElementById('DivDutyType');
//                var coors = findPos(document.getElementById(el_Roll));
//                lyr.style.top = coors[1] + 20 + 'px';
//                lyr.style.left = coors[0] + 'px';
//                document.getElementById('DivDutyType').style.display = "block";
//                el_List.selectedIndex = -1;
//                for (i = 0; i < el_List.length; i++) {
//                    if (el_List.options[i].text.toLowerCase().substr(0, document.getElementById(el_Roll).value.length) == document.getElementById(el_Roll).value.toLowerCase()) {
//                        el_List.options[i].selected = true;
//                        return;
//                    }
//                }
//            }
//        }
        //=======================================
        //Function Used to Select DutyType after searching Drop Down
        //=======================================
//        function SelectDutyType(obj) {
//            var el = GlobEmployeeDutyType
//            if (obj.selectedIndex >= 0) {
//                document.getElementById(el).value = obj.options[obj.selectedIndex].text;
//                document.getElementById(el).value
//                document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value = obj.options[obj.selectedIndex].value;
//                document.getElementById(el).focus();
//                document.getElementById('DivDutyType').style.display = "none";
//            }
//            return;
//        }
        //=======================================
        //Function Used To Validate Time For Footer
        //=======================================
        function IsValidTimeFooter(obj, txtBoxType) {
            var ColumnIndex = parseInt(document.getElementById('<%=HFColumnIndex.ClientID %>').value) - 1;
            var strTime;
            if (txtBoxType == 'T') {
                strTime = obj.id;
            }
            else {
                strTime = obj.id;
            }
            var timeStr = strTime;
            if (document.getElementById(timeStr).value.length == 4 && document.getElementById(timeStr).value.charAt(2) != ":" && document.getElementById(timeStr).value.charAt(3) != ":") {
                document.getElementById(timeStr).value = document.getElementById(timeStr).value.substring(0, 2) + ":" + document.getElementById(timeStr).value.substring(2, 4);
                return true;
            }
            if (document.getElementById(timeStr).value.charAt(1) != ":" && document.getElementById(timeStr).value.charAt(2) != ":") {
                if (document.getElementById(timeStr).value.length == 1) {
                    document.getElementById(timeStr).value = "0" + document.getElementById(timeStr).value + ":00";
                    return true;
                }
                if (document.getElementById(timeStr).value.length == 2 && document.getElementById(timeStr).value < 24) {
                    document.getElementById(timeStr).value = document.getElementById(timeStr).value + ":00";
                    return true;
                }
            }
            var timePat = /^(\d{2}):(\d{2})$/;
            if (document.getElementById(timeStr).value != "") {
                var matchArray = document.getElementById(timeStr).value.match(timePat);
                if (matchArray == null) {
                    alert(TimeisNotInValidFormat);
                    document.getElementById(timeStr).value = "";
                    document.getElementById(timeStr).focus();
                    return false;
                }
                hour = matchArray[1];
                minute = matchArray[2];
                if (hour < 0 || hour > 23) {
                    alert(HourMustBeBetween0And23);
                    document.getElementById(timeStr).value = "";
                    document.getElementById(timeStr).focus();
                    return false;
                }
                if (minute < 0 || minute > 59) {
                    alert(MinuteMustBeBetween0And59);
                    document.getElementById(timeStr).value = "";
                    document.getElementById(timeStr).focus();
                    return false;
                }
            }
            if (document.getElementById(timeStr).value == "") {
                document.getElementById(timeStr).value = "00:00";
                return true;
            }
            return true;
        }
        //=======================================
        //Function Used To Validate Time
        //=======================================
        function IsValidTime(obj, txtBoxType) {
            // var ColumnIndex = parseInt(document.getElementById('<%=HFColumnIndex.ClientID %>').value) - 1;
            var ColumnIndex;
            var strReversedString = obj.id.split('').reverse().join('');
            ColumnIndex = strReversedString.substring(0, 2);
            if (isNaN(ColumnIndex)) {
                ColumnIndex = strReversedString.substring(0, 1);
            }
            else {
                ColumnIndex = ColumnIndex.toString().split('').reverse().join('');
            }
            var strTime;
            if (txtBoxType == 'T') {
                strTime = "txtTimeTo" + ColumnIndex;
            }
            else {
                strTime = "txtTimeFrom" + ColumnIndex;
            }
            var timeStr = getClientId(obj, strTime);
            if (document.getElementById(timeStr).value.length == 4 && document.getElementById(timeStr).value.charAt(2) != ":" && document.getElementById(timeStr).value.charAt(3) != ":") {
                document.getElementById(timeStr).value = document.getElementById(timeStr).value.substring(0, 2) + ":" + document.getElementById(timeStr).value.substring(2, 4);
                return true;
            }
            if (document.getElementById(timeStr).value.charAt(1) != ":" && document.getElementById(timeStr).value.charAt(2) != ":") {
                if (document.getElementById(timeStr).value.length == 1) {
                    document.getElementById(timeStr).value = "0" + document.getElementById(timeStr).value + ":00";
                    return true;
                }
                if (document.getElementById(timeStr).value.length == 2 && document.getElementById(timeStr).value < 24) {
                    document.getElementById(timeStr).value = document.getElementById(timeStr).value + ":00";
                    return true;
                }
            }
            var timePat = /^(\d{2}):(\d{2})$/;
            if (document.getElementById(timeStr).value != "") {
                var matchArray = document.getElementById(timeStr).value.match(timePat);
                if (matchArray == null) {
                    alert(TimeisNotInValidFormat);
                    document.getElementById(timeStr).value = "";
                    document.getElementById(timeStr).focus();
                    return false;
                }
                hour = matchArray[1];
                minute = matchArray[2];

                if (hour < 0 || hour > 23) {
                    alert(HourMustBeBetween0And23);
                    document.getElementById(timeStr).value = "";
                    document.getElementById(timeStr).focus();
                    return false;
                }
                if (minute < 0 || minute > 59) {
                    alert(MinuteMustBeBetween0And59);
                    document.getElementById(timeStr).value = "";
                    document.getElementById(timeStr).focus();
                    return false;
                }
            }
            if (document.getElementById(timeStr).value == "") {
                document.getElementById(timeStr).value = "00:00";
                return true;
            }
            return true;
        }
        //=======================================
        // Function used After GetEmpDetails Function Is Called to Get Employee Details
        //=======================================
        function ShowEmpAjax(str) {
            var arr = new Array;
            arr = str.split(",");

            if (arr[12] == "1") {
                document.getElementById(GlobShiftPatternCode).disabled = true;
                document.getElementById('<%= hfBorrowedEmployeeStatus.ClientID %>').value = "1";
            }
            else {
                document.getElementById(GlobShiftPatternCode).disabled = false;
                document.getElementById('<%= hfBorrowedEmployeeStatus.ClientID %>').value = "0";
            }
            if (arr[1] == "Invalid") {

                if (arr[3] == "B") {
                    alert(Employeeisbarredfromthisassignment);
                    document.getElementById(GlobEmployeeNumber).value = "";
                }
                else if (arr[3] == "IA") {
                    alert(EmployeeDoesnotbelongstothisArea);
                    document.getElementById(GlobEmployeeNumber).value = "";
                }
                else if (arr[3] == "M") {
                    var arrSkills = new Array;
                    arrSkills = arr[4].split("/");
                    var strMsg = FollowingMandatoryskillsdoesnotmatch;
                    strMsg = strMsg + "\n";
                    for (var i = 0; i < parseInt(arrSkills.length); i++) {

                        strMsg = strMsg + arrSkills[i] + ",";

                    }
                    alert(strMsg);
                    document.getElementById(GlobEmployeeNumber).value = "";
                    // alert("Employee Skills Doesnot Match With Required Mandatory Skills");
                }
                else {
                    alert(InvalidEmpCode);
                    document.getElementById(GlobEmployeeNumber).value = "";
                }
                document.getElementById(GlobEmployeeNumber).focus();
                document.getElementById('divEmployeeContainer').style.display = "none";
                return false;
            }
            else {
                var status = "";
                if (arr[8] != 'SINGLE') {

                    if (arr[4] == "0") {
                        var status = confirm(EmployeeSkillsDoesNotMatchWithRequiredSkillsDoYouWantToContinue);
                        if (!status) {
                            document.getElementById(GlobEmployeeNumber).focus();
                            document.getElementById('divEmployeeContainer').style.display = "none"
                            status = "";
                            return false;
                        }
                        status = "";
                    }
                    if (arr[4] == "1") {
                        var arrSkills = new Array;
                        arrSkills = arr[11].split("/");
                        var strMsg = FollowingMandatoryskillsdoesnotmatch;
                        strMsg = strMsg + "\n";
                        for (var i = 0; i < parseInt(arrSkills.length); i++) {

                            strMsg = strMsg + arrSkills[i] + ",";

                        }
                        alert(strMsg);
                        document.getElementById(GlobEmployeeNumber).value = "";
                        document.getElementById(GlobEmployeeNumber).focus();
                        document.getElementById('divEmployeeContainer').style.display = "none"
                        return false;
                    }
                    if (arr[10] != "OK") {
                        var status = confirm(EmployeePayRateIsGreaterThanSaleOrderPayRateDoYouWantToContinue);
                        if (!status) {
                            document.getElementById(GlobEmployeeNumber).focus();
                            document.getElementById(GlobEmployeeNumber).value = "";
                            document.getElementById(GlobEmployeeName).value = "";
                            document.getElementById(GlobEmployeeDesgDesc).value = "";
                            
                           
                            document.getElementById('divEmployeeContainer').style.display = "none"
                            status = "";
                            return false;
                        }
                        else {

                            document.getElementById(GlobEmployeeNumber).style.color = "red";
                            document.getElementById(GlobEmployeeName).style.color = "red";
                            document.getElementById(GlobEmployeeDesgDesc).style.color = "red";
                            document.getElementById(GlobPatternPosition).style.color = "red";
                            document.getElementById(GlobShiftPatternCode).style.color = "red";
                            // "2" when user clicks YES
                            var strScreenType;
                            if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {
                                strScreenType = 'ACT';
                            }
                            else {
                                strScreenType = 'SCH';
                            }
                            AutoCompleteTextBox.InsertExceptionRecords(document.getElementById('<%= HidCon.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), "", document.getElementById('<% =txtAsmtCode.ClientID %>').value, "", SessionLocationAutoId, strScreenType, document.getElementById(GlobEmployeeNumber).value, "2", SessionUserId, OnInsertExceptionRecordsComplete, OnWSRequestFailed);
                        }
                        status = "";
                    }
                    if (arr[9] != "") {
                        var status = confirm(EmployeeSkillsDoesNotMatchWithRequiredSkillsDoYouWantToContinue);
                        if (!status) {
                            document.getElementById(GlobEmployeeNumber).focus();
                            document.getElementById('divEmployeeContainer').style.display = "none"
                            status = "";
                            return false;
                        }
                        status = "";

                    }
                }
                document.getElementById(GlobEmployeeName).value = arr[1];
                document.getElementById(GlobEmployeeDesgDesc).value = arr[2];
                var el_List = document.getElementById('<% =LBDutyType.ClientID %>');
                document.getElementById('<%=HFNewEmployeeNumber.ClientID %>').value = document.getElementById(GlobEmployeeNumber).value;
                document.getElementById('<%=HFNewRoleCode.ClientID %>').value = arr[6];
                document.getElementById('<%=HFNewDesignationCode.ClientID %>').value = arr[5];
                document.getElementById(GlobEmployeeDesgCode).value = document.getElementById('<%=HFNewDesignationCode.ClientID %>').value;

                if (str == 'SINGLE') {
                    if (document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value == "" && document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value == "") {
                        document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value = el_List.options[0].value;
                    }
                    else {
                        if (el_List.selectedIndex > -1) {
                            document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value = el_List.options[el_List.selectedIndex].value;
                        }
                    }
                }

                document.getElementById(getClientId(document.getElementById(GlobEmployeeName), "txtShiftPatternCode")).select();

                document.getElementById('divEmployeeContainer').style.display = "none"
                if (arr[8] == 'SINGLE') {
                    SaveData();
                }
            }
        }
        function OnCheckAlertRequestComplete(strResult) {
            alert(strResult);
        }

        function OnCheckAlertRequestFailed() {

            alert('error');
        }
        //=======================================
        //Function used to Save Data
        //============================
        function SaveData() {

            var strDefaultSite;
            var strPatternPosition = document.getElementById(GlobPatternPosition).value;
            if (strPatternPosition == "" || strPatternPosition == "0") {
                strPatternPosition = 1;
            }
            var strShiftPatternCode = document.getElementById(GlobShiftPatternCode).value;
            if (strShiftPatternCode == '') {
                strDefaultSite = false;
            }
            else {
                strDefaultSite = true;
            }
            var PDlineNo;
            var strSORank = "A-Site1-SGS";
            if (document.getElementById('<%=HFNewPDLineNo.ClientID %>').value != "") {
                PDlineNo = document.getElementById('<%=HFNewPDLineNo.ClientID %>').value;
            }
            else {

                if (document.getElementById(GlobPDLineNo).value != '') {
                    PDlineNo = document.getElementById(GlobPDLineNo).value;
                }
                else {
                    PDlineNo = '0';
                }
            }
            var strOPSShift = document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value;
            var el_List = document.getElementById('<% =LBRole.ClientID %>');
            if (document.getElementById('<%=HFNewRoleCode.ClientID %>').value == "") {
                document.getElementById('<%=HFNewRoleCode.ClientID %>').value = el_List.options[0].value;
            }
            else {
                if (el_List.selectedIndex > -1) {
                    document.getElementById('<%=HFNewRoleCode.ClientID %>').value = el_List.options[el_List.selectedIndex].value;
                }
            }
            if (PDlineNo == '') {
                alert(InvalidShift);
                return;
            }
            if (document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value == "") {
                document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = 0;
            }
            //=======================================
            //Parameters Used In InsertData By Order
            //=========================================
            var EntryType = "";

            if (document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value != "" && document.getElementById('<%=HFNewRoleCode.ClientID %>').value != "" && document.getElementById('<%=HFNewDesignationCode.ClientID %>').value != "" && document.getElementById('<%=HFNewTimeFrom.ClientID %>').value != "" && document.getElementById('<%=HFNewTimeTo.ClientID %>').value != "" && document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value != "" && PDlineNo != "") {
                var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;

                if (document.getElementById('<%= ddlAttendanceType.ClientID%>').value == 'Sch') {
                    InsertData(document.getElementById('<%=txtAsmtCode.ClientID %>').value, document.getElementById('<%=HFNewEmployeeNumber.ClientID %>').value, DateInFormat(document.getElementById(GlobEmployeeDutyDate).innerText), document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value, document.getElementById('<%=ddlWeek.ClientID %>').value, document.getElementById('<%=HFNewRoleCode.ClientID %>').value, document.getElementById('<%=HFNewDesignationCode.ClientID %>').value, strShiftPatternCode, strPatternPosition, strDefaultSite, strOPSShift, strSORank, document.getElementById('<%=HFNewTimeFrom.ClientID %>').value, document.getElementById('<%=HFNewTimeTo.ClientID %>').value, document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value, EntryType, document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value, PDlineNo, document.getElementById(GlobRowNumber).innerText, strPost, 'Sch', DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<%=HFMaxDate.ClientID %>').value));
                }
                else {
                    InsertData(document.getElementById('<%=txtAsmtCode.ClientID %>').value, document.getElementById('<%=HFNewEmployeeNumber.ClientID %>').value, DateInFormat(document.getElementById(GlobEmployeeDutyDate).innerText), document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value, document.getElementById('<%=ddlWeek.ClientID %>').value, document.getElementById('<%=HFNewRoleCode.ClientID %>').value, document.getElementById('<%=HFNewDesignationCode.ClientID %>').value, strShiftPatternCode, strPatternPosition, strDefaultSite, strOPSShift, strSORank, document.getElementById('<%=HFNewTimeFrom.ClientID %>').value, document.getElementById('<%=HFNewTimeTo.ClientID %>').value, document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value, EntryType, document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value, PDlineNo, document.getElementById(GlobRowNumber).innerText, strPost, 'Act', DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<%=HFMaxDate.ClientID %>').value));
                }
            }
            else {
                if (document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value == "") {
                    alert(ShiftCodeCannotbeleftBlank);
                    document.getElementById(GlobEmployeeShiftCode).focus();
                }
                if (document.getElementById('<%=HFNewRoleCode.ClientID %>').value == "") {
                    alert(RoleCannotbeleftBlank);
                }
                if (document.getElementById('<%=HFNewTimeFrom.ClientID %>').value == "") {
                    alert(TimeFromCannotbeleftBlank);
                    document.getElementById(GlobEmployeeTimeFrom).focus();
                }
                if (document.getElementById('<%=HFNewTimeTo.ClientID %>').value == "") {
                    alert(TimeToCannotbeleftBlank);
                    document.getElementById(GlobEmployeeTimeTo).focus();
                }
                if (document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value == "") {
                    alert("DutyType Cannot be left Blank");
                }
            }
        }
        function OverWriteMultiRecord() {
            try {
                var i;
                for (i = 0; i < parseInt(document.getElementById('hfTotalCount' + 0).value); i++) {
                    var k = parseInt(i);

                    var OverwriteChecked = document.getElementById('chk' + parseInt(i)).checked;
                    if (OverwriteChecked == true) {
                        var strDefaultSite; 
                        var strPatternPosition = document.getElementById('HFPatternPosition' + parseInt(i)).value;
                        var strShiftPatternCode = document.getElementById(GlobShiftPatternCode).value;
                        var strRowNumber = document.getElementById('HFRowNumber' + parseInt(i)).value;
                        if (strShiftPatternCode == '') {
                            strDefaultSite = false;
                        }
                        else {
                            strDefaultSite = true;
                        }
                        var strSORank = 'A-Site1-SGS';
                        var EntryType = 'Multi';
                        var strOPSShift = strSORank.substring(0, 1);
                        if (document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value == "") {
                            document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = 0;
                        }
                        GlobOverwriteStatus = 1;
                        var employeeNumber = document.getElementById(GlobEmployeeNumber).value;
                        if (document.getElementById(GlobEmployeeNumber).value == "") {
                            employeeNumber = document.getElementById('<%=HFNewEmployeeNumber.ClientID %>').value;
                        }
                        OverWriteRecord(document.getElementById('<%=txtAsmtCode.ClientID %>').value, employeeNumber, document.getElementById('HFDutyDateToOverWrite' + parseInt(i)).value, document.getElementById('lblDupShiftCode' + parseInt(i)).innerText, document.getElementById('<%=ddlWeek.ClientID %>').value, document.getElementById('HFRoleCodeToOverWrite' + parseInt(i)).value, document.getElementById('<%=HFNewDesignationCode.ClientID %>').value, strShiftPatternCode, strPatternPosition, strDefaultSite, strOPSShift, strSORank, document.getElementById('HFTimeFromToOverwrite' + parseInt(i)).value, document.getElementById('HFToTimeToOverwrite' + parseInt(i)).value, document.getElementById('HFDutyTypeCodeToOverWrite' + parseInt(i)).value, EntryType, document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value, document.getElementById('HFPDlineNoToOverwrite' + parseInt(i)).value, document.getElementById('HFDupSchRosterAutoID' + parseInt(i)).value, strRowNumber, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<%=HFMaxDate.ClientID %>').value));
                    }
                    else {
                        GlobOverwriteStatus = 0;
                    }
                }
                var strScreenType = document.getElementById('<%=ddlAttendanceType.ClientID %>').value;

                AutoCompleteTextBox.GetExceptionRecords(document.getElementById('<%= HidCon.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFMaxDate.ClientID %>').value), document.getElementById('<% =txtAsmtCode.ClientID %>').value, document.getElementById('<%= HFCurrentSessionID.ClientID %>').value, SessionLocationAutoId, strScreenType, document.getElementById(GlobEmployeeNumber).value, SessionUserId, OnGetExceptionRecordsComplete, OnWSRequestFailed);
            }
            catch (Error) {
                return;
            }
        }
        function OnGetExceptionRecordsComplete(strResult) {
            var res1 = strResult;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");

            var l = 0;
            var strTable;

            var currentRowMessageID = "";
            var nextRowMessageID = "";

            var strExceptionLog = "";
            for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {
                var strExceptionMessage = "";
                try {
                    if (l == "0") {

                        document.getElementById('<%=lblMsgExceptionEmployeeNumber.ClientID %>').innerHTML = xmlDoc1.getElementsByTagName("EmployeeNumber")[l].firstChild.nodeValue;
                        document.getElementById('<%=lblMsgExceptionMaxToDate.ClientID %>').innerHTML = DateInFormat(document.getElementById('<%=HFMaxDate.ClientID %>').value);
                    }
                    if (xmlDoc1.getElementsByTagName("MessageID")[l].firstChild.nodeValue == xmlDoc1.getElementsByTagName("MessageID")[l + 1].firstChild.nodeValue) {
                        currentRowMessageID = (xmlDoc1.getElementsByTagName("MessageDesc")[l].firstChild.nodeValue);
                        nextRowMessageID = (xmlDoc1.getElementsByTagName("MessageDesc")[l + 1].firstChild.nodeValue);
                        strExceptionMessage = strExceptionMessage + currentRowMessageID + "," + nextRowMessageID;
                        l = l + 1;
                    }
                    else {
                        currentRowMessageID = (xmlDoc1.getElementsByTagName("MessageDesc")[l].firstChild.nodeValue) + ",";
                        strExceptionMessage = strExceptionMessage + currentRowMessageID;
                    }
                }
                catch (Error) {
                    currentRowMessageID = (xmlDoc1.getElementsByTagName("MessageDesc")[l].firstChild.nodeValue) + ",";
                    strExceptionMessage = strExceptionMessage + currentRowMessageID;
                }

                strExceptionLog = strExceptionLog + strExceptionMessage;
                l++;
            }
            document.getElementById('<%=lblMsgIDException.ClientID %>').innerHTML = "119";
            document.getElementById('<%=lblMsgException.ClientID %>').innerHTML = strExceptionLog;
            showExceptionMessage();

        }
        function ScheduleCopy() {
            var ColumnIndex = parseInt(document.getElementById('<%=MouseClickColumnID.ClientID %>').value) - 1;
            var strRowID = document.getElementById('<%=MouseClickRowID.ClientID %>').value
            var cellScheduleRosterAutoID = gvScheduleRoster.rows[parseInt(strRowID) + 1].childNodes[ColumnIndex].childNodes[10].id
            if (document.getElementById(cellScheduleRosterAutoID) == '[object]') {
                if (document.getElementById(cellScheduleRosterAutoID).value != '0' && document.getElementById(cellScheduleRosterAutoID).value != 'undefined') {
                    if (document.getElementById('DivCopyDetails').style.display == 'none') {
                        document.getElementById('DivCopyDetails').style.display = 'block'
                    }

                    var cellEmployeeNumber = gvScheduleRoster.rows[parseInt(strRowID) + 1].cells[0].childNodes[0].id;

                    var strDutyDate = "lblHeaderDutyDate" + ColumnIndex;
                    var DutyDate = 'gvScheduleRoster_ctl01_' + strDutyDate;

                    var cellShift = gvScheduleRoster.rows[parseInt(strRowID) + 1].childNodes[ColumnIndex].childNodes[10].id
                    var cellRoleCode = gvScheduleRoster.rows[parseInt(strRowID) + 1].childNodes[ColumnIndex].childNodes[10].id
                    var cellDutyTypeCode = gvScheduleRoster.rows[parseInt(strRowID) + 1].childNodes[ColumnIndex].childNodes[10].id
                    document.getElementById('<%=lblTime.ClientID %>').innerText = gvScheduleRoster.rows[parseInt(strRowID) + 1].childNodes[ColumnIndex].innerText
                    document.getElementById('<%=lblCopyDate.ClientID %>').innerText = DateInFormat(document.getElementById(DutyDate).innerText);
                    document.getElementById('<%=lblEmployeeNumber.ClientID %>').innerText = document.getElementById(cellEmployeeNumber).value;
                    document.getElementById('<%=CopySchRosterAutoID.ClientID %>').value = document.getElementById(cellScheduleRosterAutoID).value;
                    GlobEmployeeNumber = cellEmployeeNumber
                    GlobEmployeeRoleCode = cellRoleCode
                    GlobEmployeeDutyTypeCode = cellDutyTypeCode
                    document.getElementById(GlobEmployeeNumber).value = document.getElementById(cellEmployeeNumber).value;
                    document.getElementById(GlobEmployeeRoleCode).value = document.getElementById(cellRoleCode).value;
                    document.getElementById(GlobEmployeeDutyTypeCode).value = document.getElementById(cellDutyTypeCode).value;
                    GlobShiftPatternCode = gvScheduleRoster.rows[parseInt(strRowID) + 1].cells[0].childNodes[8].id;
                    GlobPatternPosition = gvScheduleRoster.rows[parseInt(strRowID) + 1].cells[0].childNodes[6].id;
                    document.getElementById(GlobPatternPosition).value = 1;
                    document.getElementById(GlobShiftPatternCode).value = '';

                }
                else {
                    alert(NoDatatoCopy);
                }
            }
            else {
                alert(NoDatatoCopy);
            }
        }
        function CopyRecords() {
            if (document.getElementById('<%=txtCopyToDate.ClientID %>').value != '') {
                CopySchedule(document.getElementById('<%=CopySchRosterAutoID.ClientID %>').value, document.getElementById('<%=lblEmployeeNumber.ClientID %>').innerText, document.getElementById('<%=txtCopyToDate.ClientID %>').value, document.getElementById('<%=txtAsmtCode.ClientID %>').value, document.getElementById('<%=HFMaxDate.ClientID %>').value);
            }
        }
        //===========================================
        // Function To Overwrite When Overwrite Button is Clicked
        function OverWriteRecords() {
            var strDefaultSite;
            var j = 0;
            var strPatternPosition = document.getElementById('HFPatternPosition' + parseInt(j)).value;
            var strShiftPatternCode = document.getElementById(GlobShiftPatternCode).value;
            var strRowNumber = document.getElementById('HFRowNumber' + parseInt(j)).value
            if (strShiftPatternCode == '') {
                strDefaultSite = false;
            }
            else {
                strDefaultSite = true;
            }
            var strSORank = 'A-Site1-SGS';
            var PDlineNo;
            if (document.getElementById('<%=HFNewPDLineNo.ClientID %>').value != "") {
                PDlineNo = document.getElementById('<%=HFNewPDLineNo.ClientID %>').value;
            }
            else {
                PDlineNo = document.getElementById(GlobPDLineNo).value;
            }
            var strOPSShift = strSORank.substring(0, 1);
            var EntryType = 'SINGLE';
            var DuplicateSchRosterAutoID = '';
            if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {
                for (var i = 0; i < parseInt(document.getElementById('hfTotalCount' + 0).value); i++) {
                    DuplicateSchRosterAutoID = DuplicateSchRosterAutoID + document.getElementById('lblDupSchRosterAutoID' + parseInt(i)).value + ',';
                }
            }
            else {
                DuplicateSchRosterAutoID = document.getElementById('lblDupSchRosterAutoID' + 0).value;
            }

            if (document.getElementById('<%=HFNewEmployeeNumber.ClientID %>').value != "" && document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value != "" && document.getElementById('<%=HFNewRoleCode.ClientID %>').value != "" && document.getElementById('<%=HFNewDesignationCode.ClientID %>').value != "" && document.getElementById('<%=HFNewTimeFrom.ClientID %>').value != "" && document.getElementById('<%=HFNewTimeTo.ClientID %>').value != "" && document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value != "" && PDlineNo != "") {
                OverWriteRecord(document.getElementById('<%=txtAsmtCode.ClientID %>').value, document.getElementById('<%=HFNewEmployeeNumber.ClientID %>').value, DateInFormat(document.getElementById(GlobEmployeeDutyDate).innerText), document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value, document.getElementById('<%=ddlWeek.ClientID %>').value, document.getElementById('<%=HFNewRoleCode.ClientID %>').value, document.getElementById('<%=HFNewDesignationCode.ClientID %>').value, strShiftPatternCode, strPatternPosition, strDefaultSite, strOPSShift, strSORank, document.getElementById('<%=HFNewTimeFrom.ClientID %>').value, document.getElementById('<%=HFNewTimeTo.ClientID %>').value, document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value, EntryType, document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value, PDlineNo, DuplicateSchRosterAutoID, strRowNumber, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<%=HFMaxDate.ClientID %>').value));
            }
            else {

                if (document.getElementById('<%=HFNewEmployeeNumber.ClientID %>').value == "") {
                    alert(EmployeeNumberCannotbeleftBlank);
                    document.getElementById(GlobEmployeeNumber).focus();
                }

                if (document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value == "") {
                    alert(ShiftCodeCannotbeleftBlank);
                    document.getElementById(GlobEmployeeShiftCode).focus();
                }
                if (document.getElementById('<%=HFNewRoleCode.ClientID %>').value == "") {
                    alert(RoleCannotbeleftBlank);
                }
                if (document.getElementById('<%=HFNewTimeFrom.ClientID %>').value == "") {
                    alert(TimeFromCannotbeleftBlank);
                    document.getElementById(GlobEmployeeTimeFrom).focus();
                }
                if (document.getElementById('<%=HFNewTimeTo.ClientID %>').value == "") {
                    alert(TimeToCannotbeleftBlank);
                    document.getElementById(GlobEmployeeTimeTo).focus();
                }
                if (document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value == "") {
                    alert(DutyTypeCannotbeleftBlank);
                }
            }
           
        }
        //===========================================
        //Function To Show the output After single Cell Insert
        //===========================================
        function FinalOutput(strOutPut) {
            document.getElementById('span1').innerHTML = strOutPut;

            var j = 0;
            try {
                document.getElementById(getClientId(GlobObject, "ImgbtnUpdateTran")).disabled = false;
            }
            catch (Error) {
            }

            var TotalCount = document.getElementById('hfTotalCount' + j).value;

            if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {

                if (TotalCount > 0) {
                    document.getElementById('DIVMultipleOverwrite').style.display = "none";
                    document.getElementById('DivOverWriteShift').style.display = "none";
                    if (document.getElementById('lblMsgShiftDuplicate' + j) == '[object]') {
                        if (document.getElementById('lblMsgShiftDuplicate' + j).innerHTML == Duplicate) {
                            document.getElementById('tr' + j).style.display = "block";
                            document.getElementById('DivOverWriteShift').style.display = "block";
                            document.getElementById('btnOverwriteSingleShift').style.display = 'block';
                        }
                        else if (document.getElementById('lblMsgShiftDuplicate' + j).innerHTML == Insert) {
                            document.getElementById('<%=HFNewPDLineNo.ClientID %>').value = '';
                            document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = '';

                            document.getElementById('tr' + j).style.display = "none";
                            document.getElementById('DivOverWriteShift').style.display = "none";
                            document.getElementById('DIVMultipleOverwrite').style.display = "none";
                            try {
                                document.getElementById(GlobEmployeeShiftCode).value = document.getElementById('lblInsertShiftCode' + j).innerHTML;
                                document.getElementById(GlobEmployeeTimeFrom).value = document.getElementById('lblInsertTimeFrom' + j).innerHTML;
                                document.getElementById(GlobEmployeeTimeTo).value = document.getElementById('lblInsertTimeTo' + j).innerHTML;
                                document.getElementById(GlobEmployeeDetails).innerText = document.getElementById(GlobEmployeeTimeFrom).value + '-' + document.getElementById(GlobEmployeeTimeTo).value;

                                var ColumnIndex;
                                var strReversedString = GlobEmployeeShiftCode.split('').reverse().join('');
                                ColumnIndex = strReversedString.substring(0, 2);
                                if (isNaN(ColumnIndex)) {
                                    ColumnIndex = strReversedString.substring(0, 1);
                                }
                                else {
                                    ColumnIndex = ColumnIndex.toString().split('').reverse().join('');
                                }
                                if (parseInt(ColumnIndex) == 1) {
                                    document.getElementById('<%=HFChangedEmpDetail1.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 2) {
                                    document.getElementById('<%=HFChangedEmpDetail2.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 3) {
                                    document.getElementById('<%=HFChangedEmpDetail3.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 4) {
                                    document.getElementById('<%=HFChangedEmpDetail4.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 5) {
                                    document.getElementById('<%=HFChangedEmpDetail5.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 6) {
                                    document.getElementById('<%=HFChangedEmpDetail6.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 7) {
                                    document.getElementById('<%=HFChangedEmpDetail7.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }

                                if (parseInt(ColumnIndex) == 8) {
                                    document.getElementById('<%=HFChangedEmpDetail8.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 9) {
                                    document.getElementById('<%=HFChangedEmpDetail9.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 10) {
                                    document.getElementById('<%=HFChangedEmpDetail10.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 11) {
                                    document.getElementById('<%=HFChangedEmpDetail11.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 12) {
                                    document.getElementById('<%=HFChangedEmpDetail12.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 13) {
                                    document.getElementById('<%=HFChangedEmpDetail13.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 14) {
                                    document.getElementById('<%=HFChangedEmpDetail14.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 15) {
                                    document.getElementById('<%=HFChangedEmpDetail15.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                } if (parseInt(ColumnIndex) == 16) {
                                    document.getElementById('<%=HFChangedEmpDetail16.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                } if (parseInt(ColumnIndex) == 17) {
                                    document.getElementById('<%=HFChangedEmpDetail17.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                } if (parseInt(ColumnIndex) == 18) {
                                    document.getElementById('<%=HFChangedEmpDetail18.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                } if (parseInt(ColumnIndex) == 19) {
                                    document.getElementById('<%=HFChangedEmpDetail19.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                } if (parseInt(ColumnIndex) == 20) {
                                    document.getElementById('<%=HFChangedEmpDetail20.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                } if (parseInt(ColumnIndex) == 21) {
                                    document.getElementById('<%=HFChangedEmpDetail21.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                } if (parseInt(ColumnIndex) == 22) {
                                    document.getElementById('<%=HFChangedEmpDetail22.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                } if (parseInt(ColumnIndex) == 23) {
                                    document.getElementById('<%=HFChangedEmpDetail23.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                } if (parseInt(ColumnIndex) == 24) {
                                    document.getElementById('<%=HFChangedEmpDetail24.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                } if (parseInt(ColumnIndex) == 25) {
                                    document.getElementById('<%=HFChangedEmpDetail25.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                } if (parseInt(ColumnIndex) == 26) {
                                    document.getElementById('<%=HFChangedEmpDetail26.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                } if (parseInt(ColumnIndex) == 27) {
                                    document.getElementById('<%=HFChangedEmpDetail27.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                } if (parseInt(ColumnIndex) == 28) {
                                    document.getElementById('<%=HFChangedEmpDetail28.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 29) {
                                    document.getElementById('<%=HFChangedEmpDetail29.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                } if (parseInt(ColumnIndex) == 30) {
                                    document.getElementById('<%=HFChangedEmpDetail30.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 31) {
                                    document.getElementById('<%=HFChangedEmpDetail31.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                }

                                if ((parseInt(ColumnIndex) + 1) < 33) {
                                    var strShiftCode = "txtEmpShiftDutyDate" + (parseInt(ColumnIndex) + 1);
                                    document.getElementById(getClientId(GlobObject, strShiftCode)).focus();
                                }
                                if (document.getElementById(GlobEmployeeSchRosterAutoID) == "[object]") {
                                    document.getElementById(GlobEmployeeSchRosterAutoID).value = document.getElementById('lblScheduleRosterAutoID' + j).innerHTML;
                                }
                                if (document.getElementById(GlobEmployeeDesgCode) == "[object]") {
                                    document.getElementById(GlobEmployeeDesgCode).value = document.getElementById('<%=HFNewDesignationCode.ClientID %>').value;
                                }
                                if (document.getElementById(GlobEmployeeDutyTypeCode) == "[object]") {
                                    document.getElementById(GlobEmployeeDutyTypeCode).value = document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value;
                                }
                                if (document.getElementById(GlobEmployeeRoleCode) == "[object]") {
                                    document.getElementById(GlobEmployeeRoleCode).value = document.getElementById('<%=HFNewRoleCode.ClientID %>').value;
                                }

                            }
                            catch (Error) { }
                        }
                        else if (document.getElementById('lblMsgShiftDuplicate' + j).innerHTML == OverWrite || document.getElementById('lblMessage' + j).innerHTML == OverWrite) {

                            document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
                            document.getElementById('tr' + j).style.display = "none";
                            document.getElementById('btnOverWrite').style.display = "none";
                            if (document.getElementById('<%=HFPost.ClientID %>').value == '') {
                                document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
                            }
                            document.getElementById('btnOverwriteSingleShift').style.display = "none";
                            document.getElementById('<%=btnProceed.ClientID %>').click();
                            return;

                        }
                        else if (document.getElementById('lblMsgShiftDuplicate' + j).innerHTML == Alert) {
                            alert(document.getElementById('lblMessage0').innerHTML);
                            document.getElementById('tr' + j).style.display = "none";
                            document.getElementById('btnOverWrite').style.display = "none";
                            document.getElementById('btnOverwriteSingleShift').style.display = "none";
                        }
                        else {

                            document.getElementById('DivOverWriteShift').style.display = "block";
                            document.getElementById('btnOverWrite').style.display = "none";
                            document.getElementById('btnOverwriteSingleShift').style.display = "none";

                        }
                    }
                }
                return;
            }
            else {
                if (TotalCount > 0) {
                    document.getElementById('DIVMultipleOverwrite').style.display = "none";
                    if (document.getElementById('lblMsgShiftDuplicate' + j) == '[object]') {
                        if (document.getElementById('lblMsgShiftDuplicate' + j).innerHTML == Duplicate) {
                            document.getElementById('tr' + j).style.display = "block";
                            document.getElementById('DivOverWriteShift').style.display = "block";

                            document.getElementById('btnOverwriteSingleShift').style.display = 'block';
                        }
                        else if (document.getElementById('lblMsgShiftDuplicate' + j).innerHTML == Insert) {
                            document.getElementById('<%=HFNewPDLineNo.ClientID %>').value = '';
                            document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = '';

                            document.getElementById('tr' + j).style.display = "none";
                            document.getElementById('DivOverWriteShift').style.display = "none";
                            document.getElementById('DIVMultipleOverwrite').style.display = "none";
                            try {
                                document.getElementById(GlobEmployeeShiftCode).value = document.getElementById('lblInsertShiftCode' + j).innerHTML;
                                document.getElementById(GlobEmployeeTimeFrom).value = document.getElementById('lblInsertTimeFrom' + j).innerHTML;
                                document.getElementById(GlobEmployeeTimeTo).value = document.getElementById('lblInsertTimeTo' + j).innerHTML;
                                document.getElementById(GlobEmployeeDetails).innerText = document.getElementById(GlobEmployeeTimeFrom).value + '-' + document.getElementById(GlobEmployeeTimeTo).value;

                                var ColumnIndex;
                                var strReversedString = GlobEmployeeShiftCode.split('').reverse().join('');
                                ColumnIndex = strReversedString.substring(0, 2);
                                if (isNaN(ColumnIndex)) {
                                    ColumnIndex = strReversedString.substring(0, 1);
                                }
                                else {
                                    ColumnIndex = ColumnIndex.toString().split('').reverse().join('');
                                }
                                if (parseInt(ColumnIndex) == 1) {
                                    document.getElementById('<%=HFChangedEmpDetail1.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 2) {
                                    document.getElementById('<%=HFChangedEmpDetail2.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 3) {
                                    document.getElementById('<%=HFChangedEmpDetail3.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 4) {
                                    document.getElementById('<%=HFChangedEmpDetail4.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 5) {
                                    document.getElementById('<%=HFChangedEmpDetail5.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 6) {
                                    document.getElementById('<%=HFChangedEmpDetail6.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 7) {
                                    document.getElementById('<%=HFChangedEmpDetail7.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 8) {
                                    document.getElementById('<%=HFChangedEmpDetail8.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 9) {
                                    document.getElementById('<%=HFChangedEmpDetail9.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 10) {
                                    document.getElementById('<%=HFChangedEmpDetail10.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 11) {
                                    document.getElementById('<%=HFChangedEmpDetail11.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 12) {
                                    document.getElementById('<%=HFChangedEmpDetail12.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 13) {
                                    document.getElementById('<%=HFChangedEmpDetail13.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 14) {
                                    document.getElementById('<%=HFChangedEmpDetail14.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 15) {
                                    document.getElementById('<%=HFChangedEmpDetail15.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                } if (parseInt(ColumnIndex) == 16) {
                                    document.getElementById('<%=HFChangedEmpDetail16.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                } if (parseInt(ColumnIndex) == 17) {
                                    document.getElementById('<%=HFChangedEmpDetail17.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                } if (parseInt(ColumnIndex) == 18) {
                                    document.getElementById('<%=HFChangedEmpDetail18.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                } if (parseInt(ColumnIndex) == 19) {
                                    document.getElementById('<%=HFChangedEmpDetail19.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                } if (parseInt(ColumnIndex) == 20) {
                                    document.getElementById('<%=HFChangedEmpDetail20.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                } if (parseInt(ColumnIndex) == 21) {
                                    document.getElementById('<%=HFChangedEmpDetail21.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                } if (parseInt(ColumnIndex) == 22) {
                                    document.getElementById('<%=HFChangedEmpDetail22.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                } if (parseInt(ColumnIndex) == 23) {
                                    document.getElementById('<%=HFChangedEmpDetail23.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                } if (parseInt(ColumnIndex) == 24) {
                                    document.getElementById('<%=HFChangedEmpDetail24.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                } if (parseInt(ColumnIndex) == 25) {
                                    document.getElementById('<%=HFChangedEmpDetail25.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                } if (parseInt(ColumnIndex) == 26) {
                                    document.getElementById('<%=HFChangedEmpDetail26.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                } if (parseInt(ColumnIndex) == 27) {
                                    document.getElementById('<%=HFChangedEmpDetail27.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                } if (parseInt(ColumnIndex) == 28) {
                                    document.getElementById('<%=HFChangedEmpDetail28.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 29) {
                                    document.getElementById('<%=HFChangedEmpDetail29.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                } if (parseInt(ColumnIndex) == 30) {
                                    document.getElementById('<%=HFChangedEmpDetail30.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText
                                }
                                if (parseInt(ColumnIndex) == 31) {
                                    document.getElementById('<%=HFChangedEmpDetail31.ClientID %>').value = document.getElementById(GlobEmployeeDetails).innerText

                                }
                                if ((parseInt(ColumnIndex) + 1) < 33) {
                                    var strShiftCode = "txtEmpShiftDutyDate" + (parseInt(ColumnIndex) + 1);
                                    document.getElementById(getClientId(GlobObject, strShiftCode)).focus();
                                }
                                if (document.getElementById(GlobEmployeeSchRosterAutoID) == "[object]") {
                                    document.getElementById(GlobEmployeeSchRosterAutoID).value = document.getElementById('lblScheduleRosterAutoID' + j).innerHTML;
                                }
                                if (document.getElementById(GlobEmployeeDesgCode) == "[object]") {
                                    document.getElementById(GlobEmployeeDesgCode).value = document.getElementById('<%=HFNewDesignationCode.ClientID %>').value;
                                }
                                if (document.getElementById(GlobEmployeeDutyTypeCode) == "[object]") {
                                    document.getElementById(GlobEmployeeDutyTypeCode).value = document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value;
                                }
                                if (document.getElementById(GlobEmployeeRoleCode) == "[object]") {
                                    document.getElementById(GlobEmployeeRoleCode).value = document.getElementById('<%=HFNewRoleCode.ClientID %>').value;
                                }

                            }
                            catch (Error) { }

                            // Code to show Exceptions
                            showExceptionMessage();
                            // Code to show Exceptions

                            if (document.getElementById('lblOverWrite' + j).innerHTML == OverWrite) {
                                if (document.getElementById('<%=HFPost.ClientID %>').value == '') {
                                    document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
                                }
                                document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
                                document.getElementById('<%=btnProceed.ClientID %>').click();
                            }
                            if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Sch') {
                                GetReqSch();
                            }
                            else {
                                document.getElementById('divManPowerReq').innerHTML = '';
                                document.getElementById('divManPowerReq').style.display = 'none';
                            }
                        }
                        else if (document.getElementById('lblMsgShiftDuplicate' + j).innerHTML == Converted) {
                            document.getElementById('tr' + j).style.display = "block";
                            document.getElementById('DivOverWriteShift').style.display = "block";

                            document.getElementById('btnOverwriteSingleShift').style.display = 'none';
                        }
                        else if (document.getElementById('lblMsgShiftDuplicate' + j).innerHTML == ErrorMessage) {
                            document.getElementById('tr' + j).style.display = "block";

                            document.getElementById('btnOverWrite').style.display = "none";
                            document.getElementById('btnOverwriteSingleShift').style.display = "none";
                        }
                        else if (document.getElementById('lblMsgShiftDuplicate' + j).innerHTML == Leave) {
                            document.getElementById('DivOverWriteShift').style.display = "block";
                            document.getElementById('btnOverWrite').style.display = "none";
                            document.getElementById('btnOverwriteSingleShift').style.display = "none";

                        }
                        else {
                            document.getElementById('DivOverWriteShift').style.display = "block";
                            document.getElementById('btnOverWrite').style.display = "none";
                            document.getElementById('btnOverwriteSingleShift').style.display = "none";

                        }
                    }
                }
            }

        }
        function DeleteOutput(strOutput) {
            if (document.getElementById('<%=HFPost.ClientID %>').value == '') {
                document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
            }
            document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            document.getElementById('<%=btnProceed.ClientID %>').click();
            if (document.getElementById(GlobShiftPatternCode) == "[object]") {
                document.getElementById(GlobShiftPatternCode).disabled = false;
            }
            alert(strOutput);
            document.getElementById('divEmployeeContainer').style.display = "none";
            if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Sch') {
                GetReqSch();
            }
            else {
                document.getElementById('divManPowerReq').innerHTML = '';
                document.getElementById('divManPowerReq').style.display = 'none';
            }
        }
        //============================
        //Function Used to Get The Client ID Of Control
        //=======================================
        function getClientId(obj, cId) {
            var arr = new Array;
            var clId = "";  // clientId
            arr = obj.id.split("_");
            for (i = 0; i < arr.length - 1; i++) {
                clId = clId + arr[i] + "_";
            }
            clId = clId + cId;
            return clId
        }
        //=======================================
        // Function Called on Key Down Event
        //=======================================
        function LockScheduleEmpWise() {
            LockScheduleEmpWiseAjax(document.getElementById('<% =txtClientCode.ClientID %>').value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFMaxDate.ClientID %>').value));
        }
        function LockStatus(str) {
            document.getElementById('<% =lblErrorMsg.ClientID %>').innerHTML = str;
            if (document.getElementById('<%=HFPost.ClientID %>').value == '') {
                document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
            }
            document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            document.getElementById('<%=btnProceed.ClientID %>').click();
        }
        function FunctionCallOnKeyDown(elName, obj) {

            if (document.getElementById(GlobObjTofade) == '[object]') {
                var fadeobjjobBreakDown = document.getElementById(GlobObjTofade);
                if (fadeobjjobBreakDown.style.display == 'block') {
                    fadeobjjobBreakDown.style.display = 'none'
                    document.getElementById('HFJobBreakDownSchRosterAutoID').value = '';
                }
            }
            var ColumnIndex;
            GlobObject = obj;
            document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
            if (document.getElementById('<%=ddlPost.ClientID %>').selectedIndex != -1) {
                document.getElementById('<%=HFPostText.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').options[document.getElementById('<%=ddlPost.ClientID %>').selectedIndex].text;
            }
            if (window.event.keyCode == 9) {
                if (document.getElementById('divShift') == "[object]") {
                    if (document.getElementById('divShift').style.display != "none") {
                        document.getElementById('divShift').style.display = "none";
                    }
                }
                if (document.getElementById('diveRole') == "[object]") {
                    if (document.getElementById('diveRole').style.display != "none") {
                        document.getElementById('diveRole').style.display = "none";
                    }
                }
                if (document.getElementById('DivDutyType') == "[object]") {
                    if (document.getElementById('DivDutyType').style.display != "none") {
                        document.getElementById('DivDutyType').style.display = "none";
                    }
                }
            }
            if (window.event.keyCode == 46) {
                document.getElementById('divEmployeeContainer').style.display = "none";

            }

            var strReversedString = obj.id.split('').reverse().join('');
            ColumnIndex = strReversedString.substring(0, 2);
            if (isNaN(ColumnIndex)) {
                ColumnIndex = strReversedString.substring(0, 1);
            }
            else {
                ColumnIndex = ColumnIndex.toString().split('').reverse().join('');
            }
            document.getElementById('<%=HFEditColumnIndex.ClientID %>').value = ColumnIndex;
            var strDutyDate = "lblHeaderDutyDate" + ColumnIndex;
            var strEmpNumber = "txtEmpNumberDutyDate";
            var DutyDate = 'gvScheduleRoster_ctl01_' + strDutyDate;
            GlobEmployeeDutyDate = DutyDate;
            var strEmployeeName = "txtEmpNameDutyDate";
            var strEmpDesignationDesc = "txtEmpDesignationDesc";
            var strDesignationCode = "HFDesignationCode";
            GlobEmployeeDesgCode = getClientId(obj, strDesignationCode);
            GlobRowNumber = getClientId(obj, "lblRowID");
            var strSerialNumber = getClientId(obj, "lblSerialNumber");
            if (window.event.keyCode == 121) //select
            {
                document.getElementById('<%=HFRowIndex.ClientID %>').value = parseInt(document.getElementById(strSerialNumber).innerText) - 1;
            }
            try {
                document.getElementById(getClientId(obj, "ImgbtnUpdateTran")).disabled = true;
            }
            catch (Error) {
            }
            document.getElementById('<%=HFNewDesignationCode.ClientID %>').value = document.getElementById(GlobEmployeeDesgCode).value;
            document.getElementById(GlobEmployeeDesgCode).value = document.getElementById('<%=HFNewDesignationCode.ClientID %>').value
            GlobEmployeeNumber = getClientId(obj, strEmpNumber);
            document.getElementById('<%=HFNewEmployeeNumber.ClientID %>').value = document.getElementById(GlobEmployeeNumber).value;
            document.getElementById(GlobEmployeeNumber).value = document.getElementById('<%=HFNewEmployeeNumber.ClientID %>').value

            var strDefaultSite = "CBIsDefaultSite";
            var strShiftPatternCode = "txtShiftPatternCode";
            var strPatternPosition = "txtPatternPosition";
            GlobDefaultSite = getClientId(obj, strDefaultSite);
            GlobShiftPatternCode = getClientId(obj, strShiftPatternCode);
            GlobPatternPosition = getClientId(obj, strPatternPosition);

            var ListDutyType = document.getElementById('<% =LBDutyType.ClientID %>');
            var ListRole = document.getElementById('<% =LBRole.ClientID %>');

            var strScreenType;
            if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {
                strScreenType = 'ACT'
            }
            else {
                strScreenType = 'SCH'
            }
            switch (elName) {

                case "TimeFromFooter":
                    if (window.event.keyCode == 9) {
                        IsValidTimeFooter(obj, 'F');
                    }
                    if (window.event.keyCode == 13) //select
                    {
                        var strRoleCode = "HFRoleCode" + ColumnIndex;
                        var strDutyTypeCode = "HFDutyTypeCode" + ColumnIndex;
                        var strEmpDetails = "lblFooterDutyDate" + ColumnIndex;
                        var strEmpRoleDesc = "txtEmpRoleDesc" + ColumnIndex;
                        var strEmpDutyType = "txtEmpDutyTypeDesc" + ColumnIndex;
                        var strShiftCode = "txtEmpShiftDutyDate" + ColumnIndex;
                        var strTimeFrom = "txtTimeFrom" + ColumnIndex;
                        var strTimeTo = "txtTimeTo" + ColumnIndex;
                        var strPDLineNo = "HFPDLineNo" + ColumnIndex;
                        var strScheduleRosterAutoID = "HFSchRosterAutoID" + ColumnIndex;
                        GlobEmployeeName = getClientId(obj, strEmployeeName);
                        GlobEmployeeDesgDesc = getClientId(obj, strEmpDesignationDesc);
                        GlobEmployeeRoleDesc = getClientId(obj, strEmpRoleDesc);
                        GlobEmployeeDutyType = getClientId(obj, strEmpDutyType);
                        GlobEmployeeShiftCode = getClientId(obj, strShiftCode);
                        GlobEmployeeTimeFrom = getClientId(obj, strTimeFrom);
                        GlobEmployeeTimeTo = getClientId(obj, strTimeTo);
                        GlobEmployeeDetails = getClientId(obj, strEmpDetails);
                        GlobEmployeeDutyTypeCode = getClientId(obj, strDutyTypeCode);
                        GlobEmployeeRoleCode = getClientId(obj, strRoleCode);
                        GlobPDLineNo = getClientId(obj, strPDLineNo);
                        GlobEmployeeSchRosterAutoID = getClientId(obj, strScheduleRosterAutoID);

                        document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = document.getElementById(GlobEmployeeSchRosterAutoID).value;
                        document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value = document.getElementById(GlobEmployeeShiftCode).value;

                        if (document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value == "") {
                            document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value = ListDutyType.options[0].value;
                            document.getElementById(GlobEmployeeDutyType).value = ListDutyType.options[0].text;
                        }
                        else {
                            if (ListDutyType.selectedIndex > -1) {
                                document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value = ListDutyType.options[ListDutyType.selectedIndex].value;
                                document.getElementById(GlobEmployeeDutyType).value = ListDutyType.options[ListDutyType.selectedIndex].text;
                            }

                        }
                        var ReturnValue = IsValidTimeFooter(obj, 'F');
                        if (ReturnValue) {
                            document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = document.getElementById(GlobEmployeeTimeFrom).value;
                            document.getElementById('<%=HFNewTimeTo.ClientID %>').value = document.getElementById(GlobEmployeeTimeTo).value;
                            var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                            //Added Area ID option to search only those employee that belongs to that Area
                            var str = GetEmpName(document.getElementById(GlobEmployeeNumber).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById(DutyDate).innerText), DateInFormat(document.getElementById(DutyDate).innerText), strPost, 'SINGLE', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType);
                            return;
                        }
                    }
                    break;
                case "TimeFrom":
                    if (window.event.keyCode == 9) {
                        IsValidTime(obj, 'F');
                    }

                    if (window.event.keyCode == 13) //select
                    {
                        var strRoleCode = "HFRoleCode" + ColumnIndex;
                        var strDutyTypeCode = "HFDutyTypeCode" + ColumnIndex;
                        var strEmpDetails = "lblDutyDate" + ColumnIndex;
                        var strEmpRoleDesc = "txtEmpRoleDesc" + ColumnIndex;
                        var strEmpDutyType = "txtEmpDutyTypeDesc" + ColumnIndex;
                        var strShiftCode = "txtEmpShiftDutyDate" + ColumnIndex;
                        var strTimeFrom = "txtTimeFrom" + ColumnIndex;
                        var strTimeTo = "txtTimeTo" + ColumnIndex;
                        var strPDLineNo = "HFPDLineNo" + ColumnIndex;
                        var strScheduleRosterAutoID = "HFSchRosterAutoID" + ColumnIndex;
                        GlobEmployeeName = getClientId(obj, strEmployeeName);
                        GlobEmployeeDesgDesc = getClientId(obj, strEmpDesignationDesc);
                        GlobEmployeeRoleDesc = getClientId(obj, strEmpRoleDesc);
                        GlobEmployeeDutyType = getClientId(obj, strEmpDutyType);
                        GlobEmployeeShiftCode = getClientId(obj, strShiftCode);
                        GlobEmployeeTimeFrom = getClientId(obj, strTimeFrom);
                        GlobEmployeeTimeTo = getClientId(obj, strTimeTo);
                        GlobEmployeeDetails = getClientId(obj, strEmpDetails);
                        GlobEmployeeDutyTypeCode = getClientId(obj, strDutyTypeCode);
                        GlobEmployeeRoleCode = getClientId(obj, strRoleCode);
                        GlobPDLineNo = getClientId(obj, strPDLineNo);
                        GlobEmployeeSchRosterAutoID = getClientId(obj, strScheduleRosterAutoID);

                        document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = document.getElementById(GlobEmployeeSchRosterAutoID).value;
                        document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value = document.getElementById(GlobEmployeeShiftCode).value;

                        if (document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value == "") {
                            document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value = ListDutyType.options[0].value;
                            document.getElementById(GlobEmployeeDutyType).value = ListDutyType.options[0].text;
                        }
                        else {
                            if (ListDutyType.selectedIndex > -1) {
                                document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value = ListDutyType.options[ListDutyType.selectedIndex].value;
                                document.getElementById(GlobEmployeeDutyType).value = ListDutyType.options[ListDutyType.selectedIndex].text;
                            }

                        }
                        var ReturnValue = IsValidTime(obj, 'F');
                        if (ReturnValue) {
                            document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = document.getElementById(GlobEmployeeTimeFrom).value;
                            document.getElementById('<%=HFNewTimeTo.ClientID %>').value = document.getElementById(GlobEmployeeTimeTo).value;
                            var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                            //Added Area ID option to search only those employee that belongs to that Area
                            var str = GetEmpName(document.getElementById(GlobEmployeeNumber).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById(DutyDate).innerText), DateInFormat(document.getElementById(DutyDate).innerText), strPost, 'SINGLE', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType);
                            return;
                        }
                    }
                    break;

                case "TimeToFooter":
                    if (window.event.keyCode == 9) {
                        IsValidTimeFooter(obj, 'T');
                    }
                    if (window.event.keyCode == 13) //select
                    {
                        var strRoleCode = "HFRoleCode" + ColumnIndex;
                        var strDutyTypeCode = "HFDutyTypeCode" + ColumnIndex;
                        var strEmpDetails = "lblFooterDutyDate" + ColumnIndex;
                        var strEmpRoleDesc = "txtEmpRoleDesc" + ColumnIndex;
                        var strEmpDutyType = "txtEmpDutyTypeDesc" + ColumnIndex;
                        var strShiftCode = "txtEmpShiftDutyDate" + ColumnIndex;
                        var strTimeFrom = "txtTimeFrom" + ColumnIndex;
                        var strTimeTo = "txtTimeTo" + ColumnIndex;
                        var strPDLineNo = "HFPDLineNo" + ColumnIndex;
                        var strScheduleRosterAutoID = "HFSchRosterAutoID" + ColumnIndex;
                        GlobEmployeeName = getClientId(obj, strEmployeeName);
                        GlobEmployeeDesgDesc = getClientId(obj, strEmpDesignationDesc);
                        GlobEmployeeRoleDesc = getClientId(obj, strEmpRoleDesc);
                        GlobEmployeeDutyType = getClientId(obj, strEmpDutyType);
                        GlobEmployeeShiftCode = getClientId(obj, strShiftCode);
                        GlobEmployeeTimeFrom = getClientId(obj, strTimeFrom);
                        GlobEmployeeTimeTo = getClientId(obj, strTimeTo);
                        GlobEmployeeDetails = getClientId(obj, strEmpDetails);
                        GlobEmployeeDutyTypeCode = getClientId(obj, strDutyTypeCode);
                        GlobEmployeeRoleCode = getClientId(obj, strRoleCode);
                        GlobPDLineNo = getClientId(obj, strPDLineNo);
                        GlobEmployeeSchRosterAutoID = getClientId(obj, strScheduleRosterAutoID);

                        document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = document.getElementById(GlobEmployeeSchRosterAutoID).value;
                        document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value = document.getElementById(GlobEmployeeShiftCode).value;
                        if (document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value == "") {
                            document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value = ListDutyType.options[0].value;
                            document.getElementById(GlobEmployeeDutyType).value = ListDutyType.options[0].text;
                        }
                        else {
                            if (ListDutyType.selectedIndex > -1) {
                                document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value = ListDutyType.options[ListDutyType.selectedIndex].value;
                                document.getElementById(GlobEmployeeDutyType).value = ListDutyType.options[ListDutyType.selectedIndex].text;
                            }

                        }
                        var ReturnValue = IsValidTimeFooter(obj, 'T');
                        if (ReturnValue) {
                            document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = document.getElementById(GlobEmployeeTimeFrom).value;
                            document.getElementById('<%=HFNewTimeTo.ClientID %>').value = document.getElementById(GlobEmployeeTimeTo).value;
                            var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                            //Added Area ID option to search only those employee that belongs to that Area
                            var str = GetEmpName(document.getElementById(GlobEmployeeNumber).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById(DutyDate).innerText), DateInFormat(document.getElementById(DutyDate).innerText), strPost, 'SINGLE', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType);
                            return;
                        }
                    }
                    break;
                case "TimeTo":
                    if (window.event.keyCode == 9) {
                        IsValidTime(obj, 'T');
                    }
                    if (window.event.keyCode == 13) //select
                    {
                        var strRoleCode = "HFRoleCode" + ColumnIndex;
                        var strDutyTypeCode = "HFDutyTypeCode" + ColumnIndex;
                        var strEmpDetails = "lblDutyDate" + ColumnIndex;
                        var strEmpRoleDesc = "txtEmpRoleDesc" + ColumnIndex;
                        var strEmpDutyType = "txtEmpDutyTypeDesc" + ColumnIndex;
                        var strShiftCode = "txtEmpShiftDutyDate" + ColumnIndex;
                        var strTimeFrom = "txtTimeFrom" + ColumnIndex;
                        var strTimeTo = "txtTimeTo" + ColumnIndex;
                        var strPDLineNo = "HFPDLineNo" + ColumnIndex;
                        var strScheduleRosterAutoID = "HFSchRosterAutoID" + ColumnIndex;
                        GlobEmployeeName = getClientId(obj, strEmployeeName);
                        GlobEmployeeDesgDesc = getClientId(obj, strEmpDesignationDesc);
                        GlobEmployeeRoleDesc = getClientId(obj, strEmpRoleDesc);
                        GlobEmployeeDutyType = getClientId(obj, strEmpDutyType);
                        GlobEmployeeShiftCode = getClientId(obj, strShiftCode);
                        GlobEmployeeTimeFrom = getClientId(obj, strTimeFrom);
                        GlobEmployeeTimeTo = getClientId(obj, strTimeTo);
                        GlobEmployeeDetails = getClientId(obj, strEmpDetails);
                        GlobEmployeeDutyTypeCode = getClientId(obj, strDutyTypeCode);
                        GlobEmployeeRoleCode = getClientId(obj, strRoleCode);
                        GlobPDLineNo = getClientId(obj, strPDLineNo);
                        GlobEmployeeSchRosterAutoID = getClientId(obj, strScheduleRosterAutoID);

                        document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = document.getElementById(GlobEmployeeSchRosterAutoID).value;
                        document.getElementById('<%=HFNewEmployeeShiftCode.ClientID %>').value = document.getElementById(GlobEmployeeShiftCode).value;
                        if (document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value == "") {
                            document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value = ListDutyType.options[0].value;
                            document.getElementById(GlobEmployeeDutyType).value = ListDutyType.options[0].text;
                        }
                        else {
                            if (ListDutyType.selectedIndex > -1) {
                                document.getElementById('<%=HFNewDutyTypeCode.ClientID %>').value = ListDutyType.options[ListDutyType.selectedIndex].value;
                                document.getElementById(GlobEmployeeDutyType).value = ListDutyType.options[ListDutyType.selectedIndex].text;
                            }

                        }
                        var ReturnValue = IsValidTime(obj, 'T');
                        if (ReturnValue) {
                            document.getElementById('<%=HFNewTimeFrom.ClientID %>').value = document.getElementById(GlobEmployeeTimeFrom).value;
                            document.getElementById('<%=HFNewTimeTo.ClientID %>').value = document.getElementById(GlobEmployeeTimeTo).value;
                            var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                            //Added Area ID option to search only those employee that belongs to that Area
                            var str = GetEmpName(document.getElementById(GlobEmployeeNumber).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById(DutyDate).innerText), DateInFormat(document.getElementById(DutyDate).innerText), strPost, 'SINGLE', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType);
                            return;
                        }
                    }
                    break;
                case "ShiftCode":
                    if (window.event.keyCode == 46) {  //delete Key Pressed
                        var strScheduleRosterAutoID = "HFSchRosterAutoID" + ColumnIndex;
                        GlobEmployeeSchRosterAutoID = getClientId(obj, strScheduleRosterAutoID);

                        document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = document.getElementById(GlobEmployeeSchRosterAutoID).value;
                        if (document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value != "0") {

                            var SchRosterAutoID = document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value;
                            DeleteSchedule(SchRosterAutoID, document.getElementById(GlobRowNumber).innerText, document.getElementById('<%=ddlAttendanceType.ClientID %>').value, DateInFormat(document.getElementById(DutyDate).innerText), document.getElementById(GlobEmployeeNumber).value, document.getElementById('<%=txtAsmtCode.ClientID %>').value);
                        }
                    }
                    if (window.event.keyCode == 9) {

                    }
                    break;
                case "ShiftPatternCode":

                    if (window.event.keyCode == 40) {  //Down Key Pressed
                        //   document.getElementById(KeyNavigation(obj, "DOWN")).select();
                        return;
                    }
                    else if (window.event.keyCode == 38) //Up key movement
                    {
                        //document.getElementById(KeyNavigation(obj, "UP")).select();
                        return;
                    }
                    else if (window.event.keyCode == 37) //Left key movement
                    {
                        document.getElementById(GlobPatternPosition).select();
                        return;
                    }
                    //                    else if (window.event.keyCode == 39) //Right key movement
                    //                    {
                    //                        document.getElementById('<%=HFColumnIndex.ClientID %>').value = 2;
                    //                        document.getElementById('<%=btnEditMode.ClientID %>').click();
                    //                    }
                    if (window.event.keyCode == 13) {  //Enter Key Pressed

                        if (document.getElementById(GlobShiftPatternCode).value == '') {
                            document.getElementById(GlobDefaultSite).checked = false;
                        }
                        else {
                            document.getElementById(GlobDefaultSite).checked = true;
                        }
                        SaveDataPatternWise(obj);
                    }
                    break;

                case "PatternPosition":

                    if (window.event.keyCode == 40) {  //Down Key Pressed
                        //document.getElementById(KeyNavigation(obj, "DOWN")).select();
                        return;
                    }
                    else if (window.event.keyCode == 38) //Up key movement
                    {
                        //document.getElementById(KeyNavigation(obj, "UP")).select();
                        return;
                    }
                    else if (window.event.keyCode == 37) //Left key movement
                    {
                        document.getElementById(getClientId(obj, strEmployeeName)).select();
                        return;
                    }
                    else if (window.event.keyCode == 39) //Right key movement
                    {
                        document.getElementById(GlobShiftPatternCode).select();
                        return;
                    }

                    break;
                case "EmployeeName":

                    if (window.event.keyCode == 40) {  //Down Key Pressed
                        //document.getElementById(KeyNavigation(obj, "DOWN")).select();
                        return;
                    }
                    else if (window.event.keyCode == 38) //Up key movement
                    {
                        //document.getElementById(KeyNavigation(obj, "UP")).select();
                        return;
                    }
                    //                    else if (window.event.keyCode == 37) //Left key movement
                    //                    {
                    //                        document.getElementById(GlobEmployeeNumber).select();
                    //                        return;
                    //                    }
                    //                    else if (window.event.keyCode == 39) //Right key movement
                    //                    {
                    //                        document.getElementById(GlobPatternPosition).select();
                    //                        return;
                    //                    }

                    break;
                case "EmployeeNumber":
                    if (window.event.keyCode == 40) {  //Down Key Pressed
                        //document.getElementById(KeyNavigation(obj, "DOWN")).select();
                        return;
                    }
                    else if (window.event.keyCode == 38) //Up key movement
                    {
                        //document.getElementById(KeyNavigation(obj, "UP")).select();
                        return;
                    }
                    else if (window.event.keyCode == 39) //Right key movement
                    {
                        document.getElementById(GlobPatternPosition).select();
                        return;
                    }
                    if (window.event.keyCode == 120) {

                        if (document.getElementById(GlobEmployeeNumber).value == '') {
                            GlobEmployeeNumber = getClientId(obj, strEmpNumber);
                            GlobEmployeeName = getClientId(obj, strEmployeeName);
                            GlobEmployeeDesgDesc = getClientId(obj, strEmpDesignationDesc);
                            GetUnSchEmp(GlobEmployeeNumber);
                            return;
                        }
                        else {
                            GetUnSchEmp('');
                        }
                    }
                    if (window.event.keyCode == 40) {

                        if (document.getElementById('divEmployeeContainer').style.display != "none") {
                            if (document.getElementById('<%= LBEmployeeList.ClientID %>').selectedIndex > 0) {
                                document.getElementById('<%= LBEmployeeList.ClientID %>').selectedIndex = document.getElementById('<%= LBEmployeeList.ClientID %>').selectedIndex - 1;
                            }
                            GlobEmployeeNumber = obj.id;
                            document.getElementById('<%= LBEmployeeList.ClientID %>').focus();
                        }

                    }
                    else if (window.event.keyCode == 13) //select
                    {

                        GlobEmployeeName = getClientId(obj, strEmployeeName);
                        GlobEmployeeDesgDesc = getClientId(obj, strEmpDesignationDesc);
                        var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                        //Added Area ID option to search only those employee that belongs to that Area
                        var str = GetEmpName(document.getElementById(GlobEmployeeNumber).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<%=HFToDate.ClientID %>').value), strPost, 'EmployeeNumber', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType);
                        return;
                    }
                    else if (window.event.keyCode == 46) {  //delete Key Pressed
                        var strSchRosterAutoID = '';
                        var FromDate = DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value);
                        var MaxDate = DateInFormat(document.getElementById('<%=HFMaxDate.ClientID %>').value);
                        var EmployeeNumber = document.getElementById(GlobEmployeeNumber).value;
                        var PatternPosition = "txtPatternPosition";
                        var strPatternPosition = getClientId(obj, PatternPosition);
                        for (var ColumnIndex = 1; ColumnIndex <= 7; ColumnIndex++) {
                            var strScheduleRosterAutoID = "HFSchRosterAutoID" + ColumnIndex;
                            GlobEmployeeSchRosterAutoID = getClientId(obj, strScheduleRosterAutoID);
                            if (document.getElementById(GlobEmployeeSchRosterAutoID).value != "0") {
                                strSchRosterAutoID = strSchRosterAutoID + ',' + document.getElementById(GlobEmployeeSchRosterAutoID).value
                            }
                        }
                        if (EmployeeNumber != "" && strSchRosterAutoID != "") {
                            DeleteScheduleDateRangeWise(EmployeeNumber, FromDate, MaxDate, document.getElementById('<%=txtAsmtCode.ClientID %>').value, document.getElementById(GlobShiftPatternCode).value, document.getElementById(strPatternPosition).value, document.getElementById(GlobRowNumber).innerText, document.getElementById('<%=ddlAttendanceType.ClientID %>').value);
                        }
                    }
                    else if (window.event.keyCode == 16) //select
                    {
                        obj.select();
                        return;
                    }
                    else if (window.event.keyCode == 9) {
                        GlobEmployeeName = getClientId(obj, strEmployeeName);
                        GlobEmployeeDesgDesc = getClientId(obj, strEmpDesignationDesc);
                        if (document.getElementById(GlobEmployeeNumber).value != "") {
                            var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                            //Added Area ID option to search only those employee that belongs to that Area
                            var str = GetEmpName(document.getElementById(GlobEmployeeNumber).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<%=HFToDate.ClientID %>').value), strPost, 'GETEMP', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType);
                        }
                    }
                    else {
                        return;
                    }
                default:

                    break;
            }
        }

        function SaveDataPatternWise(obj) {
            var list = document.getElementById('<% =LBShiftPatterns.ClientID %>');
            for (var i = 0; i < list.options.length; ++i) {
                if (list.options[i].text.toLowerCase() == document.getElementById(GlobShiftPatternCode).value.toLowerCase()) {
                    GlobPDLineWiseShiftPatternCode = list.options[i].value;
                    break;
                }
                else {
                    GlobPDLineWiseShiftPatternCode = "";
                }
            }
            if (GlobPDLineWiseShiftPatternCode != "") {
                
                var SoRank = 'A-Site1-SGS';
                if (document.getElementById('<%=HFNewEmployeeNumber.ClientID %>').value != "") {
                    var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;

                    if (document.getElementById(GlobEmployeeDesgDesc).value != "") {
                        InsertDataPatternWise(document.getElementById('<%=txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<%=HFMaxDate.ClientID %>').value), document.getElementById('<%=HFNewEmployeeNumber.ClientID %>').value, document.getElementById(GlobDefaultSite).checked, document.getElementById(GlobEmployeeDesgCode).value, document.getElementById(GlobShiftPatternCode).value, document.getElementById(GlobPatternPosition).value, SoRank, document.getElementById(GlobRowNumber).innerText, strPost, document.getElementById('<%=ddlAttendanceType.ClientID %>').value);
                    }
                }
                else {
                    alert(EmployeecannotbeleftBlank);
                }
            }
            else {
                if (document.getElementById(GlobShiftPatternCode).value != "") {
                    alert(InvalidShiftPattern);
                }
            }
        }
        function FinalOutputForCopy(strResult) {
            document.getElementById('DivCopyDetails').style.display = 'none';
            var j = 0;
            document.getElementById('span2').innerHTML = strResult;
            var TotalCount = document.getElementById('hfTotalCount0').value;
            if (TotalCount < 0) {
                document.getElementById('DIVMultipleOverwrite').style.display = "block";
                document.getElementById('btnOverWrite').style.display = 'none';
            }
            else {
                if (TotalCount > 0) {
                    if (document.getElementById('HFMessageID' + j).innerHTML == Insert) {
                        if (document.getElementById('<%=HFPost.ClientID %>').value == '') {
                            document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
                        }
                        document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
                        document.getElementById('<%=btnProceed.ClientID %>').click();
                        document.getElementById(GlobShiftPatternCode).disabled = true;
                        document.getElementById('tr' + j).style.display = "none";
                        document.getElementById('DIVMultipleOverwrite').style.display = "none";
                        if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Sch') {
                            GetReqSch();
                        }
                        else {
                            document.getElementById('divManPowerReq').innerHTML = '';
                            document.getElementById('divManPowerReq').style.display = 'none';
                        }
                    }

                    else {
                        document.getElementById('tr' + j).style.display = "block";
                        document.getElementById('DIVMultipleOverwrite').style.display = "block";
                        document.getElementById('btnOverWrite').style.display = 'block';
                    }
                }
            }
        }
        function FinalOutputForPatternWise(strResult) {

            document.getElementById('<%=HFScheduleRosterAutoID.ClientID %>').value = '';
            document.getElementById('span2').innerHTML = "";
            document.getElementById('span1').innerHTML = "";
            document.getElementById('span2').innerHTML = strResult;
            document.getElementById('btnCheckAll').style.display = "block";
            document.getElementById('btnUnCheckAll').style.display = "none";
            var j = 0;
            var TotalCount = document.getElementById('hfTotalCount0').value;
            var flag = 0;
            for (var i = 0; i < TotalCount; i++) {
                document.getElementById('lblMsgID' + i).style.display = 'none';

                if (document.getElementById('lblMsgShiftDuplicate' + i).innerHTML == Duplicate) {

                    flag = 1;
                    break;
                }
            }
            if (TotalCount > 0) {

                if (document.getElementById('lblMsgID' + j).innerHTML == "5") {

                    document.getElementById('tr' + j).style.display = "block";
                    document.getElementById('DIVMultipleOverwrite').style.display = "block";

                    if (parseInt(flag) == 1) {
                        document.getElementById('btnOverWrite').style.display = 'block';
                    }
                    else {
                        document.getElementById('btnOverWrite').style.display = 'none';
                    }
                }
                else if (document.getElementById('lblMsgID' + j).innerHTML == "1") {
                    if (document.getElementById('<%=HFPost.ClientID %>').value == '') {
                        document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
                    }
                    document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
                    document.getElementById('<%=btnProceed.ClientID %>').click();
                    document.getElementById(GlobShiftPatternCode).disabled = true;
                    document.getElementById('tr' + j).style.display = "none";
                    document.getElementById('DIVMultipleOverwrite').style.display = "none";
                    if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Sch') {
                        GetReqSch();
                    }
                    else {
                        document.getElementById('divManPowerReq').innerHTML = '';
                        document.getElementById('divManPowerReq').style.display = 'none';
                    }
                    // Code to show Exceptions

                    showExceptionMessage();

                    // Code to show Exceptions

                }

                else {
                    document.getElementById('btnOverWrite').style.display = 'none';
                    document.getElementById('btnOverwriteSingleShift').style.display = 'none';
                }
            }
            //}

        }
        function showExceptionMessage() {

            var arrException = new Array;
            var strExceptionEmployeeNumber = "";
            var strMaxDutyDate = "";
            var strProceedStatus = "0"
            if (document.getElementById('lblMsgID' + 119) == '[object]') {
                if (document.getElementById('lblMsgID' + 119).innerHTML == "119") {
                    arrException = document.getElementById('lblMsgException' + 119).innerHTML.split(",");
                    strMaxDutyDate = document.getElementById('lblMsgExceptionMaxToDate' + 119).innerHTML;
                    strExceptionEmployeeNumber = document.getElementById('lblMsgExceptionEmployeeNumber' + 119).innerHTML;
                    strProceedStatus = "1"
                }
            }
            else if (document.getElementById('<%=lblMsgIDException.ClientID %>').innerHTML == "119") {
                arrException = document.getElementById('<%=lblMsgException.ClientID %>').innerHTML.split(",");
                strExceptionEmployeeNumber = document.getElementById('<%=lblMsgExceptionEmployeeNumber.ClientID %>').innerHTML;
                strMaxDutyDate = document.getElementById('<%=lblMsgExceptionMaxToDate.ClientID %>').innerHTML;
                strProceedStatus = "1"
            }
            else {
                return;
            }

            if (strProceedStatus == "1" && arrException[0] != "") {
                var strMsg = "Following Exception occured";
                strMsg = strMsg + "\n";
                for (var i = 0; i < arrException.length; i++) {
                    if (arrException[i] != "") {
                        strMsg = strMsg + (i + 1) + " . " + arrException[i] + "\n";
                    }
                }

                strMsg = strMsg + "\n";
                strMsg = strMsg + "Click OK to continue";
                var strScreenType;
                if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {
                    strScreenType = 'ACT'
                }
                else {
                    strScreenType = 'SCH'
                }

                var strExceptionClickStatus;
                if (confirm(strMsg)) {
                    strExceptionClickStatus = '2';

                    AutoCompleteTextBox.InsertExceptionRecords(document.getElementById('<%= HidCon.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(strMaxDutyDate), document.getElementById('<% =txtAsmtCode.ClientID %>').value, document.getElementById('<%= HFCurrentSessionID.ClientID %>').value, SessionLocationAutoId, strScreenType, strExceptionEmployeeNumber, strExceptionClickStatus, SessionUserId, OnInsertExceptionRecordsComplete, OnWSRequestFailed);
                }
                else {
                    strExceptionClickStatus = '3';
                    AutoCompleteTextBox.InsertExceptionRecords(document.getElementById('<%= HidCon.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(strMaxDutyDate), document.getElementById('<% =txtAsmtCode.ClientID %>').value, document.getElementById('<%= HFCurrentSessionID.ClientID %>').value, SessionLocationAutoId, strScreenType, strExceptionEmployeeNumber, strExceptionClickStatus, SessionUserId, OnInsertExceptionRecordsComplete, OnWSRequestFailed);
                }
            }
            try {
                document.getElementById('<%=lblMsgIDException.ClientID %>').innerHTML = "";
                document.getElementById('<%=lblMsgExceptionEmployeeNumber.ClientID %>').innerHTML = "";
                document.getElementById('<%=lblMsgExceptionMaxToDate.ClientID %>').innerHTML = "";
                document.getElementById('<%=lblMsgException.ClientID %>').innerHTML = "";
                document.getElementById('lblMsgID' + 119).innerHTML = "";
                document.getElementById('lblMsgException' + 119).innerHTML = "";
            }

            catch (Error) { }
        }
        function OnInsertExceptionRecordsComplete(strResult) {

            var res1 = strResult;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");

            var l = 0;
            var strTable;
            if (xmlDoc1.getElementsByTagName("MessageID")[l].firstChild.nodeValue == '3') { // When Called From PAy Rate Check
                if (document.getElementById('<%=HFPost.ClientID %>').value == '') {
                    document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
                }
                return;
            }
            if (xmlDoc1.getElementsByTagName("MessageID")[l].firstChild.nodeValue == '2' || xmlDoc1.getElementsByTagName("MessageID")[l].firstChild.nodeValue == '1') {
                if (document.getElementById('<%=HFPost.ClientID %>').value == '') {
                    document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
                }
                document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
                document.getElementById('<%=btnProceed.ClientID %>').click();
                return;
            }

            strTable = "<table width=650 border=1 style='font-size:11px' > ";

            for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {
                strTable = strTable + "<tr id='tr" + l + "' style='display: block'><td>";
                strTable = strTable + "<div style='width:110px' id='lblMsgID" + l + "' >" + xmlDoc1.getElementsByTagName("MessageID")[l].firstChild.nodeValue + "</div>";
                strTable = strTable + "</td><td>";
                if (xmlDoc1.getElementsByTagName("MessageString")[l].firstChild.nodeValue == "Duplicate") {
                    strTable = strTable + "<div style='width:110px' id='lblMsgShiftDuplicate" + l + "' >" + Duplicate + "</div>";
                }
                else {
                    if (xmlDoc1.getElementsByTagName("MessageString")[l].firstChild.nodeValue = "Converted") {
                        strTable = strTable + "<div style='width:110px' id='lblMsgShiftDuplicate" + l + "' >" + Converted + "</div>";
                    }
                }
                strTable = strTable + "</td><td>";
                strTable = strTable + "<div style='width:110px' id='lblDupAsmtCode" + l + "' >" + xmlDoc1.getElementsByTagName("AsmtCode")[l].firstChild.nodeValue + "</div>";
                strTable = strTable + "</td><td>";
                strTable = strTable + "<div style='width:14px' id='lblDupShiftCode" + l + "' >" + xmlDoc1.getElementsByTagName("ShiftCode")[l].firstChild.nodeValue + "</div>";
                strTable = strTable + "</td><td>";
                strTable = strTable + "<div style='width:80px' id='lblDupDutyDate" + l + "' >" + xmlDoc1.getElementsByTagName("DutyDate")[l].firstChild.nodeValue + "</div>";
                strTable = strTable + "</td><td>";
                strTable = strTable + "<div style='width:60px' id='lblDupEmpNo" + l + "' >" + xmlDoc1.getElementsByTagName("EmployeeNumber")[l].firstChild.nodeValue + "</div>";
                strTable = strTable + "</td><td>";
                strTable = strTable + "<div style='width:50px' id='lblDupTimeFrom" + l + "' >" + xmlDoc1.getElementsByTagName("TimeFrom")[l].firstChild.nodeValue + "</div>";
                strTable = strTable + "</td><td>";
                strTable = strTable + "<div style='width:50px' id='lblDupTimeTo" + l + "' >" + xmlDoc1.getElementsByTagName("TimeTo")[l].firstChild.nodeValue + "</div>";
                strTable = strTable + "</td><td>";
                if (xmlDoc1.getElementsByTagName("MessageString")[l].firstChild.nodeValue = "Duplicate") {
                    strTable = strTable + "<input type='checkbox' id='chk" + l + "' />";

                }

                strTable = strTable + "<input type='hidden' id='HFTimeFromToOverwrite" + l + "' value='" + xmlDoc1.getElementsByTagName("TimeFromToOverwrite")[l].firstChild.nodeValue + "'    />";
                strTable = strTable + "<input type='hidden' id='HFToTimeToOverwrite" + l + "' value='" + xmlDoc1.getElementsByTagName("ToTimeToOverwrite")[l].firstChild.nodeValue + "'    />";
                strTable = strTable + "<input type='hidden' id='HFAsmtCodeToOverwrite" + l + "' value='" + xmlDoc1.getElementsByTagName("AsmtCodeToOverwrite")[l].firstChild.nodeValue + "'    />";
                strTable = strTable + "<input type='hidden' id='HFRoleCodeToOverWrite" + l + "' value='" + xmlDoc1.getElementsByTagName("RoleCodeToOverWrite")[l].firstChild.nodeValue + "'    />";
                strTable = strTable + "<input type='hidden' id='HFDutyTypeCodeToOverWrite" + l + "' value='" + xmlDoc1.getElementsByTagName("DutyTypeCodeToOverWrite")[l].firstChild.nodeValue + "' />";
                strTable = strTable + "<input type='hidden' id='HFPDlineNoToOverwrite" + l + "' value='" + xmlDoc1.getElementsByTagName("PDlineNoToOverwrite")[l].firstChild.nodeValue + "'    />";
                strTable = strTable + "<input type='hidden' id='HFDutyDateToOverWrite" + l + "' value='" + xmlDoc1.getElementsByTagName("DutyDateToOverWrite")[l].firstChild.nodeValue + "'    />";
                strTable = strTable + "<input type='hidden' id='HFPatternPosition" + l + "' value='" + xmlDoc1.getElementsByTagName("PatternPosition")[l].firstChild.nodeValue + "'    />";
                strTable = strTable + "<input type='hidden' id='HFRowNumber" + l + "' value='" + xmlDoc1.getElementsByTagName("RowNumber")[l].firstChild.nodeValue + "'    />";

                strTable = strTable + "<input type='hidden' id='HFDupSchRosterAutoID" + l + "' value='" + xmlDoc1.getElementsByTagName("SchRosterAutoID")[l].firstChild.nodeValue + "'    />";

                strTable = strTable + "</td></tr>";
                l++;
            }
            strTable = strTable + "<tr><td>";
            strTable = strTable + "<input type='hidden' id='hfTotalCount" + 0 + "' value='" + (l + 1) + "'    />";
            strTable = strTable + "</td></tr>";
            strTable = strTable + "</table>";
            document.getElementById('span2').innerHTML = '';
            document.getElementById('span2').innerHTML = strTable;
            document.getElementById('DIVMultipleOverwrite').style.display = "block";

            document.getElementById('btnOverWrite').style.display = 'block';
        }
        //--==========================
        function AssignmentLodingStatus() {
            if (document.getElementById('<%=txtAsmtCode.ClientID %>').value == '') {
                document.getElementById('<%=btnProceed.ClientID %>').disabled = true;
                return;
            }
            else {
                document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            }
            if (document.getElementById('<% =hfAssignmentCode.ClientID %>').value != "") {
                document.getElementById('<% =txtAsmtCode.ClientID %>').value = document.getElementById('<% =hfAssignmentCode.ClientID %>').value;

                changeAsmtCode();
                document.getElementById('<% =hfAssignmentCode.ClientID %>').value = "";
                return false;
            }
            if (GlobAsmtCode != '') {
                GetPost(GlobAsmtCode);
            }
            else {
                GetPost(document.getElementById('<% =txtAsmtCode.ClientID %>').value);
            }
            onAssignmentLoaded();

        }
        function autofill() {
            if (document.getElementById('<% =hfAssignmentCode.ClientID %>').value != "") {
                ChangeClientCode();
                return false;
            }

        }
        //=======================================
        // Function Used to Get Assignment Detail Based on ClientCode
        //=======================================
        function SelectClient(ClientName, txtClientCode) {
            document.selection.clear();
            if (document.getElementById('gvScheduleRoster') == '[object]') {
                document.getElementById('gvScheduleRoster').style.display = 'none'
                document.getElementById('<%=HFRowIndex.ClientID %>').value = "";
                document.getElementById('<%=HFColumnIndex.ClientID %>').value = "";
            }
            document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            if (document.getElementById('<% =txtClientCode.ClientID %>').value != "") {
                document.getElementById(txtClientCode).value = document.getElementById(ClientName).value;

                GetAsmtsAjax(document.getElementById('<% =ddAssignment.ClientID %>').id, document.getElementById('<% =txtAsmtCode.ClientID %>').id, document.getElementById('<% =txtAsmtStartDate.ClientID %>').id, document.getElementById('<% =txtAsmtEndDate.ClientID %>').id, document.getElementById(txtClientCode).value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), document.getElementById('<%=ddlArea.ClientID %>').value, "SelectAssignment", "NoAssignmentIsDefined");
            }
        }
        //=======================================
        //Function Used to Select Assignment
        //=======================================
        function SelectAsmt(AsmtName, txtASmtCode) {
            document.selection.clear();
            if (document.getElementById('gvScheduleRoster') == '[object]') {
                document.getElementById('gvScheduleRoster').style.display = 'none'
                document.getElementById('<%=HFRowIndex.ClientID %>').value = "";
                document.getElementById('<%=HFColumnIndex.ClientID %>').value = "";
            }
            var arr = new Array;
            arr = document.getElementById(AsmtName).value.split("$");
            document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            document.getElementById(txtASmtCode).value = arr[0]; //document.getElementById(AsmtName).value;
            if (document.getElementById(txtASmtCode).value != "") {
                GetPost(document.getElementById(txtASmtCode).value);
                document.getElementById('<%= txtAsmtStartDate.ClientID%>').value = arr[2]; //document.getElementById(AsmtName).value;
                if (arr[3] != "01-Jan-1900") {
                    document.getElementById('<%= txtAsmtEndDate.ClientID%>').value = arr[3]; //document.getElementById(AsmtName).value;
                }
                else {
                    document.getElementById('<%= txtAsmtEndDate.ClientID%>').value = "";
                }
            }
            else {
                document.getElementById('<%= txtAsmtStartDate.ClientID%>').value = "";
                document.getElementById('<%= txtAsmtEndDate.ClientID%>').value = "";
            }

        }
        //=======================================
        //Function used when Client Code is Changed
        //=======================================
        function ChangeClientCode() // Javascript for select client in dropdown
        {

            GlobAsmtCode = '';
            document.getElementById('<% =ddlPost.ClientID %>').options.length = 0;

            document.selection.clear();
            if (document.getElementById('<%=gvScheduleRoster.ClientID %>') == '[object]') {

                document.getElementById('<%=gvScheduleRoster.ClientID %>').style.display = 'none'

            }
            document.getElementById('<% =ddAssignment.ClientID %>').options.length = 0;
            document.getElementById('<% =txtAsmtCode.ClientID %>').value = "";
            document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            for (var i = 0; i <= document.getElementById('<% =ddClient.ClientID %>').length - 1; i++) {
                if (document.getElementById('<% =ddClient.ClientID %>')[i].value == document.getElementById('<% =txtClientCode.ClientID %>').value) {
                    document.getElementById('<% =ddClient.ClientID %>').selectedIndex = i;
                    i = 1000;
                    GetAsmtsAjax(document.getElementById('<% =ddAssignment.ClientID %>').id, document.getElementById('<% =txtAsmtCode.ClientID %>').id, document.getElementById('<% =txtAsmtStartDate.ClientID %>').id, document.getElementById('<% =txtAsmtEndDate.ClientID %>').id, document.getElementById('<% =txtClientCode.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), document.getElementById('<%=ddlArea.ClientID %>').value, "SelectAssignment", "NoAssignmentIsDefined");

                }
                else if (i == document.getElementById('<% =ddClient.ClientID %>').length - 1) {
                    document.getElementById('<% =ddlPost.ClientID %>').options.length = 0;
                    document.getElementById('<% =ddClient.ClientID %>').selectedIndex = 0;
                    document.getElementById('<% =txtAsmtCode.ClientID %>').value = "";
                    return false;
                }
            }
            return false;
        }
        //=======================================
        // Function used when Assignment Code is Changed
        //=======================================
        function changeAsmtCode() {

            document.selection.clear();
            if (document.getElementById('gvScheduleRoster') == '[object]') {
                document.getElementById('gvScheduleRoster').style.display = 'none'
                document.getElementById('<%=HFRowIndex.ClientID %>').value = "";
                document.getElementById('<%=HFColumnIndex.ClientID %>').value = "";
            }
            document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            if (document.getElementById('<%=txtAsmtCode.ClientID %>').value == '') {
                document.getElementById('<%=btnProceed.ClientID %>').disabled = true;
                return;
            }
            else {
                document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
            }
            for (var i = 0; i <= document.getElementById('<% =ddAssignment.ClientID %>').length - 1; i++) {
                var arr = new Array;
                arr = document.getElementById('<% =ddAssignment.ClientID %>')[i].value.split("$");
                if (arr[0] == document.getElementById('<% =txtAsmtCode.ClientID %>').value) {
                    document.getElementById('<% =ddAssignment.ClientID %>').selectedIndex = i;
                    GetPost(document.getElementById('<% =txtAsmtCode.ClientID %>').value);
                    document.getElementById(txtAsmtStartDate).value = arr[2]; //document.getElementById(AsmtName).value;
                    if (arr[3] != "01-Jan-1900") {
                        document.getElementById(txtAsmtEndDate).value = arr[3]; //document.getElementById(AsmtName).value;
                        return true;
                    }
                    else {
                        document.getElementById(txtAsmtEndDate).value = "";

                        return true;
                    }

                    i = 1000;
                }
                else if (i == document.getElementById('<% =ddAssignment.ClientID %>').length - 1) {
                    alert(InvalidAssignment);
                    document.getElementById('<%=btnProceed.ClientID %>').disabled = true;
                    return false;
                }

            }

            return false;

        }
        function GetPost(strAsmtCode) {
            document.getElementById('<% =ddlPost.ClientID %>').options.length = 0;
            AutoCompleteTextBox.GetAllPostOfAssignment(document.getElementById('<%= HidCon.ClientID %>').value, strAsmtCode, SessionLocationAutoId, DateInFormat(document.getElementById('<%=HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<%=HFToDate.ClientID %>').value), OnGetAllPostWSRequestComplete, OnGetAllPostWSRequestFailed);

        }
        function ChangePostCode() {
            document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<% =ddlPost.ClientID %>').value
            
            if (document.getElementById('<%=ddlPost.ClientID %>').selectedIndex != -1) {
                document.getElementById('<%=HFPostText.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').options[document.getElementById('<%=ddlPost.ClientID %>').selectedIndex].text;
            }
            if (document.getElementById('gvScheduleRoster') == '[object]') {
                document.getElementById('gvScheduleRoster').style.display = 'none'
                document.getElementById('<%=HFRowIndex.ClientID %>').value = "";
                document.getElementById('<%=HFColumnIndex.ClientID %>').value = "";
                document.getElementById('<%=txtPostID.ClientID %>').value = "";
            }
            document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
        }
        function OnGetAllPostWSRequestComplete(result) {
            var res1 = result;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");

            var l = 0;
            document.getElementById('<% =ddlPost.ClientID %>').options.length = 0;
            for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {
                var Option = document.createElement("OPTION");
                Option.text = xmlDoc1.getElementsByTagName("Post")[l].firstChild.nodeValue;
                Option.value = xmlDoc1.getElementsByTagName("PDLineNo")[l].firstChild.nodeValue;
                document.getElementById('<% =ddlPost.ClientID %>').options.add(Option);
                l++;
            }
            document.getElementById('<% =ddlPost.ClientID %>').selectedIndex = 0;
            document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<% =ddlPost.ClientID %>').value;
            if (document.getElementById('<%=ddlPost.ClientID %>').selectedIndex != -1) {
                document.getElementById('<%=HFPostText.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').options[document.getElementById('<%=ddlPost.ClientID %>').selectedIndex].text;
            }
            AssignPostIDDropDown();
        }
        function AssignPostIDDropDown() {
            for (var i = 0; i <= document.getElementById('<%=ddlPost.ClientID %>').length - 1; i++) {
                if (document.getElementById('<% =txtPostID.ClientID %>').value != '') {
                    if (document.getElementById('<% =ddlPost.ClientID %>').options[i].text.toLowerCase() == document.getElementById('<% =txtPostID.ClientID %>').value.toLowerCase()) {
                        document.getElementById('<% =ddlPost.ClientID %>').selectedIndex = i;
                        break;
                    }
                }
            }
            document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<% =ddlPost.ClientID %>').value;
            if (document.getElementById('<%=ddlPost.ClientID %>').selectedIndex != -1) {
                document.getElementById('<%=HFPostText.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').options[document.getElementById('<%=ddlPost.ClientID %>').selectedIndex].text;
            }
            if (document.getElementById('<% =txtPostID.ClientID %>').value != '') {

                document.getElementById('<%=btnProceed.ClientID %>').disabled = false;
                document.getElementById('<%=btnProceed.ClientID %>').click();
            }
            if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {
                FillReqSch('');
            }
            return;
        }
        function OnGetAllPostWSRequestFailed() {

        }
        //=======================================
        //Function To Change The Date Fromat
        //=======================================
        function DateInFormat(str) {
            if (str == "") {
                return str;
            }
            else {

                var d = new Date();

                var arr = str.split("-");
                var strMonthName;
                var strDay, strYear;

                strMonthName = arr[1];
                strDay = arr[0];
                strYear = arr[2];

                var DateReturn;

                if (strMonthName == January || strMonthName.toUpperCase() == "JAN") {
                    DateReturn = strDay + "-JAN-" + strYear;
                }
                else if (strMonthName == February || strMonthName.toUpperCase() == "FEB") {

                    DateReturn = strDay + "-FEB-" + strYear;
                }
                else if (strMonthName == March || strMonthName.toUpperCase() == "MAR") {
                    DateReturn = strDay + "-MAR-" + strYear;
                }
                else if (strMonthName == April || strMonthName.toUpperCase() == "APR") {
                    DateReturn = strDay + "-APR-" + strYear;
                }
                else if (strMonthName == May || strMonthName.toUpperCase() == "MAY") {
                    DateReturn = strDay + "-MAY-" + strYear;
                }
                else if (strMonthName == June || strMonthName.toUpperCase() == "JUN") {
                    DateReturn = strDay + "-JUN-" + strYear;
                }
                else if (strMonthName == July || strMonthName.toUpperCase() == "JUL") {
                    DateReturn = strDay + "-JUL-" + strYear;
                }
                else if (strMonthName == August || strMonthName.toUpperCase() == "AUG") {
                    DateReturn = strDay + "-AUG-" + strYear;
                }
                else if (strMonthName == September || strMonthName.toUpperCase() == "SEP") {
                    DateReturn = strDay + "-SEP-" + strYear;
                }
                else if (strMonthName == October || strMonthName.toUpperCase() == "OCT") {
                    DateReturn = strDay + "-OCT-" + strYear;
                }
                else if (strMonthName == November || strMonthName.toUpperCase() == "NOV") {
                    DateReturn = strDay + "-NOV-" + strYear;
                }
                else if (strMonthName == December || strMonthName.toUpperCase() == "DEC") {
                    DateReturn = strDay + "-DEC-" + strYear;
                }

                return DateReturn;

            }
        }
        function SelectPost(obj) {
            var obj = document.getElementById('<% =LBPost.ClientID %>');
            if (obj.selectedIndex >= 0) {

                document.getElementById('<%=txtPostID.ClientID %>').value = obj.options[obj.selectedIndex].text;
                document.getElementById('<%=txtPostID.ClientID %>').focus();
                var arrClientCode = new Array;
                var strAsmtCode = obj.options[obj.selectedIndex].value;
                arrClientCode = strAsmtCode.split("/");
                SwitchToAssignmentPostWise(obj.options[obj.selectedIndex].value, arrClientCode[0], obj.options[obj.selectedIndex].value)
                document.getElementById('DIVPostSearch').style.display = "none";
            }
            return;
        }
        function AssignPostIDValue() {
            document.getElementById('<%=HFPost.ClientID %>').value = document.getElementById('<%=ddlPost.ClientID %>').value;
            var objPost = document.getElementById('<%=ddlPost.ClientID %>');
            if (objPost.selectedIndex != -1) {
                document.getElementById('<%=HFPostText.ClientID %>').value = objPost.options[objPost.selectedIndex].text;
            }

        }
        function OnGetPostIDComplete(result) {
            if (result != '') {
                var res1 = result;
                var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
                xmlDoc1.async = "false";
                xmlDoc1.loadXML(res1);
                var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
                var asmtc = nodes1.selectNodes("Table");

                var l = 0;
                for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {
                    var Option = document.createElement("OPTION");
                    Option.text = xmlDoc1.getElementsByTagName("Post")[l].firstChild.nodeValue;
                    Option.value = xmlDoc1.getElementsByTagName("AsmtCode")[l].firstChild.nodeValue;
                    document.getElementById('<% =LBPost.ClientID %>').options.add(Option);
                    l++;
                }
                document.getElementById('<% =LBPost.ClientID %>').selectedIndex = -1;
            }

            //********************************************
            var el_List = document.getElementById('<% =LBPost.ClientID %>');

            if (GlobKeyCode == 13) {
                if (el_List.selectedIndex > -1) {
                    document.getElementById('<%=txtPostID.ClientID %>').value = el_List.options[el_List.selectedIndex].text;
                    document.getElementById('<%=txtAsmtCode.ClientID %>').value = el_List.options[el_List.selectedIndex].value;
                    document.getElementById('DIVPostSearch').style.display = "none";
                }
                return;
            }
            else if (GlobKeyCode == 40) {
                if (document.getElementById('DIVPostSearch').style.display == "block") {
                    el_List.focus();
                }
                return;
            }
            else if (GlobKeyCode == 9) {
                if (document.getElementById('<%=txtPostID.ClientID %>').value != "") {
                    try {
                        document.getElementById('<%=txtPostID.ClientID %>').value = el_List.options[el_List.selectedIndex].text;
                        document.getElementById('<%=txtAsmtCode.ClientID %>').value = el_List.options[el_List.selectedIndex].value;

                        document.getElementById('DIVPostSearch').style.display = "none";
                        return;
                    }
                    catch (Error) { return; }
                }
            }
            else if (GlobKeyCode == 0 && el_List.length > 0) /////// on blur
            {
                if (el_List.selectedIndex > -1) {
                    document.getElementById('<%=txtPostID.ClientID %>').value = el_List.options[el_List.selectedIndex].text;
                    document.getElementById('<%=txtAsmtCode.ClientID %>').value = el_List.options[el_List.selectedIndex].value;
                }
                document.getElementById('DIVPostSearch').style.display = "none";
                el_List.selectedIndex = -1
                return;
            }
            else {
                if (GlobKeyCode == 0)
                { return; }
                var lyr = document.getElementById('DIVPostSearch');
                var coors = findPos(document.getElementById('<%=txtPostID.ClientID %>'));
                lyr.style.top = coors[1] + 20 + 'px';
                lyr.style.left = coors[0] + 'px';
                document.getElementById('DIVPostSearch').style.display = "block";
                el_List.selectedIndex = -1;
                for (i = 0; i < el_List.length; i++) {
                    if (el_List.options[i].text.toLowerCase().substr(0, document.getElementById('<%=txtPostID.ClientID %>').value.length) == document.getElementById('<%=txtPostID.ClientID %>').value.toLowerCase()) {
                        el_List.options[i].selected = true;
                        return;
                    }
                }
            }
        }
        function SearchPostID(obj) {
            GlobKeyCode = window.event.keyCode;
            var strClientCode;
            if (SessionLoginType == 'C') {
                strClientCode = document.getElementById('<% =txtClientCode.ClientID %>').value
            }
            else {
                strClientCode = '';
            }
            if (obj != '') {
                document.getElementById('<% =LBPost.ClientID %>').length = 0;  // Added on 17-Sep-2011 For adding Area Drop down
                AutoCompleteTextBox.SearchPostID(document.getElementById('<%= HidCon.ClientID %>').value, SessionLocationAutoId, '', DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), strClientCode, document.getElementById('<%= ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, OnGetPostIDComplete, OnWSRequestFailed);
            }
            else {
                OnGetPostIDComplete('');
            }
            
        }
        //============ function added by  on 25-aug-2010 for searching employee schedule====================
        function GetUnSchEmp(strEmpClientID) {
            GlobEmployeeNumber = strEmpClientID;
            document.getElementById('<%=btnUnScheduledEmp.ClientID %>').click();
        }
        function CloseUnSchEmpDiv(obj) {
            document.getElementById('<%=DIVUnScheduledEmployees.ClientID %>').style.display = "none";
        }
        function BorrowUnSchEmpDiv(obj) {
            document.getElementById('<%=btnBorrowedEmp.ClientID %>').click();
        }

        /*Code added by   on 17-Aug-2011*/
        var oldTextAry = new Array();

        function changeText(fieldObj, newTexStr) {
            if (newTexStr == fieldObj.innerHTML) {
                fieldObj.innerHTML = oldTextAry[fieldObj.id];
            } else {
                oldTextAry[fieldObj.id] = fieldObj.innerHTML;
                fieldObj.innerHTML = newTexStr;
            }
        }
        /*End Code added by   on 17-Aug-2011*/

        function AssignToSelectedTextBox(obj) {
            if (GlobEmployeeNumber != '') {
                document.getElementById(GlobEmployeeNumber).value = document.getElementById(obj.id).innerText;
                document.getElementById('<%=DIVUnScheduledEmployees.ClientID %>').style.display = "none";
                var strPost = document.getElementById('<%=ddlPost.ClientID %>').value;
                //Added Area ID option to search only those employee that belongs to that Area
                var strScreenType;
                if (document.getElementById('<%=ddlAttendanceType.ClientID %>').value == 'Act') {
                    strScreenType = 'ACT'
                }
                else {
                    strScreenType = 'SCH'
                }
                var str = GetEmpName(document.getElementById(GlobEmployeeNumber).value, document.getElementById('<% =txtAsmtCode.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), strPost, 'GETEMP', document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, strScreenType);
            }
        }
        function SwitchToAssignmentPostWise(strAsmt, strClientCode, strPost) {
            var arrClientCode = new Array;
            var strAsmtCode = strAsmt;
            arrClientCode = strAsmtCode.split("/");
            document.getElementById('<%=txtClientCode.ClientID %>').value = strClientCode;
            document.getElementById('<%=ddClient.ClientID %>').value = strClientCode;
            document.getElementById('<%=lblOldAsmtCode.ClientID %>').innerText = document.getElementById('<% =txtAsmtCode.ClientID %>').value;

            GetAsmtsAjax(document.getElementById('<% =ddAssignment.ClientID %>').id, document.getElementById('<% =txtAsmtCode.ClientID %>').id, document.getElementById('<% =txtAsmtStartDate.ClientID %>').id, document.getElementById('<% =txtAsmtEndDate.ClientID %>').id, document.getElementById('<% =txtClientCode.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), document.getElementById('<%=ddlArea.ClientID %>').value, "SelectAssignment", "NoAssignmentIsDefined");
            GlobAsmtCode = strAsmtCode;
            document.getElementById('DIVPostSearch').style.display = "none";
        }
        function SearchEmploueeSchedule() {
            document.getElementById('span_EmployeeSchedule').innerHTML = "";
            document.getElementById('divSearchEmployeeSchedule').style.display = "block";
        }
        function closeEmployeeSearch(obj) {
            document.getElementById('divSearchEmployeeSchedule').style.display = "none";
        }
        function Search_GetEmployeeSchedule() {

            //Added Area ID option to search only those employee that belongs to that Area
            AutoCompleteTextBox.GetEmployeeSchedule(document.getElementById('<%= HidCon.ClientID %>').value, SessionLocationAutoId, document.getElementById('search_txtEmployeeNumber').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), document.getElementById('<%=ddlAttendanceType.ClientID %>').value, document.getElementById('<%=ddlArea.ClientID %>').value, SessionAreaInchargeNumber, IsAreaIncharge, OnGetScheduleComplete, OnWSRequestFailed);
        }
        function OnGetScheduleComplete(result) {
            var res1 = result;
            var xmlDoc1 = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc1.async = "false";
            xmlDoc1.loadXML(res1);
            var nodes1 = xmlDoc1.selectSingleNode("NewDataSet");
            var asmtc = nodes1.selectNodes("Table");
            var l = 0;
            var strTable;
            strTable = "<table border='0' cellpadding=0 cellspacing=1 style='font-size:11px' > ";
            strTable = strTable + "<tr style='background-color:#B7CEEC' >";
            strTable = strTable + "<td width=150px>Location</td>";
            strTable = strTable + "<td width=100px>AsmtCode</td>";
            strTable = strTable + "<td width=50px>PostCode</td>";
            strTable = strTable + "<td width=80px>DutyDate</td>";
            strTable = strTable + "<td width=30px>Shift</td>";
            strTable = strTable + "<td width=40px>From</td>";
            strTable = strTable + "<td width=40px>To</td>";
            strTable = strTable + "<td width=40px>Hrs</td>";

            strTable = strTable + "</tr><tr>";
            var arr = new Array;
            var TMin = 0;

            for (var myasmt = asmtc.nextNode(); myasmt; myasmt = asmtc.nextNode()) {
                strTable = strTable + "<tr><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("LocationDesc")[l].firstChild.nodeValue + "</td><td>";
                strTable = strTable + "<a Style='cursor: pointer' onClick=javascript:SwitchToThisAssignment('" + xmlDoc1.getElementsByTagName("AsmtCode")[l].firstChild.nodeValue + "') >";
                strTable = strTable + xmlDoc1.getElementsByTagName("AsmtCode")[l].firstChild.nodeValue + "</a></td><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("PostCode")[l].firstChild.nodeValue + "</td><td>";

                strTable = strTable + xmlDoc1.getElementsByTagName("DutyDate")[l].firstChild.nodeValue + "</td><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("ShiftCode")[l].firstChild.nodeValue + "</td><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("TimeFrom")[l].firstChild.nodeValue + "</td><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("TimeTo")[l].firstChild.nodeValue + "</td><td>";
                strTable = strTable + xmlDoc1.getElementsByTagName("DutyMin")[l].firstChild.nodeValue + "</td><td>";

                arr = xmlDoc1.getElementsByTagName("DutyMin")[l].firstChild.nodeValue.split(":");
                TMin = TMin + parseInt(arr[0] * 60) + parseInt(arr[1]);

                l++;
            }

            var TotHours = parseInt(TMin / 60);
            var TotMinutes = TMin % 60;

            if (TotHours < 10)
            { TotHours = "0" + TotHours; }
            if (TotMinutes < 10)
            { TotMinutes = "0" + TotMinutes; }

            strTable = strTable + "<tr><td colspan=7><b>Total Hours</b></td><td><b>" + TotHours + ":" + TotMinutes + "</b></td></tr>";

            strTable = strTable + "</table>";
            document.getElementById('span_EmployeeSchedule').innerHTML = strTable;

        }

        function SwitchToThisAssignment(strAsmt) {
            var arrClientCode = new Array;
            var strAsmtCode = strAsmt;
            arrClientCode = strAsmtCode.split("/");
            document.getElementById('<%=txtClientCode.ClientID %>').value = arrClientCode[0];
            document.getElementById('<%=ddClient.ClientID %>').value = arrClientCode[0];
            document.getElementById('<%=lblOldAsmtCode.ClientID %>').innerText = document.getElementById('<% =txtAsmtCode.ClientID %>').value;

            GetAsmtsAjax(document.getElementById('<% =ddAssignment.ClientID %>').id, document.getElementById('<% =txtAsmtCode.ClientID %>').id, document.getElementById('<% =txtAsmtStartDate.ClientID %>').id, document.getElementById('<% =txtAsmtEndDate.ClientID %>').id, document.getElementById('<% =txtClientCode.ClientID %>').value, DateInFormat(document.getElementById('<% =HFFromDate.ClientID %>').value), DateInFormat(document.getElementById('<% =HFToDate.ClientID %>').value), document.getElementById('<%=ddlArea.ClientID %>').value, "SelectAssignment", "NoAssignmentIsDefined");
            GlobAsmtCode = strAsmtCode;
            document.getElementById('divSearchEmployeeSchedule').style.display = "none";
        }

        //============ end function added by  on 25-aug-2010 for searching employee schedule====================
        // 
        ///// *******************Employee Name search *************************************************************************
        function func_EmpNameSearch(objEmpName) {

            var el_List = document.getElementById('<% =lstBox_Employees.ClientID %>');
            var el_EmpList = document.getElementById('<% =ddlEmployeesForSearch.ClientID %>');
            if (window.event.keyCode == 13) {
                if (el_List.selectedIndex > -1) {
                    document.getElementById('search_txtEmployeeNumber').value = el_List.options[el_List.selectedIndex].value;
                    document.getElementById('search_txtEmployeeName').value = el_List.options[el_List.selectedIndex].text;
                    document.getElementById('divEmployeeList').style.display = "none";

                }
                return;
            }
            else if (window.event.keyCode == 40) {
                if (document.getElementById('divEmployeeList').style.display == "block") {
                    el_List.focus();
                }
                return;
            }
            else if (window.event.keyCode == 9) {
                return;
            }
            else if (window.event.keyCode == 0 && el_List.length > 0) /////// on blur
            {
                document.getElementById('divEmployeeList').style.display = "block";
                if (el_List.selectedIndex > -1) {
                    document.getElementById('search_txtEmployeeNumber').value = el_List.options[el_List.selectedIndex].value;
                    document.getElementById('search_txtEmployeeName').value = el_List.options[el_List.selectedIndex].text;

                }
                el_List.selectedIndex = -1
                return;
            }
            else {
                if (window.event.keyCode == 0) {
                    document.getElementById('divEmployeeList').style.display = "block";
                    return;
                }
                var lyr = document.getElementById('divEmployeeList');
                var coors = findPos(document.getElementById('search_txtEmployeeName'));
                lyr.style.top = coors[1] + 20 + 'px';
                lyr.style.left = coors[0] + 'px';
                document.getElementById('divEmployeeList').style.display = "block";
                var j = 0;
                j = FindIndex(el_EmpList, 0, el_EmpList.length, document.getElementById('search_txtEmployeeName').value.toLowerCase());
                el_List.length = 0;
                for (i = j; i < j + 50 && i < el_EmpList.length; i++) {
                    if (el_EmpList.options[i].text.toLowerCase().substr(0, document.getElementById('search_txtEmployeeName').value.length) == document.getElementById('search_txtEmployeeName').value.toLowerCase()) {
                        el_List.options.add(new Option(el_EmpList.options[i].text, el_EmpList.options[i].value));
                        el_List.selectedIndex = 0;
                    }
                }
            }
        }

        function func_SelectEmployee(obj) {

            if (obj.selectedIndex > -1) {
                document.getElementById('search_txtEmployeeName').value = obj.options[obj.selectedIndex].text;
                document.getElementById('search_txtEmployeeNumber').value = obj.options[obj.selectedIndex].value;
                document.getElementById('divEmployeeList').style.display = "none";
            }

        }
        function backgroundOnFocus(txtClientID) {
            document.getElementById(txtClientID).style.background = "yellow";
        }

        function backgroundOnBlur(txtClientID) {
            document.getElementById(txtClientID).style.background = "white";
        }

        function KeyNavigation(obj, Direction) {
            var arr = new Array;
            var clId = "";  // clientId
            arr = obj.id.split("_");
            for (i = 0; i < arr.length - 2; i++) {
                clId = clId + arr[i] + "_";
            }

            var current_Index = arr[arr.length - 2].substring(3);

            if (current_Index.length > 1 && current_Index.substring(0, 1) == "0") {
                current_Index = current_Index.substring(1);
            }

            if (Direction.toUpperCase() == "DOWN") {
                current_Index = parseInt(current_Index) + 1;
            }
            else {
                current_Index = parseInt(current_Index) - 1;
            }

            if (current_Index < 10)
            { current_Index = "0" + current_Index; }

            clId = clId + "ctl" + current_Index + "_";
            clId = clId + arr[arr.length - 1];

            if (document.getElementById(clId) != "[object]")
            { clId = obj.id; }

            return clId
        }
